<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>刀刀亮的博客</title>
  <subtitle>一切源于内心</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://daodaoliang.com/"/>
  <updated>2017-05-05T03:34:50.885Z</updated>
  <id>http://daodaoliang.com/</id>
  
  <author>
    <name>daodaoliang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>梦想清单</title>
    <link href="http://daodaoliang.com/%E5%BF%83%E4%B8%96%E7%95%8C/2099/04/14/%E6%96%B0%E4%B8%96%E7%95%8C-2015-04-14-%E6%A2%A6%E6%83%B3%E6%B8%85%E5%8D%95/"/>
    <id>http://daodaoliang.com/心世界/2099/04/14/新世界-2015-04-14-梦想清单/</id>
    <published>2099-04-13T16:00:00.000Z</published>
    <updated>2017-05-05T03:34:50.885Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p><img src="https://source.unsplash.com/random/800x300"></p>
</blockquote>
<a id="more"></a>
<div class="note info"><p>target = ‘日日当精进 但求无愧’<br>target = ‘just do it’</p>
</div>
<blockquote>
<ul>
<li><p>完成自己制定的读书计划，按照书单列表进行阅读；</p>
</li>
<li><p>长途骑行一次；</p>
</li>
<li><p>拥有六块腹肌和匀称的身材；</p>
</li>
<li><p>参加一次马拉松比赛；</p>
</li>
<li><p>每天坚持锻炼(在生活轨迹里面打卡吧，这里就不占地方了)；</p>
</li>
<li><p>去心仪的大学读书深造；</p>
</li>
<li><p>拥有自己的工作室；</p>
</li>
</ul>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;&lt;img src=&quot;https://source.unsplash.com/random/800x300&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="心世界" scheme="http://daodaoliang.com/categories/%E5%BF%83%E4%B8%96%E7%95%8C/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS6升级GCC版本</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/20/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-04-20-CentOS6%E5%8D%87%E7%BA%A7GCC%E7%89%88%E6%9C%AC/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/20/环境搭建-2017-04-20-CentOS6升级GCC版本/</id>
    <published>2017-04-19T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-20</div><div class="line">版本 : 0.0.1</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="1-背景简述"><a href="#1-背景简述" class="headerlink" title="1. 背景简述"></a>1. 背景简述</h3><p><code>CentOS 6</code>系列的服务器,默认的gcc编译器都是 <code>4.4.7</code> 版本,有事后为了开发或者编译其他开源软件，则需要对gcc编译器进行升级;</p>
<h3 id="2-安装GCC前准备"><a href="#2-安装GCC前准备" class="headerlink" title="2. 安装GCC前准备"></a>2. 安装<code>GCC</code>前准备</h3><h4 id="2-1-下载指定版本"><a href="#2-1-下载指定版本" class="headerlink" title="2.1 下载指定版本"></a>2.1 下载指定版本</h4><p>首先在官网上面下载你需要的<code>GCC</code>版本,<a href="http://ftp.gnu.org/gnu/gcc" target="_blank" rel="external">官网在这里</a>,笔者选择的是<code>GCC 4.8.4</code>版本;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">   wget http://ftp.gnu.org/gnu/gcc/gcc-4.8.4/gcc-4.8.4.tar.gz</div></pre></td></tr></table></figure>
<h4 id="2-2-解压并进行准备工作"><a href="#2-2-解压并进行准备工作" class="headerlink" title="2.2 解压并进行准备工作"></a>2.2 解压并进行准备工作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar zxvf gcc-4.8.4.tar.gz</div></pre></td></tr></table></figure>
<h4 id="2-3-下载供编译需求的依赖项"><a href="#2-3-下载供编译需求的依赖项" class="headerlink" title="2.3 下载供编译需求的依赖项"></a>2.3 下载供编译需求的依赖项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/src/gcc-4.8.4/contrib/download_prerequisites</div></pre></td></tr></table></figure>
<h3 id="3-开始安装"><a href="#3-开始安装" class="headerlink" title="3. 开始安装"></a>3. 开始安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src/gcc-4.8.4</div><div class="line">   mkdir gcc-build</div><div class="line">   cd gcc-build</div><div class="line">   ../configure -enable-checking=release -enable-languages=c,c++ -disable-multilib</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make -j4</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo make install</div></pre></td></tr></table></figure>
<h3 id="4-配置环境"><a href="#4-配置环境" class="headerlink" title="4. 配置环境"></a>4. 配置环境</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cp /usr/local/lib64/libstdc++* /usr/lib64/</div><div class="line">   ln -s /usr/lib64/libstdc++.so /usr/lib64/libstdc++.so.6.0.19</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS下Nexus搭建Maven私库</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/20/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-04-20-CentOS%E4%B8%8BNexus%E6%90%AD%E5%BB%BAMaven%E7%A7%81%E5%BA%93/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/20/环境搭建-2017-04-20-CentOS下Nexus搭建Maven私库/</id>
    <published>2017-04-19T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-20</div><div class="line">版本 : 0.0.4</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="1-Maven私服简介"><a href="#1-Maven私服简介" class="headerlink" title="1. Maven私服简介"></a>1. <code>Maven</code>私服简介</h3><p>搭建私服可以做什么？<br>1、如果公司开发组的开发环境全部内网，这时如何连接到在互联网上的Maven中央仓库呢？<br>2、如果公司经常开发一些公共的组件，如何共享给各个开发组，使用拷贝方式吗？如果这样，公共库升级了怎么办？<br>当然可以解决的问题可能不止上面两点，下面来介绍在<code>CentOS</code>中搭建自己的<code>Maven</code>私服，使用<code>Nexus</code>。</p>
<h3 id="2-java-运行环境准备"><a href="#2-java-运行环境准备" class="headerlink" title="2. java 运行环境准备"></a>2. <code>java</code> 运行环境准备</h3><p>根据官网的介绍，运行环境最好是使用最新的8版本，官网文如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Nexus Repository Manager requires a Java 8 Runtime Environment (JRE) from Oracle. The distributions for OSX and Windows include suitable runtime environments for the specific operating system. The distributions for Unix do not include the runtime environment.</div><div class="line">If you prefer to use an external runtime or use a Unix operating system, it is recommended to use the latest version of Java 8 available from the Oracle website. You can choose to install the full JDK or the JRE only.</div></pre></td></tr></table></figure>
<h4 id="2-1-本地java版本确认"><a href="#2-1-本地java版本确认" class="headerlink" title="2.1 本地java版本确认"></a>2.1 本地<code>java</code>版本确认</h4><p>如果系统是新安装的并且没有进行相关配置的话，默认应该是<code>openJDK1.7版本</code>;</p>
<p><img src="/res/img/blog/环境搭建/java-version.png" alt="java版本查看"></p>
<h4 id="2-2-安装新的JDK"><a href="#2-2-安装新的JDK" class="headerlink" title="2.2 安装新的JDK"></a>2.2 安装新的<code>JDK</code></h4><ul>
<li>由于原有系统很多包都是依赖与JDK，以防万一，我就没有卸载原有的JDK而是在安装一个8版本的JDK;</li>
<li>在<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">JDK官网</a>找到对应的<code>rpm</code>包进行下载并安装,建议本机迅雷下载完成后再传到服务器,也可以找一些速度快的镜像站进行下载;</li>
<li>下载完后直接安装，然后查看对应的版本信息是否正确;</li>
</ul>
<p><img src="/res/img/blog/环境搭建/java-upgrade.png" alt=""></p>
<ul>
<li>顺手改一下<code>JAVA_HOME</code>的环境变量;</li>
</ul>
<p><img src="/res/img/blog/环境搭建/java-home.png" alt="java-home"></p>
<h3 id="3-安装-Nexus"><a href="#3-安装-Nexus" class="headerlink" title="3. 安装 Nexus"></a>3. 安装 <code>Nexus</code></h3><h4 id="3-1-下载Nexus"><a href="#3-1-下载Nexus" class="headerlink" title="3.1 下载Nexus"></a>3.1 下载<code>Nexus</code></h4><ul>
<li>从<a href="https://www.sonatype.com/download-oss-sonatype" target="_blank" rel="external">官网下载</a>对应的安装包到服务器</li>
</ul>
<p><strong>PS</strong>：建议在本机用迅雷下载完了在传上去，或者用一些快一点镜像站；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://www.sonatype.com/oss-thank-you-tar.gz</div></pre></td></tr></table></figure>
<h4 id="3-2-安装-Nexus"><a href="#3-2-安装-Nexus" class="headerlink" title="3.2 安装 Nexus"></a>3.2 安装 <code>Nexus</code></h4><ul>
<li>解压安装包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar zxvf oss-thank-you-tar.gz</div></pre></td></tr></table></figure>
<ul>
<li>安装成服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mv ./nexus-3.1.1-X86_64/  /usr/local/nexus3</div></pre></td></tr></table></figure>
<p>增加环境变量<code>NEXUS_HOME</code></p>
<p><img src="/res/img/blog/环境搭建/nexus.png" alt="nexus环境变量"></p>
<p>创建并开启服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sudo ln -s $NEXUS_HOME/bin/nexus /etc/init.d/nexus</div><div class="line">   cd /etc/init.d</div><div class="line">   sudo chkconfig --add nexus</div><div class="line">   sudo chkconfig --levels 345 nexus on</div><div class="line">   sudo service nexus start</div></pre></td></tr></table></figure>
<h3 id="4-配置-Nexus"><a href="#4-配置-Nexus" class="headerlink" title="4. 配置 Nexus"></a>4. 配置 <code>Nexus</code></h3><h4 id="4-1-配置WEB-访问"><a href="#4-1-配置WEB-访问" class="headerlink" title="4.1 配置WEB 访问"></a>4.1 配置<code>WEB</code> 访问</h4><ul>
<li>开启 <code>8081</code> 端口</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/sysconfig/iptables</div></pre></td></tr></table></figure>
<p>增加如下一条:</p>
<p><img src="/res/img/blog/环境搭建/iptables.png" alt="iptables"></p>
<ul>
<li>浏览器访问</li>
</ul>
<p>在浏览器中打开对应的URL 例如: <a href="http://10.140.22.205:8081" target="_blank" rel="external">http://10.140.22.205:8081</a>,默认管理员用户名和密码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">user: admin</div><div class="line">   pwd: admin123</div></pre></td></tr></table></figure>
<p><img src="/res/img/blog/环境搭建/maven.png" alt=""></p>
<p>默认<code>nexus</code>已经帮我们创建了五个库和两个组,我们可以直接使用,其中<code>Type</code>为<code>prosy</code>的为代理库,<code>Type</code>为<code>hosted</code>的为宿主库,<code>Type</code>为<code>group</code>的为组;</p>
<p>  一般用到的仓库种类是<code>hosted</code>、<code>proxy</code>。<code>Hosted</code>代表宿主仓库，用来发布一些第三方不允许的组件，比如<code>Oracle</code>驱动、比如商业软件<code>jar</code>包。<code>Proxy</code>代表代理远程的仓库，最典型的就是<code>Maven</code>官方中央仓库、<code>JBoss</code>仓库等等。如果构建的<code>Maven</code>项目本地仓库没有依赖包，那么就会去这个代理站点去下载，那么如果代理站点也没有此依赖包，就回去远程中央仓库下载依赖，这些中央仓库就是<code>proxy</code>。代理站点下载成功后再下载至本机。</p>
<h4 id="4-2-本地项目配置"><a href="#4-2-本地项目配置" class="headerlink" title="4.2 本地项目配置"></a>4.2 本地项目配置</h4><p>在项目的<code>pom.xml</code>或者<code>settings.xml</code>文件里加入一下配置信息（区别，<code>pom.xml</code>是针对当前项目，<code>settings.xml</code>是全局的针对所有项目）配置信息中的<code>id</code>,<code>name</code>和<code>url</code>跟上图中的仓库对应，<code>type</code>为<code>proxy</code>，说明它只是代理，只能用于下载<code>jar</code>包，不能用于发布项目。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>maven-central<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://10.140.22.205:8081/repository/maven-central/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">snapshotPolicy</span>&gt;</span>always<span class="tag">&lt;/<span class="name">snapshotPolicy</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></div></pre></td></tr></table></figure>
<p>其他使用可以<a href="https://segmentfault.com/a/1190000005966312" target="_blank" rel="external">参考这里</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS6.8下安装Maven</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/14/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-04-14-CentOS6-8%E4%B8%8B%E5%AE%89%E8%A3%85Maven/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/14/环境搭建-2017-04-14-CentOS6-8下安装Maven/</id>
    <published>2017-04-13T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-13</div><div class="line">版本 : 0.0.4</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="0-安装Maven前准备"><a href="#0-安装Maven前准备" class="headerlink" title="0. 安装Maven前准备"></a>0. 安装<code>Maven</code>前准备</h3><ul>
<li>确保系统已经安装了<code>Java</code>的运行环境;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 查看java版本，确保已经安装了java</div><div class="line">java -version</div></pre></td></tr></table></figure>
<p>终端输出如下内容说明已经安装了java，并且为 openJDK 系列的 <code>1.7.0_131</code> 版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@yafan2-xb src]# java -version</div><div class="line">java version &quot;1.7.0_131&quot;</div><div class="line">OpenJDK Runtime Environment (rhel-2.6.9.0.el6_8-x86_64 u131-b00)</div><div class="line">OpenJDK 64-Bit Server VM (build 24.131-b00, mixed mode)</div></pre></td></tr></table></figure>
<ul>
<li>确保系统已经配置了<code>JAVA_HOME</code>系统环境变量;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">env | grep JAVA_HOME</div><div class="line">   或者</div><div class="line">   echo $JAVA_HOME</div></pre></td></tr></table></figure>
<p>若是终端没有输出对应的值，则说明系统是没有配置<code>JAVA_HOME</code>环境变量的;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 查找 java 路径, 笔者电脑输出 /usr/bin/java</div><div class="line">which java</div><div class="line">   </div><div class="line">   # 查找 java 的真实路径 笔者电脑输出 /usr/bin/java -&gt; /etc/alternatives/java</div><div class="line">   ls -alh /usr/bin/java</div><div class="line">   </div><div class="line">   # 继续查找 java 的真实路径 笔者电脑输出 /etc/alternatives/java -&gt; /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java</div><div class="line">   ls -alh /etc/alternatives/java</div></pre></td></tr></table></figure>
<p>经过上一步找到了 <code>java</code> 的在当前系统中的真实可执行目录，按照如下方式配置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/profile</div></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">export JAVA_HOME=/usr/lib/jvm/jre-1.7.0-openjdk.x86_64</div><div class="line">export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div><div class="line">export PATH=$PATH:$JAVA_HOME/bin</div></pre></td></tr></table></figure>
<p>使新的环境变量生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /etc/profile</div></pre></td></tr></table></figure>
<h3 id="1-安装maven环境"><a href="#1-安装maven环境" class="headerlink" title="1.安装maven环境"></a>1.安装<code>maven</code>环境</h3><ul>
<li>下载<code>maven</code>二进制包</li>
</ul>
<p><code>maven</code>的官方下载地址<a href="Maven的下载地址是：http://maven.apache.org/download.cgi">在这里</a> 。 <strong>PS:</strong> 建议在下载时选择一个比较快的源,笔者选择的是清华大学的源,下载速度在 400K左右;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">   wget http://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.5.0/binaries/apache-maven-3.5.0-bin.tar.gz</div></pre></td></tr></table></figure>
<ul>
<li>解压并配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tar zxf apache-maven-3.5.0-bin.tar.gz</div><div class="line">mv apache-maven-3.5.0 /usr/local/maven3</div></pre></td></tr></table></figure>
<ul>
<li>配置环境变量(/etc/profile)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#在适当的位置添加</div><div class="line">export M2_HOME=/usr/local/maven3</div><div class="line">export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/bin</div></pre></td></tr></table></figure>
<p>使环境变量生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /etc/profile</div></pre></td></tr></table></figure>
<ul>
<li>验证版本</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn -v</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS下搭建GitLab服务器</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/13/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2014-10-17-Ubuntu14-04%E4%B8%8B%E9%85%8D%E7%BD%AEGitLab7/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/13/环境搭建-2014-10-17-Ubuntu14-04下配置GitLab7/</id>
    <published>2017-04-12T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-13</div><div class="line">版本 : 0.0.4</div></pre></td></tr></table></figure>
<a id="more"></a>
<hr>
<ul>
<li>TOC<br>{:toc}</li>
</ul>
<hr>
<h3 id="0-Gitlab-简介"><a href="#0-Gitlab-简介" class="headerlink" title="0 Gitlab 简介"></a>0 <code>Gitlab</code> 简介</h3><p>GitLab 是一个用于仓库管理系统的开源项目。使用Git作为代码管理工具，并在此基础上搭建起来的web服务。可通过Web界面进行访问公开的或者私人项目。它拥有与Github类似的功能，能够浏览源代码，管理缺陷和注释。可以管理团队对仓库的访问，它非常易于浏览提交过的版本并提供一个文件历史库。团队成员可以利用内置的简单聊天程序(Wall)进行交流。它还提供一个代码片段收集功能可以轻松实现代码复用。</p>
<hr>
<h3 id="1-Gitlab-的安装"><a href="#1-Gitlab-的安装" class="headerlink" title="1. Gitlab 的安装"></a>1. <code>Gitlab</code> 的安装</h3><p><code>Gitlab</code> 有两种安装方式:</p>
<table>
<thead>
<tr>
<th style="text-align:center">安装方式</th>
<th style="text-align:center">简介</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">源码方式安装</td>
<td style="text-align:center">这个有些费劲,时间充足喜欢折腾按照<a href="https://docs.gitlab.com.cn/ce/install/README.html" target="_blank" rel="external">链接文档</a>安装即可</td>
</tr>
<tr>
<td style="text-align:center"><code>Omnibus</code>方式安装</td>
<td style="text-align:center">这个简单,不出任何意外大约一个半小时左右安装完毕</td>
</tr>
</tbody>
</table>
<h3 id="1-1-采用-Omnibus-方式"><a href="#1-1-采用-Omnibus-方式" class="headerlink" title="1.1 采用 Omnibus 方式"></a>1.1 采用 <code>Omnibus</code> 方式</h3><p>根据<a href="https://www.gitlab.com.cn/downloads" target="_blank" rel="external">官网地址</a>，选择 <code>CentOS 6</code> 然后执行相应命令，即可完成安装操作，如果你用虚拟机，就直接用迅雷搞定，然后再拖进去吧，毕竟<code>200+M</code>,<a href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/" target="_blank" rel="external">下载连接在这里</a></p>
<p>如果你不想观看官网那么跟着下面步骤走：</p>
<h4 id="1-1-1-安装配置依赖项"><a href="#1-1-1-安装配置依赖项" class="headerlink" title="1.1.1 安装配置依赖项"></a>1.1.1 安装配置依赖项</h4><p>如想使用Postfix来发送邮件,在安装期间请选择’Internet Site’. 您也可以用sendmai或者 配置SMTP服务 并 使用SMTP发送邮件.在 Centos 6 和 7 系统上, 下面的命令将在系统防火墙里面开放HTTP和SSH端口.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo yum install curl openssh-server openssh-clients postfix cronie</div><div class="line">sudo service postfix start</div><div class="line">sudo chkconfig postfix on</div><div class="line">sudo lokkit -s http -s ssh</div></pre></td></tr></table></figure>
<h4 id="1-1-2-添加GitLab仓库-并安装到服务器上"><a href="#1-1-2-添加GitLab仓库-并安装到服务器上" class="headerlink" title="1.1.2 添加GitLab仓库,并安装到服务器上"></a>1.1.2 添加GitLab仓库,并安装到服务器上</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash</div><div class="line">sudo yum install gitlab-ce</div></pre></td></tr></table></figure>
<h4 id="1-1-3-启动-Gitlab"><a href="#1-1-3-启动-Gitlab" class="headerlink" title="1.1.3 启动 Gitlab"></a>1.1.3 启动 <code>Gitlab</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gitlab-ctl reconfigure</div></pre></td></tr></table></figure>
<hr>
<h3 id="2-邮箱配置"><a href="#2-邮箱配置" class="headerlink" title="2.邮箱配置"></a>2.邮箱配置</h3><p>当你按照提示安装好后，基本上就可以使用了，但是在使用的过程中，我们发现邮件通知功能不稳定，使用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /var/<span class="built_in">log</span>/mail.log</div></pre></td></tr></table></figure>
<p>查看后发现，邮件被当成了垃圾邮件，被退信了。<br>使用默认<code>Gitlab</code>的邮件服务的话，貌似被退信的几率比较高，因此我们需修改一下，毕竟邮件通知还是很重要的。我们注册一个邮箱账号，让<code>GitLab</code>通过该账号向我们发送邮件通知，这看起来就像两个人正常通信了，基本上就不会被退信了。</p>
<h4 id="2-1-注册邮箱"><a href="#2-1-注册邮箱" class="headerlink" title="2.1 注册邮箱"></a>2.1 注册邮箱</h4><p>注册QQ企业云邮箱不解释，记住用户名密码即可，你也可以随便使用其他邮箱服务器，不过不建议网易家的，他们会出现一些安全方面的拦截。</p>
<h4 id="2-2-配置邮箱"><a href="#2-2-配置邮箱" class="headerlink" title="2.2 配置邮箱"></a>2.2 配置邮箱</h4><p>修改发送邮件步骤如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/gitlab/gitlab.rb</div></pre></td></tr></table></figure>
<p>增加如下配置项，例:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">gitlab_rails['smtp_enable'] = true</div><div class="line">gitlab_rails['smtp_address'] = "smtp.exmail.qq.com"</div><div class="line">gitlab_rails['smtp_port'] = 465</div><div class="line">gitlab_rails['smtp_user_name'] = "youraccount"</div><div class="line">gitlab_rails['smtp_password'] = "yourPWD"</div><div class="line">gitlab_rails['smtp_authentication'] = "login"</div><div class="line">gitlab_rails['smtp_enable_starttls_auto'] = true</div><div class="line">gitlab_rails['smtp_tls'] = true</div><div class="line">gitlab_rails['gitlab_email_from'] = 'youraccount'</div></pre></td></tr></table></figure>
<p>修改完成后，需要执行以下命令使生效:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gitlab-ctl reconfigure.</div></pre></td></tr></table></figure>
<h4 id="2-3-测试邮箱"><a href="#2-3-测试邮箱" class="headerlink" title="2.3 测试邮箱"></a>2.3 测试邮箱</h4><ol>
<li>执行 gitlab-rails console</li>
<li>在上面步骤后执行：</li>
</ol>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Notify.test_email(<span class="string">'destination_email@address.com'</span>, <span class="string">'Message Subject'</span>, <span class="string">'Message Body'</span>).deliver_now</div></pre></td></tr></table></figure>
<p><strong>PS:</strong> 具体其他的请参考<a href="http://docs.gitlab.com/omnibus/settings/smtp.html" target="_blank" rel="external">这篇文档</a></p>
<h3 id="4-Gitlab-运维"><a href="#4-Gitlab-运维" class="headerlink" title="4. Gitlab 运维"></a>4. <code>Gitlab</code> 运维</h3><p>具体运维请参考<a href="https://docs.gitlab.com.cn/ce/README.html" target="_blank" rel="external">这篇文档</a></p>
<h4 id="4-1-管理"><a href="#4-1-管理" class="headerlink" title="4.1 管理"></a>4.1 管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 启动所有 gitlab 组件：</div><div class="line">sudo gitlab-ctl start</div><div class="line"></div><div class="line"># 停止所有 gitlab 组件：</div><div class="line">sudo gitlab-ctl stop</div><div class="line"></div><div class="line"># 重启所有 gitlab 组件：</div><div class="line">sudo gitlab-ctl restart</div></pre></td></tr></table></figure>
<h4 id="4-2-备份"><a href="#4-2-备份" class="headerlink" title="4.2 备份"></a>4.2 备份</h4><p>备份GitLab repositories and GitLab metadata</p>
<p>在 crontab 中加入如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 2 * * * /usr/bin/gitlab-rake gitlab:backup:create</div></pre></td></tr></table></figure>
<h4 id="4-3-恢复"><a href="#4-3-恢复" class="headerlink" title="4.3 恢复"></a>4.3 恢复</h4><p>首先进入备份 gitlab 的目录，这个目录是配置文件中的<code>gitlab_rails[&#39;backup_path&#39;]</code> ，默认为 <code>/var/opt/gitlab/backups</code> 。</p>
<p>然后停止 <code>unicorn 和 sidekiq</code> ，保证数据库没有新的连接，不会有写数据情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo gitlab-ctl stop unicorn</div><div class="line"># ok: down: unicorn: 0s, normally up</div><div class="line">sudo gitlab-ctl stop sidekiq</div><div class="line"># ok: down: sidekiq: 0s, normally up</div></pre></td></tr></table></figure>
<p>然后恢复数据，1406691018为备份文件的时间戳</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gitlab-rake gitlab:backup:restore BACKUP=1406691018</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>windows下服务程序相关</title>
    <link href="http://daodaoliang.com/uncategorized/2017/04/12/windows%E5%AD%A6%E4%B9%A0-2017-04-12-windows%E4%B8%8B%E9%9D%A2%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E7%9B%B8%E5%85%B3/"/>
    <id>http://daodaoliang.com/uncategorized/2017/04/12/windows学习-2017-04-12-windows下面服务程序相关/</id>
    <published>2017-04-11T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.964Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年11月25日
</code></pre><a id="more"></a>
<hr>
<h3 id="1-Windows-Service-编程实现"><a href="#1-Windows-Service-编程实现" class="headerlink" title="1. Windows Service 编程实现"></a>1. <code>Windows Service</code> 编程实现</h3><p>在windows平台下面编写 服务程序 免不了要去查看微软的开发者文档，相关的介绍在<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686953(v=vs.85).aspx" target="_blank" rel="external">这里</a>, 多了也就不在罗嗦了,如果你嫌弃直接用他们的<code>API</code>的话,可以使用别人已经封装好的，比如:</p>
<table>
<thead>
<tr>
<th style="text-align:center">参考代码</th>
<th style="text-align:center">连接</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/magicsih/WindowsService" target="_blank" rel="external">参考代码001</a></td>
<td style="text-align:center"><a href="https://github.com/magicsih/WindowsService" target="_blank" rel="external">https://github.com/magicsih/WindowsService</a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/Olster/windows_service" target="_blank" rel="external">参考代码002</a></td>
<td style="text-align:center"><a href="https://github.com/Olster/windows_service" target="_blank" rel="external">https://github.com/Olster/windows_service</a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/Kingston1/windows-service" target="_blank" rel="external">参考代码003</a></td>
<td style="text-align:center"><a href="https://github.com/Kingston1/windows-service" target="_blank" rel="external">https://github.com/Kingston1/windows-service</a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/horigome/sylph" target="_blank" rel="external">参考代码004</a></td>
<td style="text-align:center"><a href="https://github.com/horigome/sylph" target="_blank" rel="external">https://github.com/horigome/sylph</a></td>
</tr>
</tbody>
</table>
<h3 id="2-采用第三方封装的SCP"><a href="#2-采用第三方封装的SCP" class="headerlink" title="2. 采用第三方封装的SCP"></a>2. 采用第三方封装的SCP</h3><h3 id="2-1-nssm-Non-Sucking-Service-Manager"><a href="#2-1-nssm-Non-Sucking-Service-Manager" class="headerlink" title="2.1 nssm (Non-Sucking Service Manager)"></a>2.1 <code>nssm</code> (Non-Sucking Service Manager)</h3><ul>
<li><p>编译或者下载<code>nssm</code></p>
<p>  <a href="http://nssm.cc/download" target="_blank" rel="external">下载连接在这里</a>,一定要注意系统位数的区别，32位和64位;</p>
</li>
<li><p>使用方式</p>
</li>
</ul>
<p><img src="/res/img/blog/windows/nssm.png" alt="methods"></p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年11月25日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>windows脚本UAC获取</title>
    <link href="http://daodaoliang.com/windows%E5%AD%A6%E4%B9%A0/2017/04/12/windows%E5%AD%A6%E4%B9%A0-2017-04-12-windowsUAC/"/>
    <id>http://daodaoliang.com/windows学习/2017/04/12/windows学习-2017-04-12-windowsUAC/</id>
    <published>2017-04-11T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.964Z</updated>
    
    <content type="html"><![CDATA[<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">auther  =  <span class="string">'daodaoliang'</span></div><div class="line">version =  <span class="string">'V 0.0.1'</span></div><div class="line">date    =  <span class="string">'2017年04月12日'</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<hr>
<p>常用的windows下面的脚本，首先判断用户的管理员权限，而后进行<code>sc</code>的服务操作;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">echo off</div><div class="line">cls</div><div class="line">:-------------------------------------</div><div class="line">REM  --&gt; Check for permissions</div><div class="line">&gt;nul 2&gt;&amp;1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"</div><div class="line">REM --&gt; If error flag set, we do not have admin.</div><div class="line">if '%errorlevel%' NEQ '0' (</div><div class="line">    echo Requesting administrative privileges...</div><div class="line">    goto UACPrompt</div><div class="line">) else ( goto gotAdmin )</div><div class="line"></div><div class="line">:UACPrompt</div><div class="line">    echo Set UAC = CreateObject^("Shell.Application"^) &gt; "%temp%\getadmin.vbs"</div><div class="line">    set params = %*:"=""</div><div class="line">    echo UAC.ShellExecute "cmd.exe", "/c %~s0 %params%", "", "runas", 1 &gt;&gt; "%temp%\getadmin.vbs"</div><div class="line"></div><div class="line">    "%temp%\getadmin.vbs"</div><div class="line">    del "%temp%\getadmin.vbs"</div><div class="line">    exit /B</div><div class="line"></div><div class="line">:gotAdmin</div><div class="line">    pushd "%CD%"</div><div class="line">    CD /D "%~dp0"</div><div class="line">:--------------------------------------</div><div class="line"></div><div class="line">echo --- Logger Service Installer ---</div><div class="line">set /p servicename=Service name :</div><div class="line">echo Options:</div><div class="line">echo 1. Install</div><div class="line">echo 2. Start</div><div class="line">echo 3. Stop </div><div class="line">echo 4. Remove</div><div class="line">echo 5. Exit</div><div class="line">:CASE_init</div><div class="line">SET /P option="Option: "</div><div class="line">2&gt;NUL CALL :CASE_%option% # jump to :CASE_1, :CASE_2, CASE_3, CASE_4, CASE_5</div><div class="line">IF ERRORLEVEL 1 CALL :DEFAULT_CASE # if label doesn't exist</div><div class="line"></div><div class="line">ECHO Done.</div><div class="line">EXIT /B</div><div class="line"></div><div class="line">:CASE_1</div><div class="line"></div><div class="line">sc create %servicename% binPath= "yourpath/app.exe"</div><div class="line">GOTO CASE_init</div><div class="line">:CASE_2</div><div class="line">sc start %servicename%</div><div class="line">GOTO CASE_init</div><div class="line">:CASE_3</div><div class="line">sc stop %servicename%</div><div class="line">GOTO CASE_init</div><div class="line">:CASE_4</div><div class="line">sc delete %servicename%</div><div class="line">GOTO CASE_init</div><div class="line">:CASE_5</div><div class="line">GOTO END_CASE</div><div class="line">:DEFAULT_CASE</div><div class="line">ECHO Unknown option %option%</div><div class="line">GOTO CASE_init</div><div class="line">:END_CASE</div><div class="line">pause</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;auther  =  &lt;span class=&quot;string&quot;&gt;&#39;daodaoliang&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;version =  &lt;span class=&quot;string&quot;&gt;&#39;V 0.0.1&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;date    =  &lt;span class=&quot;string&quot;&gt;&#39;2017年04月12日&#39;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="windows学习" scheme="http://daodaoliang.com/categories/windows%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>最为常用的HASH算法</title>
    <link href="http://daodaoliang.com/c-%E5%AD%A6%E4%B9%A0/2017/03/08/c-%E5%AD%A6%E4%B9%A0-2017-03-08-HashAlgorithm/"/>
    <id>http://daodaoliang.com/c-学习/2017/03/08/c-学习-2017-03-08-HashAlgorithm/</id>
    <published>2017-03-07T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.963Z</updated>
    
    <content type="html"><![CDATA[<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年03月08日
</code></pre><p> murmurhash2算法 和 DJB Hash算法是目前最流行的hash算法</p>
<a id="more"></a>
<h3 id="1-DJB-HASH算法"><a href="#1-DJB-HASH算法" class="headerlink" title="1.DJB HASH算法"></a>1.DJB HASH算法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* the famous DJB Hash Function for strings */</span></div><div class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">DJBHash</span><span class="params">(<span class="keyword">char</span> *str)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> hash = <span class="number">5381</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (*str)&#123;</div><div class="line">       hash = ((hash &lt;&lt; <span class="number">5</span>) + hash) + (*str++); <span class="comment">/* times 33 */</span></div><div class="line">    &#125;</div><div class="line">    hash &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">31</span>); <span class="comment">/* strip the highest bit */</span></div><div class="line">    <span class="keyword">return</span> hash;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="2-murmurhash2"><a href="#2-murmurhash2" class="headerlink" title="2.murmurhash2"></a>2.murmurhash2</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uint32_t</span></div><div class="line">murmur_hash2(<span class="keyword">char</span> *data, <span class="keyword">size_t</span> len)</div><div class="line">&#123;  </div><div class="line">    <span class="keyword">uint32_t</span>  h, k;</div><div class="line">  </div><div class="line">    h = <span class="number">0</span> ^ len;</div><div class="line">  </div><div class="line">    <span class="keyword">while</span> (len &gt;= <span class="number">4</span>) &#123;</div><div class="line">        k  = data[<span class="number">0</span>];</div><div class="line">        k |= data[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>;</div><div class="line">        k |= data[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>;</div><div class="line">        k |= data[<span class="number">3</span>] &lt;&lt; <span class="number">24</span>;</div><div class="line">  </div><div class="line">        k *= <span class="number">0x5bd1e995</span>;</div><div class="line">        k ^= k &gt;&gt; <span class="number">24</span>;</div><div class="line">        k *= <span class="number">0x5bd1e995</span>;</div><div class="line"></div><div class="line">        h *= <span class="number">0x5bd1e995</span>;</div><div class="line">        h ^= k;</div><div class="line"></div><div class="line">        data += <span class="number">4</span>;</div><div class="line">        len -= <span class="number">4</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">switch</span> (len) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">        h ^= data[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>;</div><div class="line">    <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">        h ^= data[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>;</div><div class="line">    <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">        h ^= data[<span class="number">0</span>];</div><div class="line">        h *= <span class="number">0x5bd1e995</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    h ^= h &gt;&gt; <span class="number">13</span>;</div><div class="line">    h *= <span class="number">0x5bd1e995</span>;</div><div class="line">    h ^= h &gt;&gt; <span class="number">15</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> h;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年03月08日
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; murmurhash2算法 和 DJB Hash算法是目前最流行的hash算法&lt;/p&gt;
    
    </summary>
    
      <category term="c++学习" scheme="http://daodaoliang.com/categories/c-%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS6.5下升级NodeJs</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/02/17/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-02-17-CentOS%E4%B8%8B%E5%8D%87%E7%BA%A7NodeJs/"/>
    <id>http://daodaoliang.com/环境搭建/2017/02/17/环境搭建-2017-02-17-CentOS下升级NodeJs/</id>
    <published>2017-02-16T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 1.0.1
邮箱：daodaoliang@yeah.net
</code></pre><a id="more"></a>
<p>  <code>NodeJs</code> 是什么就不在赘述，可一直接参考<a href="https://nodejs.org/en/" target="_blank" rel="external">英文官网</a>，或者<a href="http://nodejs.cn/" target="_blank" rel="external">中文官网</a>，在项目中进行应用时，有时候需要用到最新版本的特性，但是CentOS系统为了稳定性，默认的源都是在该版本的操作系统发布时或者更新时的最稳定版本，所以仅仅是采用<code>yum update</code> 的操作是不能进行对应升级的。<br>  所以下面采用两种方式来进行在线升级。</p>
<h3 id="0x01-用-n-模块来进行-nodejs-升级"><a href="#0x01-用-n-模块来进行-nodejs-升级" class="headerlink" title="0x01 用 n 模块来进行 nodejs 升级"></a>0x01 用 <code>n</code> 模块来进行 <code>nodejs</code> 升级</h3><p>  在 <code>NodeJs</code> 中有一个模块叫做 <code>n</code> 专门用来管理 <code>NodeJs</code> 的版本。</p>
<ul>
<li><p>首先下载安装模块 <code>n</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g n</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>升级<code>NodeJs</code>到最新版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n stable</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>升级<code>NodeJs</code>到指定版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n 0.10.23</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="0x04-用编译好的二进制文件进行安装更新"><a href="#0x04-用编译好的二进制文件进行安装更新" class="headerlink" title="0x04 用编译好的二进制文件进行安装更新"></a>0x04 用编译好的二进制文件进行安装更新</h3><p>  在官网下载相关系统平台下面编译好的二进制包。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd node-v0.10.28-linux-x64/bin</div><div class="line">ls</div><div class="line">./node -v</div></pre></td></tr></table></figure>
<p>  上面的二进制文件就是编译好的新版本的<code>node</code>文件，不过并没有添加到环境变量里面，所以可以通过下面这种方式进行设置为全局变量</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ln -s /home/kun/mysofltware/node-v0.10.28-linux-x64/bin/node /usr/local/bin/node</div><div class="line">ln -s /home/kun/mysofltware/node-v0.10.28-linux-x64/bin/npm /usr/local/bin/npm</div></pre></td></tr></table></figure>
<h3 id="0x03-用源码的方式进行编译安装"><a href="#0x03-用源码的方式进行编译安装" class="headerlink" title="0x03 用源码的方式进行编译安装"></a>0x03 用源码的方式进行编译安装</h3><p>一般用方式一就可以完成升级安装，但是有时候会出现一些莫名其妙的错误，比如说是<code>segment fault</code>之类的错误，这个时候我只能用源码的方式进行编译安装。</p>
<p>首先<code>NodeJs</code>使用<code>C++</code>语言编写的，所以在编译源码时需要用到gcc-g++编译器，目前最新的<code>NodeJs</code>代码用到了<code>c11</code>的一些特性，所以对编译器的版本要求在4.8+所以首先要对编译器进行安装和升级。</p>
<ul>
<li><p>安装并升级编译器到4.8+</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">yum install gcc-c++ openssl-devel</div><div class="line">wget http://people.centos.org/tru/devtools-2/devtools-2.repo</div><div class="line">mv devtools-2.repo /etc/yum.repos.d</div><div class="line">yum install devtoolset-2-gcc devtoolset-2-binutils devtoolset-2-gcc-c++</div></pre></td></tr></table></figure>
</li>
</ul>
<p> 三个安装包被安装在<code>/opt/rh/devtoolset-2/root/</code>中</p>
<p> 更新软连接:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mv /usr/bin/gcc /usr/bin/gcc-4.4.7 </div><div class="line">mv /usr/bin/g++ /usr/bin/g++-4.4.7 </div><div class="line">mv /usr/bin/c++ /usr/bin/c++-4.4.7 </div><div class="line">ln -s /opt/rh/devtoolset-2/root/usr/bin/gcc /usr/bin/gcc </div><div class="line">ln -s /opt/rh/devtoolset-2/root/usr/bin/c++ /usr/bin/c++ </div><div class="line">ln -s /opt/rh/devtoolset-2/root/usr/bin/g++ /usr/bin/g++ </div><div class="line">gcc --version</div></pre></td></tr></table></figure>
<ul>
<li><p>检查核对<code>python</code>版本</p>
<p><code>nodejs</code>需要python版本在2.6版本以上，我们需要检查版本是否对应符合，如果不符合那就进行一下升级；</p>
</li>
<li><p>编译安装最新版本的<code>nodejs</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">wget http://nodejs.org/dist/node-latest.tar.gz</div><div class="line">tar -zxvf node-latest.tar.gz</div><div class="line">cd node-v0.12.7</div><div class="line">./configure</div><div class="line">make &amp;&amp; make install</div></pre></td></tr></table></figure>
</li>
</ul>
<p> 不管是用哪种方式进行升级都需要很长的时间，休息一会等着就好了，升级完成后查看一下版本信息；</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node -v</div></pre></td></tr></table></figure>
<p> <strong>PS:</strong> 在升级的过程中把<code>node</code> 运行的相关程序要关闭，不然会在编译时由于文件占用的关系产生错误.</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 1.0.1
邮箱：daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>linux内核漫画(转载)</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2017/02/06/linux%E5%AD%A6%E4%B9%A0-2017-02-06-linux%E5%86%85%E6%A0%B8%E6%BC%AB%E7%94%BB/"/>
    <id>http://daodaoliang.com/linux学习/2017/02/06/linux学习-2017-02-06-linux内核漫画/</id>
    <published>2017-02-05T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.964Z</updated>
    
    <content type="html"><![CDATA[<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月06日
</code></pre><p>网络上看到的觉得很形象就转载过来啦，伟大的Linux内核漫画化。</p>
<a id="more"></a>
<p><img src="/res/img/blog/linux学习/linux.jpeg" alt="linux 内核漫画"></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月06日
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;网络上看到的觉得很形象就转载过来啦，伟大的Linux内核漫画化。&lt;/p&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>linux下C++的编译过程</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2017/02/01/c-%E5%AD%A6%E4%B9%A0-2017-02-14-linux%E4%B8%8BC-%E7%9A%84%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B/"/>
    <id>http://daodaoliang.com/linux学习/2017/02/01/c-学习-2017-02-14-linux下C-的编译过程/</id>
    <published>2017-01-31T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.963Z</updated>
    
    <content type="html"><![CDATA[<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月01日
</code></pre><a id="more"></a>
<p>在linux下面c++程序从源码变成用户触手可用的可执行程序通常分为配置、编译和安装，具体的过程和描述如下.</p>
<h3 id="0x01-配置阶段-Configure"><a href="#0x01-配置阶段-Configure" class="headerlink" title="0x01 配置阶段(Configure)"></a>0x01 配置阶段(Configure)</h3><p>  一个生产环境的系统一般都是需要调用一些系统提供的功能库和一些其他功能库，由于系统环境的不同编译器需要知道系统库存在哪里，软件编译完成后安装在哪里，需要安装那些第三方组件等等，同时工程项目的文件也存在相互的引用和依赖关系，所有这些都需要在<code>configure</code>阶段解决。配置阶段完成以后会产生<code>makefile</code>文件。</p>
<h3 id="0x02-编译阶段-Make"><a href="#0x02-编译阶段-Make" class="headerlink" title="0x02 编译阶段(Make)"></a>0x02 编译阶段(Make)</h3><p>  编译阶段的就是把程序工程文件从人类可读经过处理后变成机器可执行的二进制指令码的过程，对于linux 下面 gcc 编译器来说一般是预处理、编译、汇编和链接。</p>
<h4 id="0x021-预处理-Preprocessing"><a href="#0x021-预处理-Preprocessing" class="headerlink" title="0x021 预处理(Preprocessing)"></a>0x021 预处理(Preprocessing)</h4><p>  预处理后的文件一般为<code>.i</code>结尾，这个过程一般包含以下几个子过程:</p>
<ul>
<li>展开宏定义，删除所有<code>#define</code>；</li>
<li>处理所有的条件预编译指令，<code>#if #ifdef #elif #else #endif</code> 等；</li>
<li>处理<code>#include</code>预编译指令，将被包含的文件插入到该预编译指令的位置；</li>
<li>删除所有的注释；</li>
<li>添加行号和文件标识，以便在编译时产生调试用的行号，以及编译错误的警告行号；</li>
<li><p>保留所有的<code>#pragma</code> 编译器指令，在编译阶段编译器需要使用；</p>
<p>通常如果只进行预处理的话一般用如下命令:</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -E hello.c -o hello.i</div></pre></td></tr></table></figure>
<h4 id="0x022-编译-Compilation"><a href="#0x022-编译-Compilation" class="headerlink" title="0x022 编译(Compilation)"></a>0x022 编译(Compilation)</h4><p>  编译的过程就是把工程文件进行一系列的词法分析、语法分析、语义分析、以及优化后生成相关的汇编代码；</p>
<p>  通常如果只进行编译处理的一般用如下命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -S hello.i -o hello.s</div></pre></td></tr></table></figure>
<h4 id="0x023-汇编-Assembly"><a href="#0x023-汇编-Assembly" class="headerlink" title="0x023 汇编(Assembly)"></a>0x023 汇编(Assembly)</h4><p>汇编器是将汇编代码转换成机器码</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -c hello.c -o hello.o</div></pre></td></tr></table></figure>
<p>  或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">as hello.s -o hello.o</div></pre></td></tr></table></figure>
<h4 id="0x024-连接-Linking"><a href="#0x024-连接-Linking" class="headerlink" title="0x024 连接(Linking)"></a>0x024 连接(Linking)</h4><p>链接的主要作用就是把各个二进制中间文件链接起来生成一个可执行的二进制文件，链接分为动态链接和静态连接:</p>
<ul>
<li>动态链接：链接阶段仅仅加入一些描述信息，而程序执行时再从系统中把相应的动态库加载到内存中。</li>
</ul>
<p><img src="/res/img/blog/c++/linking.jpg" alt="linux-C++编译过程"></p>
<h3 id="0x03-安装阶段-make-install"><a href="#0x03-安装阶段-make-install" class="headerlink" title="0x03 安装阶段(make install)"></a>0x03 安装阶段(make install)</h3><p>编译的整个过程都是在内存中进行，编译出来的二进制可执行文件也是存在编译时指定的位置，下一步就是将可执行文件安装到用户指定目录并做好善后工作，这其中包含，创建对应的目录，保存文件，设置权限等步骤；同时程序安装完成后也需要还需要进行操作系统的关联，创建快捷方式和做文件关联等等个性化需求。</p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月01日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="c++" scheme="http://daodaoliang.com/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>ssh超时时间设置</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2016/12/29/linux%E5%AD%A6%E4%B9%A0-2016-12-29-ssh%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4%E8%AE%BE%E7%BD%AE/"/>
    <id>http://daodaoliang.com/linux学习/2016/12/29/linux学习-2016-12-29-ssh超时时间设置/</id>
    <published>2016-12-28T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.965Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2016年12月29日
</code></pre><a id="more"></a>
<hr>
<h4 id="0x00-OpenSSH-简介"><a href="#0x00-OpenSSH-简介" class="headerlink" title="0x00 OpenSSH 简介"></a>0x00 OpenSSH 简介</h4><p><a href="http://www.openssh.com/" target="_blank" rel="external">OpenSSH</a>是采用SSH协议实现的重要的远程连接工具，它对所有的数据进行加密以防止被中途窃听，<a href="http://www.openssh.com/" target="_blank" rel="external">OpenSSH</a>提供了大量的安全通道的组件，比如：</p>
<ol>
<li>远程操作用<a href="http://man.openbsd.org/?query=ssh&amp;sektion=1" target="_blank" rel="external">ssh</a>、<a href="http://man.openbsd.org/?query=scp&amp;sektion=1" target="_blank" rel="external">scp</a>、<a href="http://man.openbsd.org/?query=sftp&amp;sektion=1" target="_blank" rel="external">sftp</a>;</li>
<li>秘钥管理用<a href="http://man.openbsd.org/?query=ssh-add&amp;sektion=1" target="_blank" rel="external">ssh-add</a>、<a href="http://man.openbsd.org/?query=ssh-keysign&amp;sektion=8" target="_blank" rel="external">ssh-keysign</a>、<a href="http://man.openbsd.org/?query=ssh-keyscan&amp;sektion=1" target="_blank" rel="external">ssh-keyscan</a>、<a href="http://man.openbsd.org/?query=ssh-keygen&amp;sektion=1" target="_blank" rel="external">ssh-keygen</a>;</li>
<li>服务端包含<a href="http://man.openbsd.org/?query=sshd&amp;sektion=8" target="_blank" rel="external">sshd</a>、<a href="http://man.openbsd.org/?query=sftp-server&amp;sektion=8" target="_blank" rel="external">sftp-server</a>、<a href="http://man.openbsd.org/?query=ssh-agent&amp;sektion=1" target="_blank" rel="external">ssh-agent</a>;</li>
</ol>
<h4 id="0x01-方案一"><a href="#0x01-方案一" class="headerlink" title="0x01 方案一"></a>0x01 方案一</h4><p>上面的所有信息可以自行去对应官网链接进行进一步的学习，在下面只讨论对于sshd的超时连接的问题。</p>
<ol>
<li>修改server端的配置文件<code>/etc/ssh/sshd_config</code></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># server每隔60秒给客户端发送一次保活信息包给客户端</span></div><div class="line">ClientAliveInterval 60</div><div class="line"></div><div class="line"><span class="comment"># server端发出的请求客户端没有回应的次数达到86400次的时候就断开连接，正常情况下客户端都会相应</span></div><div class="line">ClientAliveCountMax 86400</div></pre></td></tr></table></figure>
<ol>
<li>修改client端的配置文件<code>/etc/ssh/ssh_config</code></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># client 每隔60秒给客户端发送一次保活信息包给客户端</span></div><div class="line">ServerAliveInterval 60</div><div class="line"></div><div class="line"><span class="comment"># client 端发出的请求服务端没有回应的次数达到86400次的时候就断开连接，正常情况下服务端都会相应</span></div><div class="line">ServerAliveCountMax 86400</div></pre></td></tr></table></figure>
<h4 id="0x02-方案二"><a href="#0x02-方案二" class="headerlink" title="0x02 方案二"></a>0x02 方案二</h4><p>在命令参数里</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">ssh -o ServerAliveInterval=60</div></pre></td></tr></table></figure>
<p>这样子只会在需要的连接中保持持久连接，具体的参数请<a href="http://man.openbsd.org/sshd_config.5" target="_blank" rel="external">参考这里</a>。</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2016年12月29日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>windows下获取系统信息VBS脚本</title>
    <link href="http://daodaoliang.com/windows%E5%AD%A6%E4%B9%A0/2016/11/25/windows%E5%AD%A6%E4%B9%A0-2016-11-25-windows%E4%B8%8B%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AFVBS%E8%84%9A%E6%9C%AC/"/>
    <id>http://daodaoliang.com/windows学习/2016/11/25/windows学习-2016-11-25-windows下获取系统信息VBS脚本/</id>
    <published>2016-11-24T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.964Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月25日
</code></pre><a id="more"></a>
<hr>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div><div class="line">917</div><div class="line">918</div><div class="line">919</div><div class="line">920</div><div class="line">921</div><div class="line">922</div><div class="line">923</div><div class="line">924</div><div class="line">925</div><div class="line">926</div><div class="line">927</div><div class="line">928</div><div class="line">929</div><div class="line">930</div><div class="line">931</div><div class="line">932</div><div class="line">933</div><div class="line">934</div><div class="line">935</div><div class="line">936</div><div class="line">937</div><div class="line">938</div><div class="line">939</div><div class="line">940</div><div class="line">941</div><div class="line">942</div><div class="line">943</div><div class="line">944</div><div class="line">945</div><div class="line">946</div><div class="line">947</div><div class="line">948</div><div class="line">949</div><div class="line">950</div><div class="line">951</div><div class="line">952</div><div class="line">953</div><div class="line">954</div><div class="line">955</div><div class="line">956</div><div class="line">957</div><div class="line">958</div><div class="line">959</div><div class="line">960</div><div class="line">961</div><div class="line">962</div><div class="line">963</div><div class="line">964</div><div class="line">965</div><div class="line">966</div><div class="line">967</div><div class="line">968</div><div class="line">969</div><div class="line">970</div><div class="line">971</div><div class="line">972</div><div class="line">973</div><div class="line">974</div><div class="line">975</div><div class="line">976</div><div class="line">977</div><div class="line">978</div><div class="line">979</div><div class="line">980</div><div class="line">981</div><div class="line">982</div><div class="line">983</div><div class="line">984</div><div class="line">985</div><div class="line">986</div><div class="line">987</div><div class="line">988</div><div class="line">989</div><div class="line">990</div><div class="line">991</div><div class="line">992</div><div class="line">993</div><div class="line">994</div><div class="line">995</div><div class="line">996</div><div class="line">997</div><div class="line">998</div><div class="line">999</div></pre></td><td class="code"><pre><div class="line">'********************************************************************</div><div class="line">'*                                                                  *</div><div class="line">'*                           Begin of File                          *</div><div class="line">'*                                                                  *</div><div class="line">'*******************************************************************</div><div class="line"></div><div class="line"></div><div class="line">On Error Resume Next</div><div class="line"></div><div class="line">Const forwriting=2</div><div class="line">Const forreading=1</div><div class="line">Dim oFSO,oF,eventlog</div><div class="line"></div><div class="line"></div><div class="line">Text = "此脚本运行不会对您的系统造成任何损害或恶意行为" &amp;VbCrLf&amp;vbCrlf&amp; "通过连接WMI提供的公共接口枚举系统相关信息"&amp;VbCrLf&amp;VbCrLf&amp; "按确定键运行30秒左右会生成html格式报告"</div><div class="line">Title_Text = "bkReport  Version 2.2"</div><div class="line">MsgBox Text,vbExclamation+vbSystemModal,Title_Text</div><div class="line"></div><div class="line">dtmStart = Now()</div><div class="line"></div><div class="line">strComputer = "."</div><div class="line">Set oShell = WScript.CreateObject("WScript.Shell")</div><div class="line">hostname=oShell.ExpandEnvironmentStrings("%computername%")</div><div class="line">MainReport=hostname&amp;"_Report.html"</div><div class="line">EventReport=hostname&amp;"_EventLog.html"</div><div class="line">datec=Now()</div><div class="line">Set oFSO = CreateObject("Scripting.FileSystemObject")</div><div class="line">Set oF = oFSO.CreateTextFile(MainReport)</div><div class="line">Set eventlog=oFSO.CreateTextFile(EventReport)</div><div class="line"></div><div class="line">strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line"></div><div class="line">Set colComputers = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_ComputerSystem")</div><div class="line"></div><div class="line">For Each objComputer in colComputers</div><div class="line">   Select  Case objComputer.DomainRole</div><div class="line">    Case "0" machine= "独立工作站"</div><div class="line">    Case "1" machine= "成员工作站"</div><div class="line">    Case "2" machine= "独立服务器"</div><div class="line">    Case "3" machine= "成员服务器"</div><div class="line">    Case "4" machine= "备份服务器"</div><div class="line">    Case "5" machine= "主域控制器"</div><div class="line">   End Select</div><div class="line">Next</div><div class="line">oF.WriteLine "&lt;html&gt;"</div><div class="line">oF.WriteLine "&lt;head&gt;&lt;title&gt;MainReport Build by bkReport.vbs&lt;/title&gt;&lt;/head&gt;"</div><div class="line">oF.Writeline "&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</div><div class="line">oF.WriteLine "&lt;h2&gt;&lt;font color=MidnightBlue&gt;&lt;center&gt;"&amp;hostname&amp;"@"&amp;machine&amp;"   快照信息 &lt;/center&gt;&lt;/font&gt;&lt;/h2&gt;"</div><div class="line">oF.WriteLine "&lt;p align=right&gt;&lt;font size=2&gt;date: " &amp; Now()&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">oF.Writeline "&lt;hr width=80% color=#ff8000&gt;"</div><div class="line">oF.Writeline "&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</div><div class="line">oF.WriteLine "&lt;OL&gt;&lt;LI&gt;&lt;a href=#here1&gt;系统摘要&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here2&gt;BIOS信息&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here3&gt;环境变量&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here4&gt;系统文件内容&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here5&gt;网络状态&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here6&gt;磁盘和共享&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here7&gt;进程&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here8&gt;进程ID对应的启动服务&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here9&gt;服务&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here10&gt;补丁&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here11&gt;软件&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here12&gt;帐号&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here13&gt;AT创建的计划任务&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here14&gt;重要文件属性&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here15&gt;自启动项&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here16&gt;注册表&lt;/a&gt;"</div><div class="line">oF.WriteLine "&lt;LI&gt;&lt;a href=#here17&gt;系统日志&lt;/a&gt;&lt;/LI&gt;&lt;/OL&gt;"</div><div class="line">oF.Writeline "&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</div><div class="line">'---------------------------------</div><div class="line">'系统摘要</div><div class="line">' --------------------------------</div><div class="line"></div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer)</div><div class="line">Set colOperatingSystems = objWMIService.InstancesOf("Win32_OperatingSystem")</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here1&gt;"&amp;"[  1. 系统摘要  ]"&amp;"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</div><div class="line">oF.WriteLine "&lt;table BORDER=1 style=font-size:9pt cellspacing=1 align=CENTER&gt;"</div><div class="line">For Each objOperatingSystem In colOperatingSystems</div><div class="line">ostype=objOperatingSystem.Name</div><div class="line">LastbootUpTime=objOperatingSystem.LastBootUpTime</div><div class="line">'     oF.WriteLine "&lt;tr&gt;&lt;td&gt;&lt;b&gt;" &amp;"Name:            "&amp;"&lt;/b&gt;&lt;/td&gt;&lt;td&gt;"&amp; objOperatingSystem.Name &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"> '    oF.WriteLine  "&lt;tr&gt;&lt;td&gt;&lt;b&gt;" &amp; "Caption:         " &amp;"&lt;/b&gt;&lt;/td&gt;&lt;td&gt;" &amp;objOperatingSystem.Caption &amp;"&lt;/td&gt;&lt;/tr&gt;"    </div><div class="line">  '   oF.WriteLine  "&lt;tr&gt;&lt;td&gt;&lt;b&gt;" &amp; "LastBootUpTime:  "&amp;"&lt;/b&gt;&lt;/td&gt;&lt;td&gt;"&amp;objOperatingSystem.LastBootUpTime &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">   '  oF.WriteLine  "&lt;tr&gt;&lt;td&gt;&lt;b&gt;" &amp; "LocalDateTime:   " &amp;"&lt;/b&gt;&lt;/td&gt;&lt;td&gt;"&amp;objOperatingSystem.LocalDateTime &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    ' oF.WriteLine  "&lt;tr&gt;&lt;td&gt;&lt;b&gt;"&amp; "Version:         " &amp;"&lt;/b&gt;&lt;/td&gt;&lt;td&gt;"&amp;objOperatingSystem.Version    &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">     'oF.WriteLine  "&lt;tr&gt;&lt;td&gt;&lt;b&gt;"&amp; "Windows Directory: "&amp;"&lt;/b&gt;&lt;/td&gt;&lt;td&gt;"&amp;objOperatingSystem.WindowsDirectory&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line"></div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colItems = objWMIService.ExecQuery("Select * from Win32_MemoryArray")</div><div class="line"></div><div class="line">For Each objItem in colItems</div><div class="line">memsize =CLng(objItem.EndingAddress /1024)</div><div class="line">'    oF.WriteLine "memory size: " &amp; objItem.EndingAddress  /1024 &amp;" MB"</div><div class="line">Next</div><div class="line"></div><div class="line">Set objWMI = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set col = objWMI.ExecQuery("Select * from Win32_Processor")</div><div class="line"></div><div class="line">For Each obj in col</div><div class="line"></div><div class="line"></div><div class="line">    cpuinfo=obj.Name</div><div class="line">     Next</div><div class="line"></div><div class="line">oF.WriteLine "&lt;table BORDER=1 style=font-size:9pt&gt; &lt;tr&gt;&lt;th CLASS=pt bgColor=#808080&gt;OS&lt;/th&gt;&lt;th bgColor=#808080&gt;HostName&lt;/th&gt;&lt;th bgColor=#808080&gt;Memory&lt;/th&gt;&lt;th bgColor=#808080&gt;CPU&lt;/th&gt;&lt;th bgColor=#808080&gt;LastBootUpTime&lt;/th&gt;&lt;/tr&gt; "</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;ostype&amp;"&lt;/td&gt;&lt;td&gt;"&amp;hostname&amp;"&lt;/td&gt;&lt;td&gt;"&amp;memsize&amp;"MB&lt;/td&gt;&lt;td&gt;"&amp;cpuinfo&amp;"&lt;/td&gt;&lt;td&gt;"&amp; LastBootUpTime &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line"></div><div class="line"> strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:\\"&amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colAdapters = objWMIService.ExecQuery _</div><div class="line">  ("SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = True")</div><div class="line"></div><div class="line"> oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Adapter&lt;/th&gt;&lt;th bgColor=#808080&gt;MACaddr&lt;/th&gt;&lt;th bgColor=#808080&gt;IPaddr&lt;/th&gt;&lt;th bgColor=#808080&gt;Subnet&lt;/th&gt;&lt;th bgColor=#808080&gt;gateway&lt;/th&gt;&lt;/tr&gt; "</div><div class="line"></div><div class="line">For Each objAdapter in colAdapters</div><div class="line">  Adapter= objAdapter.Description</div><div class="line">  MACaddr= objAdapter.MACAddress</div><div class="line"></div><div class="line">   If Not IsNull(objAdapter.IPAddress) Then</div><div class="line">      For i = 0 To UBound(objAdapter.IPAddress)</div><div class="line">        IPaddr=objAdapter.IPAddress(i)</div><div class="line"></div><div class="line">      Next</div><div class="line">   End If</div><div class="line">   If Not IsNull(objAdapter.IPSubnet) Then</div><div class="line">      For i = 0 To UBound(objAdapter.IPSubnet)</div><div class="line">        Subnet=objAdapter.IPSubnet(i)</div><div class="line">      Next</div><div class="line">   End If</div><div class="line">   If Not IsNull(objAdapter.DefaultIPGateway) Then</div><div class="line">      For i = 0 To UBound(objAdapter.DefaultIPGateway)</div><div class="line">         gateway = objAdapter.DefaultIPGateway(i)</div><div class="line">      Next</div><div class="line">   End If</div><div class="line"></div><div class="line"></div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;Adapter&amp;"&lt;/td&gt;&lt;td&gt;"&amp;MACaddr&amp;"&lt;/td&gt;&lt;td&gt;"&amp;IPaddr&amp;"&lt;/td&gt;&lt;td&gt;"&amp;Subnet&amp;"&lt;/td&gt;&lt;td&gt;"&amp;gateway&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line"> Next</div><div class="line"> oF.WriteLine "&lt;/table&gt;"  </div><div class="line"></div><div class="line"></div><div class="line"> '--------------------------------------------------------------------</div><div class="line"> 'BIOS信息</div><div class="line"> '--------------------------------------------------------------------</div><div class="line"> oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here2&gt;"&amp;"[  2. BIOS信息  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line"> Set objWMIService = GetObject("winmgmts:" _</div><div class="line">    &amp; "&#123;impersonationLevel=impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colBIOS = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_BIOS")</div><div class="line">     oF.WriteLine "&lt;TABLE BORDER=1 WIDTH=800 style=font-size:9pt cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;"</div><div class="line">For Each objBIOS in colBIOS</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp;"Build Number: " &amp;objBIOS.BuildNumber&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">   oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp;"Current Language: " &amp;objBIOS.CurrentLanguage&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp;"Installable Languages: " &amp;objBIOS.InstallableLanguages&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">   oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Manufacturer: " &amp;objBIOS.Manufacturer&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">   oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Name: "&amp;objBIOS.Name&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">   oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Primary BIOS: "&amp; objBIOS.PrimaryBIOS&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Release Date: " &amp;objBIOS.ReleaseDate&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Serial Number: " &amp; objBIOS.SerialNumber&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "SMBIOS Version: " &amp;objBIOS.SMBIOSBIOSVersion&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line"></div><div class="line">   oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp;"SMBIOS Minor Version: " &amp;objBIOS.SMBIOSMinorVersion&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">   oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "SMBIOS Present: " &amp;objBIOS.SMBIOSPresent&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Status: " &amp;objBIOS.Status&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "Version: " &amp;objBIOS.Version&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    oF.WriteLine  "&lt;p&gt;&lt;font size=2&gt;"&amp; "BIOS Characteristics: "&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line"></div><div class="line">Next</div><div class="line"> oF.WriteLine  "&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> '-----------------------------------------------------------------</div><div class="line"> '环境变量</div><div class="line"> '-----------------------------------------------------------------</div><div class="line"> oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here3&gt;"&amp;"[  3. 环境变量  ]"&amp;"&lt;/a&gt;&lt;/font &lt;/h3&gt;"</div><div class="line"> Set wshshell = CreateObject("WScript.Shell")</div><div class="line">oF.WriteLine "&lt;TABLE BORDER=1 WIDTH=800 style=font-size:9pt cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;"</div><div class="line">oF.writeline "&lt;b&gt;&lt;font size=3&gt;SYSTEM variables&lt;/font&gt;&lt;/b&gt;"</div><div class="line">For Each EnvirSYSTEM In wshshell.Environment("SYSTEM")</div><div class="line"> oF.writeline "&lt;p&gt;&lt;font size=2&gt;" &amp;EnvirSYSTEM &amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line"></div><div class="line">Next</div><div class="line">  oF.writeline "&lt;b&gt;&lt;font size=3&gt;PROCESS variables&lt;/font&gt;&lt;/b&gt;"</div><div class="line">For Each EnvirPROCESS In wshshell.Environment("PROCESS")</div><div class="line"> oF.writeline "&lt;p&gt;&lt;font size=2&gt;"&amp;EnvirPROCESS &amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">Next</div><div class="line">  oF.writeline "&lt;b&gt;&lt;font size=3&gt;USER variables&lt;/font&gt;&lt;/b&gt;"</div><div class="line">For Each EnvirUSER In wshshell.Environment("USER")</div><div class="line"> oF.writeline "&lt;p&gt;&lt;font size=2&gt;"&amp;EnvirUSER &amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">Next</div><div class="line"> oF.writeline "&lt;b&gt;&lt;font size=3&gt;VOLATILE variables&lt;/font&gt;&lt;/b&gt;"</div><div class="line">For Each EnvirVOLATILE In wshshell.Environment("VOLATILE")</div><div class="line"> oF.writeline "&lt;p&gt;&lt;font size=2&gt;"&amp;EnvirVOLATILE &amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">Next</div><div class="line"></div><div class="line">set wshshell=Nothing</div><div class="line"> oF.WriteLine  "&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</div><div class="line"> '----------------------------------</div><div class="line"> '系统文件</div><div class="line"> '----------------------------------</div><div class="line"> oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here4&gt;"&amp;"[  4. 系统文件内容  ]"&amp;"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</div><div class="line"></div><div class="line"> Set wshshell=wscript.CreateObject("WScript.shell")</div><div class="line">autoexecBAT=wshshell.expandEnvironmentStrings("%systemdrive%")&amp;"\autoexec.bat"</div><div class="line">configSYS=wshshell.expandEnvironmentStrings("%systemdrive%")&amp;"\config.sys"</div><div class="line">bootINI=wshshell.expandEnvironmentStrings("%systemdrive%")&amp;"\boot.ini"</div><div class="line">winINI=wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\win.ini"</div><div class="line">systemINI=wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system.ini"</div><div class="line">autoexecNT=wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\autoexec.nt"</div><div class="line">configNT=wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\config.nt"</div><div class="line">HOSTS=wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\drivers\etc\hosts"</div><div class="line">Function readtxt (txtfile)</div><div class="line">Set objFSO = CreateObject("Scripting.FileSystemObject")</div><div class="line">Set objFile = objFSO.OpenTextFile(txtfile, 1)</div><div class="line"> oF.WriteLine "&lt;TABLE BORDER=1 WIDTH=800 cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;&lt;b&gt;&lt;font size=3&gt;" &amp;txtfile &amp;"&lt;/font&gt;&lt;/b&gt;"</div><div class="line">Do Until objFile.AtEndOfStream</div><div class="line">    strCharacters = objFile.Readline</div><div class="line">     oF.WriteLine "&lt;p&gt;&lt;font size=2&gt;" &amp;strCharacters &amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">Loop</div><div class="line">oF.WriteLine  "&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</div><div class="line">End Function</div><div class="line">readtxt (autoexecBAT)</div><div class="line">readtxt (configSYS)</div><div class="line">readtxt (bootINI)</div><div class="line">readtxt (winINI)</div><div class="line">readtxt (systemINI)</div><div class="line">readtxt (autoexecNT)</div><div class="line">readtxt (configNT)</div><div class="line">readtxt (HOSTS)</div><div class="line"></div><div class="line"></div><div class="line"> '---------------------------------</div><div class="line">'网络状态</div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;"&amp;"&lt;font color=MidnightBlue&gt;&lt;a name=here5&gt;"&amp;"[  5. 网络状态  ]"&amp;"&lt;/a&gt;&lt;/font &gt;"&amp;"&lt;/h3&gt;"</div><div class="line"></div><div class="line">Dim f1</div><div class="line">Set ws=WScript.CreateObject ("wscript.shell")</div><div class="line">ws.run "%comspec% /c echo ######################### ipconfig /all #########################  &gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c ipconfig /all  &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### netstat -r ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c netstat -r &gt;&gt;ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### arp -a ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c arp -a &gt;&gt;ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### netstat -an ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c netstat -an &gt;&gt;ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### nbtstat -r ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c nbtstat -r &gt;&gt;ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### nbtstat -n  ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c nbtstat -n &gt;&gt;ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### nbtstat -S ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c nbtstat -S &gt;&gt;ttmp",0,True</div><div class="line">ws.run "%comspec% /c echo ######################### netstat -es ######################### &gt;&gt; ttmp",0,True</div><div class="line">ws.run "%comspec% /c netstat -es &gt;&gt;ttmp",0,True</div><div class="line"></div><div class="line">Set f1=oFSO.OpenTextFile ("ttmp",forreading,True)</div><div class="line">oF.WriteLine "&lt;TABLE BORDER=1 WIDTH=800 cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;"</div><div class="line">Do Until  f1.AtEndOfStream</div><div class="line">a=f1.ReadLine</div><div class="line">oF.WriteLine "&lt;p&gt;&lt;font size=2&gt;" &amp;a&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">Loop</div><div class="line">oF.WriteLine  "&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</div><div class="line">f1.Close</div><div class="line">ofso.DeleteFile "ttmp",True</div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'检查磁盘和共享</div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here6&gt;"&amp;"[ 6. 磁盘和共享  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line">Sub Enudisk</div><div class="line">oF.writeline "&lt;table BORDER=1 style=font-size:9pt cellspacing=1&gt;"</div><div class="line">On Error Resume Next</div><div class="line">'Enumerate Disk Drive Properties 用了除法转成MB单位，并用clng函数取整</div><div class="line">Set objFSO = CreateObject("Scripting.FileSystemObject")</div><div class="line">Set colDrives = objFSO.Drives</div><div class="line">of.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Drive letter: &lt;/th&gt;&lt;th bgColor=#808080&gt;Volume name: &lt;/th&gt;&lt;th bgColor=#808080&gt;File system: &lt;/th&gt;&lt;th bgColor=#808080&gt;Total size: &lt;/th&gt;&lt;th bgColor=#808080&gt;Free space: &lt;/th&gt;&lt;/tr&gt;"</div><div class="line">For Each objDrive in colDrives</div><div class="line">    of.writeline "&lt;tr&gt;&lt;td&gt;" &amp; objDrive.DriveLetter &amp;"&lt;/td&gt;"&amp;_</div><div class="line">    "&lt;td&gt;" &amp; objDrive.VolumeName&amp;"&lt;/td&gt;"&amp;_</div><div class="line">   "&lt;td&gt;" &amp; objDrive.FileSystem&amp;"&lt;/td&gt;"&amp;_</div><div class="line">    "&lt;td&gt;" &amp;  clng(objDrive.TotalSize /1024 /1024 ) &amp;"MB"&amp;"&lt;/td&gt;"&amp;_</div><div class="line">   "&lt;td&gt;" &amp;  CLng(objDrive.FreeSpace /1024 /1024 ) &amp;"MB"&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">Next</div><div class="line">If Err &lt;&gt;0 Then</div><div class="line"></div><div class="line">Err.Clear</div><div class="line">End If</div><div class="line"></div><div class="line">End Sub</div><div class="line"></div><div class="line">Enudisk</div><div class="line"></div><div class="line"></div><div class="line">strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colItems = objWMIService.ExecQuery("Select * from Win32_Share",,48)</div><div class="line"></div><div class="line">    of.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Path: &lt;/th&gt;&lt;th bgColor=#808080&gt;Name: &lt;/th&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;th bgColor=#808080&gt;Status:&lt;/th&gt;&lt;th bgColor=#808080&gt;MaximumAllowed:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">For Each objItem in colItems</div><div class="line">    of.writeline "&lt;tr&gt;&lt;td&gt;"&amp; objItem.Path&amp;"&lt;/td&gt;"&amp;  _</div><div class="line">     "&lt;td&gt;" &amp; objItem.Name&amp;"&lt;/td&gt;"&amp; _</div><div class="line">    "&lt;td&gt;"  &amp; objItem.Caption&amp;"&lt;/td&gt;"&amp; _</div><div class="line">    "&lt;td&gt;" &amp; objItem.Status&amp;"&lt;/td&gt;"&amp;_</div><div class="line">     "&lt;td&gt;" &amp;objItem.MaximumAllowed &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">Next</div><div class="line"></div><div class="line">oF.WriteLine "&lt;/table&gt;"     </div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'检测进程  </div><div class="line">' --------------------------------</div><div class="line"></div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here7&gt;"&amp;"[  7. 进程  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line">Set objWMI = _</div><div class="line">   GetObject("winmgmts:&#123;impersonationLevel=impersonate&#125;//./root/cimv2")</div><div class="line">Set colProcessList = objWMI.ExecQuery("SELECT * FROM Win32_Process")</div><div class="line">Set objFSO = CreateObject("Scripting.FileSystemObject")</div><div class="line"></div><div class="line">oF.WriteLine "&lt;table BORDER=1  WIDTH=%100 style=font-size:9pt cellspacing=1&gt;"</div><div class="line">oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;UserDomain&lt;/th&gt;&lt;th bgColor=#808080&gt;Ownership&lt;/th&gt;&lt;th bgColor=#808080&gt;CreationDate&lt;/th&gt;&lt;th bgColor=#808080&gt;Process ID:&lt;/th&gt;&lt;th bgColor=#808080&gt;Process Name:&lt;/th&gt;"&amp;"&lt;th bgColor=#808080&gt;Executable Path:&lt;/th&gt;&lt;th bgColor=#808080&gt;Size:&lt;/th&gt;&lt;th bgColor=#808080&gt;File created:&lt;/th&gt;&lt;th bgColor=#808080&gt;File last modified:&lt;/th&gt;&lt;th bgColor=#808080&gt;File last accessed:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">For Each colprocess In colProcessList</div><div class="line"></div><div class="line">colProperties=colProcess.GetOwner(strNameOfUser,strUserDomain)</div><div class="line">Set objFile = objFSO.GetFile (colProcess.ExecutablePath)</div><div class="line">   oF.WriteLine "&lt;tr&gt;&lt;td&gt;" &amp; strUserDomain  &amp; "&lt;/td&gt;&lt;td&gt;"&amp;strNameOfUser&amp;"&lt;/td&gt;&lt;td&gt;"&amp; colProcess.CreationDate&amp;"&lt;/td&gt;&lt;td&gt;"&amp;colProcess.Processid &amp;"&lt;/td&gt;&lt;td&gt;" &amp;colprocess.name&amp;"&lt;/td&gt;&lt;td&gt;"&amp;colProcess.ExecutablePath &amp; "&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.Size &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;" &amp;  objFile.DateCreated &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.DateLastModified &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.DateLastAccessed &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line"></div><div class="line">oF.WriteLine "&lt;/table&gt;"</div><div class="line">'---------------------------------</div><div class="line">'检测进程id对应的服务  </div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here8&gt;"&amp;"[  8. 进程ID对应的启动服务  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line">  set objIdDictionary = CreateObject("Scripting.Dictionary")</div><div class="line">strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:" _</div><div class="line">    &amp; "&#123;impersonationLevel=impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colServices = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_Service Where State &lt;&gt; 'Stopped'")</div><div class="line">For Each objService in colServices</div><div class="line">    If objIdDictionary.Exists(objService.ProcessID) Then</div><div class="line">    Else</div><div class="line">        objIdDictionary.Add objService.ProcessID, objService.ProcessID</div><div class="line">    End If</div><div class="line">Next</div><div class="line">colProcessIDs = objIdDictionary.Items</div><div class="line">oF.WriteLine "&lt;TABLE BORDER=1 style=font-size:9pt cellspacing=1&gt;"</div><div class="line">For i = 0 to objIdDictionary.Count - 1</div><div class="line">    Set colServices = objWMIService.ExecQuery _</div><div class="line">        ("Select * from Win32_Service Where ProcessID = '" &amp; _</div><div class="line">            colProcessIDs(i) &amp; "'")</div><div class="line">   oF.WriteLine "&lt;TR&gt;&lt;TH bgColor=#808080&gt;Process ID: &lt;/TH&gt;&lt;td&gt;" &amp;colProcessIDs(i)&amp;"&lt;td/&gt;"</div><div class="line">    For Each objService in colServices</div><div class="line">          oF.WriteLine "&lt;tr&gt;&lt;td COLSPAN=2&gt;" &amp; objService.DisplayName &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    Next</div><div class="line">Next</div><div class="line"> oF.WriteLine  "&lt;/TABLE&gt;"</div><div class="line">'---------------------------------</div><div class="line">'检测服务  </div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;"&amp;"&lt;font color=MidnightBlue&gt;&lt;a name=here9&gt;"&amp;"[   9. 服务  ]"&amp;"&lt;/a&gt;&lt;/font &gt;"&amp;"&lt;/h3&gt;"</div><div class="line">strComputer = "."  </div><div class="line"></div><div class="line"></div><div class="line">Set objWMIService = GetObject("winmgmts:" &amp; _</div><div class="line">    "&#123;impersonationLevel=Impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colStartServices = objWMIService.ExecQuery _</div><div class="line">  ("SELECT DisplayName,State FROM Win32_Service WHERE State = 'Running'")</div><div class="line"></div><div class="line">oF.WriteLine "&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Running server list:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">of.writeline "&lt;tr&gt;&lt;td&gt;"</div><div class="line">For Each objService in colStartServices</div><div class="line">    of.writeline  "&lt;p&gt;" &amp; objService.DisplayName &amp; "&lt;/p&gt;"  </div><div class="line">Next</div><div class="line">oF.WriteLine "&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"                  </div><div class="line"></div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer)</div><div class="line">Set colServices = objWMIService.InstancesOf("Win32_Service")</div><div class="line"></div><div class="line">oF.WriteLine "&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</div><div class="line"></div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Display Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Path Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Start Mode:&lt;/th&gt;&lt;th bgColor=#808080&gt;State:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">For Each objService In colServices</div><div class="line">    oF.WriteLine "&lt;tr&gt;"&amp;"&lt;td&gt;" &amp;objService.Name    &amp;"&lt;/td&gt;"&amp;_    </div><div class="line">                "&lt;td&gt;" &amp; objService.DisplayName&amp;"&lt;/td&gt;"&amp; _</div><div class="line">                "&lt;td&gt;" &amp; objService.PathName     &amp;"&lt;/td&gt;"&amp; _</div><div class="line">                "&lt;td&gt;" &amp; objService.StartMode    &amp;"&lt;/td&gt;"&amp; _</div><div class="line">                 "&lt;td&gt;" &amp;objService.State        &amp;"&lt;/td&gt;"</div><div class="line"></div><div class="line">Next                                           </div><div class="line">oF.WriteLine "&lt;/tr&gt;&lt;/table&gt;"                                </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'检测补丁</div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;"&amp;"&lt;font color=MidnightBlue&gt;&lt;a name=here10&gt;"&amp;"[  10. 补丁  ]"&amp;"&lt;/a&gt;&lt;/font &gt;"&amp;"&lt;/h3&gt;"</div><div class="line"></div><div class="line">strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:" _</div><div class="line">    &amp; "&#123;impersonationLevel=impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colOperatingSystems = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_OperatingSystem")</div><div class="line">For Each objOperatingSystem in colOperatingSystems</div><div class="line">    PACKVER = objOperatingSystem.ServicePackMajorVersion  _</div><div class="line">        &amp; "." &amp; objOperatingSystem.ServicePackMinorVersion</div><div class="line">        Next</div><div class="line"></div><div class="line">Set objWMIService = GetObject("winmgmts:" _</div><div class="line">&amp; "&#123;impersonationLevel=impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colQuickFixes = objWMIService.ExecQuery _</div><div class="line">("Select * from Win32_QuickFixEngineering")</div><div class="line"></div><div class="line">oF.WriteLine "&lt;table BORDER=1 style=font-size:9pt cellspacing=1&gt;"</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;PackVersion: &lt;/th&gt;&lt;td&gt;"&amp;PACKVER&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">'   oF.WriteLine "&lt;td&gt;Computer: &lt;/td&gt;"</div><div class="line">   oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Description:&lt;/th&gt;"</div><div class="line">   oF.WriteLine "&lt;th bgColor=#808080&gt;Hotfix ID:&lt;/th&gt;"</div><div class="line"> '   oF.WriteLine "&lt;td&gt;Installation Date:&lt;/td&gt;"</div><div class="line"> '  oF.WriteLine "&lt;td&gt;Installed By:&lt;/td&gt;"</div><div class="line">   oF.WriteLine "&lt;/tr&gt;"</div><div class="line">For Each objQuickFix in colQuickFixes</div><div class="line">   oF.WriteLine "&lt;tr&gt;"</div><div class="line">'    oF.WriteLine "&lt;td&gt;" &amp; objQuickFix.CSName &amp; "&lt;/td&gt;"</div><div class="line">   oF.WriteLine "&lt;td&gt;" &amp; objQuickFix.Description &amp; "&lt;/td&gt;"</div><div class="line">   oF.WriteLine "&lt;td&gt;" &amp; objQuickFix.HotFixID &amp; "&lt;/td&gt;"</div><div class="line">'   oF.WriteLine "&lt;td&gt;" &amp; objQuickFix.InstallDate &amp; "&lt;/td&gt;"</div><div class="line">'    oF.WriteLine "&lt;td&gt;" &amp; objQuickFix.InstalledBy &amp; "&lt;/td&gt;"</div><div class="line">   oF.WriteLine "&lt;/tr&gt;"</div><div class="line">Next</div><div class="line">oF.WriteLine "&lt;/table&gt;"</div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'检测软件</div><div class="line">' --------------------------------</div><div class="line">'get installed software</div><div class="line">oF.WriteLine "&lt;h3&gt;"&amp;"&lt;font color=MidnightBlue&gt;&lt;a name=here11&gt;"&amp;"[  11. 软件  ]"&amp;"&lt;/a&gt;&lt;/font &gt;"&amp;"&lt;/h3&gt;"</div><div class="line">oF.WriteLine "&lt;table BORDER=1 style=font-size:9pt cellspacing=1&gt;"</div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;th bgColor=#808080&gt;version:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">Set colApps = objWMIService.ExecQuery("Select * from Win32_Product")</div><div class="line">For Each objApp in colApps</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;objApp.Caption &amp;"&lt;/td&gt;&lt;td&gt;"&amp; objApp.Version &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line"></div><div class="line">Dim oRegistry, sBaseKey, iRC, sKey, arSubKeys, sValue</div><div class="line">Const HKLM = &amp;H80000002 'HKEY_LOCAL_MACHINE</div><div class="line">Set oRegistry = GetObject("winmgmts:\\" &amp; strComputer  &amp; _</div><div class="line">"/root/default:StdRegProv")</div><div class="line"></div><div class="line">sBaseKey = "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\"</div><div class="line"></div><div class="line">iRC = oRegistry.EnumKey(HKLM, sBaseKey, arSubKeys)</div><div class="line">For Each sKey In arSubKeys</div><div class="line">  iRC = oRegistry.GetStringValue(HKLM, sBaseKey &amp; sKey, _</div><div class="line">  "DisplayName", sValue)</div><div class="line"></div><div class="line">  version= oRegistry.GetStringValue(HKLM, sBaseKey &amp; sKey, _</div><div class="line">  "DisplayVersion", sVer)</div><div class="line"></div><div class="line"></div><div class="line">  If iRC &lt;&gt; 0 Then</div><div class="line">    oRegistry.GetStringValue HKLM, sBaseKey &amp; sKey, _</div><div class="line">    "QuietDisplayName", sValue</div><div class="line">  End If</div><div class="line"></div><div class="line"></div><div class="line">  If sValue &lt;&gt; "" Then</div><div class="line">    	of.writeline"&lt;tr&gt;&lt;td&gt;" &amp; sValue &amp; "&lt;/td&gt;&lt;td&gt;" &amp; sver &amp; "&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">  ElseIf Err &lt;&gt; 0 Then</div><div class="line">	of.writeline"&lt;tr&gt;&lt;td&gt;"&amp; "Installed App Name Not Available" &amp; "&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">  	err.clear</div><div class="line">	err.Number=0</div><div class="line">  End If</div><div class="line">Next</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Const ADMINISTRATIVE_TOOLS = &amp;H2f&amp;</div><div class="line">Set objShell = CreateObject("Shell.Application")</div><div class="line">Set objFolder = objShell.Namespace(ADMINISTRATIVE_TOOLS)</div><div class="line">Set objTools = objFolder.Items</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Admin tools:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">For i = 0 to objTools.Count - 1</div><div class="line">   oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp; objTools.Item(i)&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line">oF.WriteLine "&lt;/table&gt;"</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'检测帐号</div><div class="line">' --------------------------------</div><div class="line"></div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here12&gt;"&amp;"[  12. 帐号  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line"></div><div class="line">strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colItems = objWMIService.ExecQuery("Select * from Win32_UserAccount",,48)</div><div class="line">oF.WriteLine "&lt;table width=100% BORDER=1 style=font-size:9pt  cellspacing=1&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;" &amp;"Name: "&amp; "&lt;/th&gt;"_</div><div class="line">    &amp;"&lt;th bgColor=#808080&gt;"&amp;"Description: "&amp; "&lt;/th&gt;"_</div><div class="line">    &amp;"&lt;th bgColor=#808080&gt;"&amp;"Lockout: "&amp; "&lt;/th&gt;"_</div><div class="line">     &amp;"&lt;th bgColor=#808080&gt;"&amp;"PasswordChangeable: "&amp; "&lt;/th&gt;"_</div><div class="line">     &amp;"&lt;th bgColor=#808080&gt;"&amp;"PasswordExpires: "&amp; "&lt;/t&gt;"_</div><div class="line">     &amp;"&lt;th bgColor=#808080&gt;"&amp;"SID: " &amp; "&lt;/th&gt;"_</div><div class="line">     &amp;"&lt;th bgColor=#808080&gt;"&amp; "Status: "&amp; "&lt;/th&gt;"_</div><div class="line">     &amp;"&lt;th bgColor=#808080&gt;"&amp; "administrators: "&amp; "&lt;/th&gt;"</div><div class="line">For Each objItem in colItems</div><div class="line"> strUser = objItem.Name</div><div class="line"></div><div class="line">Set objGroup = GetObject("WinNT://" &amp; strComputer &amp; "/Administrators")</div><div class="line"></div><div class="line">   oF.writeline  "&lt;tr&gt;&lt;td&gt;" &amp; objItem.Name &amp;"&lt;/td&gt;&lt;td&gt;" &amp; _</div><div class="line">    objItem.Description &amp;"&lt;/td&gt;&lt;td&gt;" &amp; _</div><div class="line">    objItem.Lockout &amp;"&lt;/td&gt;&lt;td&gt;" &amp; _</div><div class="line">    objItem.PasswordChangeable &amp;"&lt;/td&gt;&lt;td&gt;" &amp; _</div><div class="line">    objItem.PasswordExpires &amp;"&lt;/td&gt;&lt;td&gt;" &amp; _</div><div class="line">    objItem.SID &amp;"&lt;/td&gt;&lt;td&gt;" &amp; _</div><div class="line">    objItem.Status&amp;"&lt;/td&gt;"</div><div class="line"></div><div class="line">    For Each objUser in objGroup.Members</div><div class="line">    If objUser.Name = strUser Then</div><div class="line">        oF.writeline "&lt;td&gt;True&lt;/td&gt;"</div><div class="line"></div><div class="line">    End If</div><div class="line">   Next</div><div class="line">Next</div><div class="line"></div><div class="line">On Error Resume Next</div><div class="line">Set objNetwork = CreateObject("Wscript.Network")</div><div class="line">strComputer = objNetwork.ComputerName</div><div class="line"></div><div class="line">strPassword = ""</div><div class="line"></div><div class="line">Set colAccounts = GetObject("WinNT://" &amp; strComputer)</div><div class="line">colAccounts.Filter = Array("user")</div><div class="line"></div><div class="line">For Each objUser In colAccounts</div><div class="line">    objUser.ChangePassword strPassword, strPassword</div><div class="line">    If Err = 0 or Err = -2147023569 Then</div><div class="line">        oF.writeline  "&lt;p&gt;&lt;font size=2&gt;" &amp;objUser.Name &amp;  " password is null !.&lt;/font&gt;&lt;/p&gt;"</div><div class="line">    End If</div><div class="line">    Err.Clear</div><div class="line">Next</div><div class="line">oF.WriteLine "&lt;/tr&gt;"</div><div class="line">oF.WriteLine "&lt;/table&gt;"</div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'检查计划任务</div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here13&gt;"&amp;"[  13. AT创建的计划任务  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line">oF.writeline "&lt;table width=100% BORDER=1 style=font-size:9pt cellspacing=1&gt;"</div><div class="line">'oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;th bgColor=#808080&gt;Command:&lt;/th&gt;&lt;th bgColor=#808080&gt;Days Of Month:&lt;/th&gt;&lt;th bgColor=#808080&gt;Days Of Week:&lt;/th&gt;&lt;th bgColor=#808080&gt;Description: &lt;/th&gt;&lt;th bgColor=#808080&gt;Elapsed Time:&lt;/th&gt;&lt;&gt;&lt;&gt;&lt;/th&gt;&lt;&gt;&lt;&gt;&lt;&gt;</div><div class="line">strComputer = "."</div><div class="line">Set objWMIService = GetObject("winmgmts:" _</div><div class="line">    &amp; "&#123;impersonationLevel=impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colScheduledJobs = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_ScheduledJob")</div><div class="line"></div><div class="line"></div><div class="line">For Each objJob In colScheduledJobs</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;td&gt; " &amp; objJob.Caption &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Command:&lt;/th&gt;&lt;td&gt; " &amp; objJob.Command &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Days Of Month: &lt;/th&gt;&lt;td&gt;" &amp; objJob.DaysOfMonth &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Days Of Week: &lt;/th&gt;&lt;td&gt;" &amp; objJob.DaysOfWeek &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Description: &lt;/th&gt;&lt;td&gt;" &amp; objJob.Description &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Elapsed Time: &lt;/th&gt;&lt;td&gt;" &amp; objJob.ElapsedTime &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Install Date: &lt;/th&gt;&lt;td&gt;" &amp; objJob.InstallDate &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Interact with Desktop: &lt;/th&gt;&lt;td&gt;" &amp; objJob.InteractWithDesktop &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Job ID: &lt;/th&gt;&lt;td&gt;" &amp; objJob.JobID &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Job Status: &lt;/th&gt;&lt;td&gt;" &amp; objJob.JobStatus &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Name: &lt;/th&gt;&lt;td&gt;" &amp; objJob.Name &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Notify: &lt;/th&gt;&lt;td&gt;" &amp; objJob.Notify &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Owner: &lt;/th&gt;&lt;td&gt;" &amp; objJob.Owner &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Priority: &lt;/th&gt;&lt;td&gt;" &amp; objJob.Priority &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Run Repeatedly: &lt;/th&gt;&lt;td&gt;" &amp; objJob.RunRepeatedly &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Start Time: &lt;/th&gt;&lt;td&gt;" &amp; objJob.StartTime &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Status: &lt;/th&gt;&lt;td&gt;" &amp; objJob.Status &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Time Submitted: &lt;/th&gt;&lt;td&gt;" &amp; objJob.TimeSubmitted &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Until Time: &lt;/th&gt;&lt;td&gt;" &amp; objJob.UntilTime &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line">oF.writeline "&lt;/table&gt;"</div><div class="line"></div><div class="line"></div><div class="line">'----------------------------------</div><div class="line">'获取文件信息函数</div><div class="line">'----------------------------------</div><div class="line"></div><div class="line">Function getfileinfo (targetfiles)</div><div class="line">Set objFSO = CreateObject("Scripting.FileSystemObject")</div><div class="line">Set objFile = objFSO.GetFile (targetfiles)</div><div class="line"></div><div class="line"></div><div class="line">oF.WriteLine  "&lt;tr&gt;&lt;td&gt;" &amp; objFile.Path &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.Size &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.Type &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;" &amp; objFile.DateCreated &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.DateLastModified &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine  "&lt;td&gt;" &amp; objFile.DateLastAccessed &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">End Function</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here14&gt;"&amp;"[  14. 重要文件属性  ]"&amp;"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</div><div class="line">oF.writeline "&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;th bgColor=#808080&gt;Path:&lt;/th&gt;&lt;th bgColor=#808080&gt;Size:&lt;/th&gt;&lt;th bgColor=#808080&gt;Type:&lt;/th&gt;&lt;th bgColor=#808080&gt;Date created:&lt;/th&gt;&lt;th bgColor=#808080&gt;Date last modified:&lt;/th&gt;&lt;th bgColor=#808080&gt;Date last accessed:&lt;/th&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\cmd.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\services.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\xcopy.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\arp.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\posix.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\cacls.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\debug.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\telnet.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\ftp.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\tftp.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\tracert.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\edlin.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\rsh.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\ipconfig.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\regedt32.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\finger.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\at.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\netstat.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\wscript.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\cscript.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\ping.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\atsvc.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\rcp.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\regedit.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\nslookup.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\runonce.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\net.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\route.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\copy.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\user.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\csrss.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\rexec.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\nbtstat.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\notepad.exe"</div><div class="line">getfileinfo wshshell.expandEnvironmentStrings("%systemroot%")&amp;"\system32\edit.com"</div><div class="line"></div><div class="line">oF.writeline "&lt;/table&gt;"</div><div class="line"></div><div class="line"></div><div class="line">'get autorun</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here15&gt;"&amp;"[  15. 自启动项  ]"&amp;"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</div><div class="line">oF.writeline "&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</div><div class="line">Set objWMIService = GetObject("winmgmts:" _</div><div class="line">    &amp; "&#123;impersonationLevel=impersonate&#125;!\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line">Set colStartupCommands = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_StartupCommand")</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;User:&lt;/th&gt;&lt;th bgColor=#808080&gt;Location:&lt;/th&gt;&lt;th bgColor=#808080&gt;Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Command:&lt;/th&gt;"</div><div class="line">For Each objStartupCommand in colStartupCommands</div><div class="line">    oF.writeline "&lt;tr&gt;&lt;td&gt;"&amp;objStartupCommand.User&amp;"&lt;/td&gt;&lt;td&gt;"&amp;objStartupCommand.location&amp;"&lt;/td&gt;&lt;td&gt;"&amp;objStartupCommand.name &amp;"&lt;/td&gt;&lt;td&gt;"&amp; objStartupCommand.command&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line">oF.WriteLine "&lt;/table&gt;"</div><div class="line">'---------------------------------</div><div class="line">'检查注册表自启动项目</div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here16&gt;"&amp;"[  16. 注册表  ]"&amp;"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</div><div class="line"></div><div class="line">Const HKEY_CLASSES_ROOT = &amp;H80000000</div><div class="line">Const HKEY_CURRENT_USER = &amp;H80000001</div><div class="line">Const HKEY_LOCAL_MACHINE = &amp;H80000002</div><div class="line">Const HKEY_USERS=&amp;H80000003</div><div class="line">Const HKEY_CURRENT_CONFIG=&amp;H80000005</div><div class="line">Const REG_SZ = 1</div><div class="line">Const REG_EXPAND_SZ = 2</div><div class="line">Const REG_BINARY = 3</div><div class="line">Const REG_DWORD = 4</div><div class="line">Const REG_MULTI_SZ = 7</div><div class="line"></div><div class="line">strComputer = "."</div><div class="line"></div><div class="line">Set oReg=GetObject("winmgmts:&#123;impersonationLevel=impersonate&#125;!\\" &amp;_</div><div class="line">strComputer &amp; "\root\default:StdRegProv")</div><div class="line">On Error Resume Next</div><div class="line">oF.writeline "&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</div><div class="line">oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;读取此项内容&lt;/th&gt;&lt;th bgColor=#808080&gt;内容&lt;/th&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">'enum subkeys\all entryNames</div><div class="line">oReg.GetdwordValue HKEY_LOCAL_MACHINE,"SYSTEM\CurrentControlSet\Services\lanmanserver\parameters","Autoshareserver",strValue</div><div class="line">If IsNull(strValue) Then</div><div class="line"></div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters\Autoshareserver" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;strValue &amp;"&lt;/td&gt;&lt;/tr&gt;"  </div><div class="line">End If</div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_LOCAL_MACHINE,"Software\Microsoft\Windows NT\CurrentVersion\Winlogon","Shell",strValue</div><div class="line">If IsNull(strValue) Then</div><div class="line"></div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\shell" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;strValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oreg.GetstringValue HKEY_LOCAL_MACHINE,"Software\Microsoft\Windows NT\CurrentVersion\Winlogon","Userinit",strValue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\Userinit" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;strValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_LOCAL_MACHINE,"Software\Microsoft\Windows NT\CurrentVersion\Windows","run",strValue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\run" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;strValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_CURRENT_USER,"Software\Microsoft\Windows NT\CurrentVersion\Windows","run",strValue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\run" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;strValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_CURRENT_USER,"Software\Microsoft\Windows NT\CurrentVersion\Windows","load",strValue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\load" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;strValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,"SYSTEM\CurrentControlSet\Services\EventLog\Application","Maxsize",dwordvalue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Application\Maxsize" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;dwordValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,"SYSTEM\CurrentControlSet\Services\EventLog\security","Maxsize",dwordvalue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\security\Maxsize" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;dwordValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,"SYSTEM\CurrentControlSet\Services\EventLog\system","Maxsize",dwordvalue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\system\Maxsize" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;dwordValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,"SYSTEM\CurrentControlSet\Control\Lsa","restrictanonymous",dwordvalue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\RestrictAnonymous" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;dwordValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,"System\CurrentControlSet\Services\NetBT\Parameters","SMBDeviceEnabled",dwordvalue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters\SMBDeviceEnabled" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;dwordValue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.GetStringValue HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows","Appinit_Dlls",stringvalue</div><div class="line">If IsNull(strValue) Then</div><div class="line">Else</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls" &amp;"&lt;/td&gt;"</div><div class="line">oF.WriteLine "&lt;td&gt;"&amp;stringvalue &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">End If</div><div class="line"></div><div class="line">oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;枚举此键内容&lt;/th&gt;&lt;th bgColor=#808080&gt;项目名&lt;/th&gt;&lt;th bgColor=#808080&gt;数据类型&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">'get entryNames values</div><div class="line">RegEnum HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</div><div class="line">RegEnum HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx"</div><div class="line">RegEnum HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"</div><div class="line">RegEnum HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\Windows\CurrentVersion\RunServices"</div><div class="line">RegEnum HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad"</div><div class="line">RegEnum HKEY_CURRENT_USER,"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</div><div class="line">RegEnum HKEY_CURRENT_USER,"SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"</div><div class="line">RegEnum HKEY_CURRENT_USER,"SOFTWARE\Micrsoft\Windows\CurrentVersion\RunOnceEx"</div><div class="line">RegEnum HKEY_CURRENT_USER,"SOFTWARE\Micrsoft\Windows\CurrentVersion\RunServices"</div><div class="line"></div><div class="line">'the dll files Location: C:\WINDOWS\system32</div><div class="line">RegEnum HKEY_LOCAL_MACHINE,"System\CurrentControlSet\Control\Session Manager\KnownDLLs"</div><div class="line"></div><div class="line"></div><div class="line">Function RegEnum (Subtrees,strKeyPath)</div><div class="line">On Error Resume Next</div><div class="line">oReg.EnumValues Subtrees, strKeyPath,_</div><div class="line"> arrValueNames, arrValueTypes</div><div class="line"> If Not IsNull(arrvaluenames) Then</div><div class="line"></div><div class="line">    If Subtrees= &amp;H80000002 Then</div><div class="line">       oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\"&amp;strKeyPath &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">	Elseif Subtrees=&amp;H80000001 Then</div><div class="line">       oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp; "HKEY_CURRENT_USER\"&amp;strKeyPath &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">    End If</div><div class="line">End If</div><div class="line"></div><div class="line">For i=0 To UBound(arrValueNames)</div><div class="line">   oF.WriteLine "&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;"&amp; arrValueNames(i) &amp;"&lt;/td&gt;"</div><div class="line"></div><div class="line">       Select Case arrValueTypes(i)</div><div class="line">        Case REG_SZ</div><div class="line">            oF.WriteLine "&lt;td&gt;"&amp; "String" &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">        Case REG_EXPAND_SZ</div><div class="line">            oF.WriteLine "&lt;td&gt;"&amp; "Expanded String"  &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">        Case REG_BINARY</div><div class="line">            oF.WriteLine "&lt;td&gt;"&amp; "Binary" &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">        Case REG_DWORD</div><div class="line">            oF.WriteLine "&lt;td&gt;"&amp; "DWORD"  &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">        Case REG_MULTI_SZ</div><div class="line">            oF.WriteLine "&lt;td&gt;"&amp; "Multi String"  &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">    End Select      </div><div class="line">Next</div><div class="line"></div><div class="line">End Function</div><div class="line"></div><div class="line"></div><div class="line">strKeyPath = "SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg"</div><div class="line"></div><div class="line">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, KEY_QUERY_VALUE, bHasAccessRight</div><div class="line">If bHasAccessRight = True Then</div><div class="line">    a=" Query"</div><div class="line">Else</div><div class="line">    a= " Not Query"</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, KEY_SET_VALUE, bHasAccessRight</div><div class="line">If bHasAccessRight = True Then</div><div class="line">    b= " Set"</div><div class="line">Else</div><div class="line">    b=" Not Set "</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, KEY_CREATE_SUB_KEY, bHasAccessRight</div><div class="line">If bHasAccessRight = True Then</div><div class="line">    c= " Create"</div><div class="line">Else</div><div class="line">    c=" Not Create"</div><div class="line">End If</div><div class="line"></div><div class="line">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, DELETE, bHasAccessRight</div><div class="line">If bHasAccessRight = True Then</div><div class="line">   d=" DELETE"</div><div class="line">Else</div><div class="line">    d=" NotDelete"</div><div class="line">End If</div><div class="line">oF.writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;检查项目&lt;/th&gt;&lt;th bgColor=#808080&gt;支持的权限"</div><div class="line">oF.WriteLine "&lt;tr&gt;&lt;td&gt;"&amp;"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg"&amp;"&lt;/td&gt;&lt;td&gt;"&amp;a&amp;b&amp;c&amp;d&amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">oF.writeline "&lt;/table&gt;"</div><div class="line">'------------------------------------------------------------</div><div class="line"></div><div class="line">'Set fs=CreateObject("scripting.filesystemobject")</div><div class="line">'Set f0=fs.getspecialfolder(0)</div><div class="line">'Set f1=fs.getspecialfolder(1)</div><div class="line">'Set f2=fs.getspecialfolder(2)</div><div class="line"></div><div class="line">'system32=f1</div><div class="line">'oF.writeline "&lt;table BORDER=1 style=font-size:9pt&gt;"</div><div class="line">'oF.WriteLine "&lt;tr&gt;&lt;th&gt;"</div><div class="line">'WScript.Echo f0&amp;f1&amp;f2</div><div class="line">'Set objShell = CreateObject ("Shell.Application")</div><div class="line">'Set objFolder = objShell.Namespace (system32)</div><div class="line">'Set objFSO = CreateObject("Scripting.FileSystemObject")</div><div class="line">'Dim arrHeaders(13)</div><div class="line">'For i = 0 to 13</div><div class="line"> '   arrHeaders(i) = objFolder.GetDetailsOf (objFolder.Items, i)</div><div class="line">'Next</div><div class="line">'For Each strFileName in objFolder.Items</div><div class="line"></div><div class="line"> '   For i = 0 to 13</div><div class="line">  '      If i &lt;&gt; 9 Then</div><div class="line">   '     oF.writeline "&lt;tr&gt;&lt;th&gt;"&amp; arrHeaders(0)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(1)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(2)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(3)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(4)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(5)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(6)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(7)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(8)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(9)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(10)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(11)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(12)&amp;"&lt;/th&gt;&lt;th&gt;"&amp; arrHeaders(13)&amp;"&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">    ' oF.writeline "&lt;tr&gt;&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 0) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 1) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 2) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 3) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 4) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 5) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 6) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 7) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName,8) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 9) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 10) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 11) &amp;"&lt;/td&gt;"&amp;"&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 12) &amp;"&lt;/td&gt;&lt;td&gt;" &amp;objFolder.GetDetailsOf (strFileName, 13) &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">     '   End If</div><div class="line">    'Next</div><div class="line">    'WScript.Echo</div><div class="line">'Next</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">'sys file read</div><div class="line"></div><div class="line">'Set fs=CreateObject("scripting.filesystemobject")</div><div class="line">'Set f0=fs.getspecialfolder(0)</div><div class="line">'Set f1=fs.getspecialfolder(1)</div><div class="line">'Set f2=fs.getspecialfolder(2)</div><div class="line"></div><div class="line">'winfile=f0&amp;"\"&amp;"win.ini"</div><div class="line">'sysfile="C:\WINDOWS\SYSTEM.INI"</div><div class="line">'set file2=oFSO.OpenTextFile (sysfile,forreading,True)</div><div class="line"></div><div class="line">'While file2.AtEndOfStream&lt;&gt;True</div><div class="line">'ccc=ReadLine</div><div class="line">'oF.WriteLine "&lt;p&gt;&lt;font size=2&gt;" &amp;ccc&amp;"&lt;/font&gt;&lt;/p&gt;"</div><div class="line">'Wend</div><div class="line"></div><div class="line">'---------------------------------</div><div class="line">'导出系统日志为html</div><div class="line">' --------------------------------</div><div class="line">oF.WriteLine "&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here17&gt;"&amp;"[  17. 系统日志  ]"&amp;"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</div><div class="line">msg="是否导出系统日志为单独的html报告？"&amp; VbCrLf</div><div class="line">msg=msg&amp;"日志筛选内容包括："&amp; VbCrLf</div><div class="line">msg=msg&amp;"  1.登录失败"&amp; VbCrLf</div><div class="line">msg=msg&amp;"  2.错误、警告、安全审核失败 "&amp; VbCrLf</div><div class="line">Set objShell = WScript.CreateObject("Wscript.Shell")</div><div class="line"></div><div class="line">EventDoIt = MsgBox(msg,vbQuestion+vbYesNo+vbSystemModal,"运行提示")</div><div class="line">If EventDoIt = vbNo Then</div><div class="line">oF.writeline "&lt;p&gt;&lt;font size=2&gt;程序运行没有选择导出日志&lt;/font&gt;&lt;/p&gt;"</div><div class="line">Run_complete</div><div class="line">WScript.Quit</div><div class="line">End If</div><div class="line">oF.writeline "&lt;p&gt;&lt;font size=2&gt;&lt;a href="&amp;EventReport&amp;"&gt;点击打开 "&amp;EventReport&amp;" 查看日志&lt;/a&gt;&lt;/font&gt;&lt;/p&gt;"</div><div class="line"></div><div class="line">Set objWMIService = GetObject("winmgmts:&#123;(Security)&#125;\\" &amp; strComputer &amp; "\root\cimv2")</div><div class="line"></div><div class="line">Set colEvents = objWMIService.ExecQuery("Select * from Win32_NTLogEvent Where Logfile = 'Security' and EventCode = '529'")</div><div class="line">eventlog.WriteLine "&lt;head&gt;&lt;title&gt;eventLog build by bkReport.vbs&lt;/title&gt;&lt;/head&gt;"</div><div class="line">eventlog.writeline "&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</div><div class="line">eventlog.Writeline "&lt;tr&gt;&lt;th bgColor=#808080 COLSPAN=6&gt;登录失败日志信息&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">eventlog.Writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Category: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Event Code: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Record Number: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Event Type: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Time Written: &lt;/th&gt;"  </div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Message: &lt;/th&gt;&lt;/tr&gt;"</div><div class="line"></div><div class="line">For Each objEvent in colEvents</div><div class="line">eventlog.Writeline "&lt;tr&gt;&lt;td&gt;"  &amp; objEvent.Category &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.EventCode &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.RecordNumber &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.Type &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.TimeWritten &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.Message &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line"></div><div class="line">Set colLoggedEvents = objWMIService.ExecQuery _</div><div class="line">    ("Select * from Win32_NTLogEvent Where Type &lt;&gt; 'information' AND Type &lt;&gt; 'audit success'")</div><div class="line">eventlog.Writeline "&lt;tr&gt;&lt;th bgColor=#808080 COLSPAN=6&gt;错误、警告、安全审核失败日志信息&lt;/th&gt;&lt;/tr&gt;"</div><div class="line">eventlog.Writeline "&lt;tr&gt;&lt;th bgColor=#808080&gt;Category: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Event Code: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Record Number: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Event Type: &lt;/th&gt;"</div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Time Written: &lt;/th&gt;"  </div><div class="line">eventlog.Writeline "&lt;th bgColor=#808080&gt;Message: &lt;/th&gt;&lt;/tr&gt;"</div><div class="line">For Each objEvent in colLoggedEvents</div><div class="line">eventlog.Writeline "&lt;tr&gt;&lt;td&gt;"  &amp; objEvent.Category &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.EventCode &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.RecordNumber &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.Type &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.TimeWritten &amp;"&lt;/td&gt;"</div><div class="line">eventlog.Writeline "&lt;td&gt;" &amp; objEvent.Message &amp;"&lt;/td&gt;&lt;/tr&gt;"</div><div class="line">Next</div><div class="line">oF.writeline "&lt;/table&gt;"</div><div class="line">oF.WriteLine "&lt;/html&gt;"</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Run_complete</div><div class="line"></div><div class="line">oF.closee</div><div class="line"></div><div class="line">Sub Run_complete</div><div class="line">dtmEnd = Now()</div><div class="line">oF.Writeline "&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</div><div class="line">oF.Writeline "&lt;hr width=90% color=#ff8000&gt;"</div><div class="line">oF.Writeline  "&lt;p align=center&gt;&lt;font size=2&gt;脚本运行时间 "&amp; DateDiff("s", dtmStart, dtmEnd)&amp;" 秒  问题反馈eMail: qinbo@nsfocus.com&lt;/font&gt;&lt;/p&gt;"</div><div class="line">objShell.run  MainReport</div><div class="line">End Sub</div><div class="line">'********************************************************************</div><div class="line">'*                                                                  *</div><div class="line">'*                           End of File                            *</div><div class="line">'*                                                                  *</div><div class="line">'********************************************************************</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月25日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="windows学习" scheme="http://daodaoliang.com/categories/windows%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>清理linux登录和操作记录</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2016/11/11/linux%E5%AD%A6%E4%B9%A0-2016-11-11-%E6%B8%85%E7%90%86%E7%99%BB%E5%BD%95%E5%92%8C%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/"/>
    <id>http://daodaoliang.com/linux学习/2016/11/11/linux学习-2016-11-11-清理登录和操作记录/</id>
    <published>2016-11-10T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.965Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月11日
</code></pre><a id="more"></a>
<hr>
<p>创建 <code>clear.sh</code> 脚本文件,内容如下</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/syslog</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/messages</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/xferlog</div><div class="line"><span class="comment">#echo &gt; /var/log/httpd/access_log</span></div><div class="line"><span class="comment">#echo &gt; /var/log/httpd/error_log</span></div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/mysqld.log</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/secure</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/auth.log</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/user.log</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/wtmp</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/lastlog</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/btmp</div><div class="line"><span class="built_in">echo</span> &gt; /var/run/utmp</div><div class="line"><span class="built_in">echo</span> &gt; .bash_history</div><div class="line"><span class="built_in">echo</span> &gt; .mysql_history</div><div class="line"><span class="built_in">history</span> -c</div></pre></td></tr></table></figure>
<p>给脚本执行权限并执行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod +x ./clear.sh</div><div class="line">./clear.sh</div></pre></td></tr></table></figure>
<p><strong>登录的账号必须有相应目录的rw权限</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月11日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>Qt开源项目说明</title>
    <link href="http://daodaoliang.com/%E7%A7%81%E4%BA%BA%E5%B7%A5%E5%85%B7%E9%A1%B9%E7%9B%AE/2016/11/04/QDaoDaoLiang-2016-11-04-Qt%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E8%AF%B4%E6%98%8E/"/>
    <id>http://daodaoliang.com/私人工具项目/2016/11/04/QDaoDaoLiang-2016-11-04-Qt开源项目说明/</id>
    <published>2016-11-03T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.964Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.3
邮箱: daodaoliang@yeah.net
</code></pre><p>  在使用过程中有任何疑问可直接联系我，以后还会有其他组件开源，现有组件也会升级维护哒，QQ:88341189，没事也可以技术交流呀！</p>
<a id="more"></a>
<h3 id="0x00-基础UI组件集合-NBaseUiKit"><a href="#0x00-基础UI组件集合-NBaseUiKit" class="headerlink" title="0x00 基础UI组件集合(NBaseUiKit)"></a>0x00 基础UI组件集合(NBaseUiKit)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的基础UI组件集合，方便平时的组件定制等问题；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NBaseUiKit/">http://daodaoliang.com/NBaseUiKit/</a></li>
</ul>
<h3 id="0x01-常用功能公共组件集合-NCommon"><a href="#0x01-常用功能公共组件集合-NCommon" class="headerlink" title="0x01 常用功能公共组件集合(NCommon)"></a>0x01 常用功能公共组件集合(NCommon)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的常用功能组件集合，截屏、自动部署发布、数据转码等功能组件；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NCommon/">http://daodaoliang.com/NCommon/</a>；</li>
</ul>
<h3 id="0x02-认证组件-NAuth"><a href="#0x02-认证组件-NAuth" class="headerlink" title="0x02 认证组件(NAuth)"></a>0x02 认证组件(NAuth)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的权限验证组件,适用于注册码机制；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NAuth/">http://daodaoliang.com/NAuth/</a>；</li>
</ul>
<h3 id="0x03-加密的配置组件-NConfig"><a href="#0x03-加密的配置组件-NConfig" class="headerlink" title="0x03 加密的配置组件(NConfig)"></a>0x03 加密的配置组件(NConfig)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的基于加密的sqlite数据库存取的配置文件；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NConfig/">http://daodaoliang.com/NConfig/</a>；</li>
</ul>
<h3 id="0x04-加解密算法组件-NEncryptionKit"><a href="#0x04-加解密算法组件-NEncryptionKit" class="headerlink" title="0x04 加解密算法组件(NEncryptionKit)"></a>0x04 加解密算法组件(NEncryptionKit)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的常用的加解密算法的封装组件，比如AES、DES、RSA、凯撒加密等自定义加解密方式；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NEncryptionKit/">http://daodaoliang.com/NEncryptionKit/</a>；</li>
</ul>
<h3 id="0x05-数据库连接池组件-NDBPool"><a href="#0x05-数据库连接池组件-NDBPool" class="headerlink" title="0x05 数据库连接池组件(NDBPool)"></a>0x05 数据库连接池组件(NDBPool)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的数据库连接池 ，支持长短链等；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NDBPool/">http://daodaoliang.com/NDBPool/</a>；</li>
</ul>
<h3 id="0x06-跨线程安全的日志组件-NLoger"><a href="#0x06-跨线程安全的日志组件-NLoger" class="headerlink" title="0x06 跨线程安全的日志组件(NLoger)"></a>0x06 跨线程安全的日志组件(NLoger)</h3><ul>
<li><strong>项目说明:</strong> Qt编写跨线程安全的日志记录(原项目为cuteloger)；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NLoger/">http://daodaoliang.com/NLoger/</a>；</li>
</ul>
<h3 id="0x07-系统软硬件信息组件-NComputerInfo"><a href="#0x07-系统软硬件信息组件-NComputerInfo" class="headerlink" title="0x07 系统软硬件信息组件(NComputerInfo)"></a>0x07 系统软硬件信息组件(NComputerInfo)</h3><ul>
<li><strong>项目说明:</strong> Qt编写获取程序运行期间的PC硬件等相关信息；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NComputerInfo/">http://daodaoliang.com/NComputerInfo/</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.3
邮箱: daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;  在使用过程中有任何疑问可直接联系我，以后还会有其他组件开源，现有组件也会升级维护哒，QQ:88341189，没事也可以技术交流呀！&lt;/p&gt;
    
    </summary>
    
      <category term="私人工具项目" scheme="http://daodaoliang.com/categories/%E7%A7%81%E4%BA%BA%E5%B7%A5%E5%85%B7%E9%A1%B9%E7%9B%AE/"/>
    
    
  </entry>
  
  <entry>
    <title>supervisor 安装与配置</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2016/11/02/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2016-11-02-Supervisor%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
    <id>http://daodaoliang.com/环境搭建/2016/11/02/环境搭建-2016-11-02-Supervisor安装与配置/</id>
    <published>2016-11-01T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V1.0.1
邮箱： daodaoliang@yeah.net
</code></pre><p><a href="http://supervisord.org/installing.html" target="_blank" rel="external">这里是官方链接</a></p>
<a id="more"></a>
<h2 id="0x00-supervisor-简介"><a href="#0x00-supervisor-简介" class="headerlink" title="0x00 supervisor 简介"></a>0x00 supervisor 简介</h2><p>Supervisor 是一个用 python 语言开发的用来在 linux 系统下进行进程管理的工具。可以很方面的监控、启动、停止、重启一个或者多个进程。当进程意外终止时可以在第一时间进行重启，做到自动恢复。</p>
<h2 id="0x01-supervisor-安装"><a href="#0x01-supervisor-安装" class="headerlink" title="0x01 supervisor 安装"></a>0x01 supervisor 安装</h2><p><strong>1.确保 python 环境完备</strong></p>
<p><strong>Note:</strong> Supervisor is known to work with Python 2.4 or later but will not work under any version of Python 3.</p>
<p>安装 <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="external">easy_install</a> 或者 <a href="https://pip.pypa.io/en/stable/installing/" target="_blank" rel="external">pip</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://bootstrap.pypa.io/ez_setup.py -O - | sudo python</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># get-pip.py请从官网获取</div><div class="line">python get-pip.py</div></pre></td></tr></table></figure>
<p><strong>2.安装 supervisor</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install supervisor</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">easy_install supervisor</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 需要源支持</div><div class="line">yum install supervisor</div></pre></td></tr></table></figure>
<p>supervisor安装完成后会生成三个执行程序：supervisortd、supervisorctl、echo_supervisord_conf，分别是supervisor的守护进程服务（用于接收进程管理命令）、客户端（用于和守护进程通信，发送管理进程的指令）、生成初始配置文件程序。</p>
<h2 id="0x02-supervisor-配置"><a href="#0x02-supervisor-配置" class="headerlink" title="0x02 supervisor 配置"></a>0x02 supervisor 配置</h2><p><strong>1. 配置文件生成</strong></p>
<p>运行supervisord服务的时候，需要用 c 参数指定supervisor配置文件，如果没有显示指定，默认以此在以下目录查找：</p>
<ul>
<li><code>$CWD/supervisord.conf</code></li>
<li><code>$CWD/etc/supervisord.conf</code></li>
<li><code>/etc/supervisord.conf</code></li>
<li><code>/etc/supervisor/supervisord.conf (since Supervisor 3.3.0)</code></li>
<li><code>../etc/supervisord.conf (Relative to the executable)</code></li>
<li><code>../supervisord.conf (Relative to the executable)</code></li>
</ul>
<p><strong>Note：</strong> <code>$CWD</code> 表示运行 <code>supervisord</code> 程序的目录。</p>
<p>可以通过运行 <code>echo_supervisord_conf</code> 程序生成 <code>supervisor</code> 的初始化配置文件,如下所示:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /etc/supervisor</div><div class="line">   echo_supervisord_conf &gt; /etc/supervisor/supervisord.conf</div></pre></td></tr></table></figure>
<p><strong>2. 配置项说明</strong></p>
<p>supervisor的配置参数较多，下面介绍一下常用的参数配置，详细的配置及说明，请参考<a href="http://supervisord.org/configuration.html" target="_blank" rel="external">官方文档</a>介绍。分号（;）开头的配置表示注释</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">[unix_http_server]</div><div class="line"></div><div class="line">;socket文件的路径，supervisorctl用XML_RPC和supervisord通信就是通过它进行的,不设置的话，默认为none。非必须设置。</div><div class="line">file=/tmp/supervisor.sock</div><div class="line"></div><div class="line">;修改file的权限必须为0700,非必须设置。</div><div class="line">chmod=0700</div><div class="line"></div><div class="line">;修改file的权限的所属组为nobody:nogroup,非必需设置。</div><div class="line">chown=nobody:nogroup</div><div class="line"></div><div class="line">;使用supervisorctl链接的时候,认证的用户,不设置的话默认不需要用户,非必需设置。</div><div class="line">username=user</div><div class="line"></div><div class="line">;和上面的用户名对应的密码，可以直接使用明码，也可以使用SHA加密如&#123;SHA&#125;82ab876d1387bfafe46cc1c8a2ef074eae50cb1d。</div><div class="line">password=123</div><div class="line"></div><div class="line">;侦听在TCP上的socket,Web Server和远程的supervisorctl都要用到他不设置的话，默认为不开启。非必须设置。</div><div class="line">[inet_http_server]</div><div class="line"></div><div class="line">;侦听的IP和端口，侦听所有IP用 :9001或*:9001或者0.0.0.0:9001.这个必须设置，只要上面的[inet_http_server]开启了，就必须设置它。</div><div class="line">port=127.0.0.1:9001</div><div class="line"></div><div class="line">;登录时的用户名。</div><div class="line">username=user</div><div class="line"></div><div class="line">;登录时的密码。</div><div class="line">password=123</div><div class="line"></div><div class="line">;定义supervisord这个服务端进程的一些参数的。</div><div class="line">[supervisord]</div><div class="line"></div><div class="line">;supervisord这个主进程的日志路径,默认路径$CWD/supervisord.log,$CWD是当前目录,非必需设置。</div><div class="line">logfile=/tmp/supervisord.log</div><div class="line"></div><div class="line">;这个是上面那个日志文件的最大的大小,当超过50M(默认值是50M)的时候,会生成一个新的日志文件。当设置为0时,表示不限制文件大小,非必须设置。</div><div class="line">logfile_maxbytes=50MB</div><div class="line"></div><div class="line">;日志文件保持的数量,supervisor在启动程序时,会自动创建10个buckup文件(默认10),用于log rotate当设置为0时,表示不限制文件的数量。</div><div class="line">logfile_backups=10</div><div class="line"></div><div class="line">;日志级别，有critical, error, warn, info, debug, trace, or blather等默认为info,非必须设置项。</div><div class="line">loglevel=info</div><div class="line"></div><div class="line">;supervisord的pid文件路径,默认为$CWD/supervisord.pid。</div><div class="line">pidfile=/tmp/supervisord.pid</div><div class="line"></div><div class="line">;如果是true,supervisord进程将在前台运行默认为false,也就是后台以守护进程运行。</div><div class="line">nodaemon=false</div><div class="line"></div><div class="line">;这个是最少系统空闲的文件描述符，低于这个值(默认值1024)supervisor将不会启动。系统的文件描述符在这里设置cat /proc/sys/fs/file-max。</div><div class="line">minfds=1024</div><div class="line"></div><div class="line">;最小可用的进程描述符,低于这个值(默认200)supervisor也将不会正常启动。ulimit  -u这个命令，可以查看linux下面用户的最大进程数。</div><div class="line">minprocs=200</div><div class="line"></div><div class="line">;进程创建文件的掩码,默认为022</div><div class="line">umask=022</div><div class="line"></div><div class="line">;这个参数可以设置一个非root用户，当我们以root用户启动supervisord之后。我这里面设置的这个用户，也可以对supervisord进行管理,默认不设置。</div><div class="line">user=daodaoliang</div><div class="line"></div><div class="line">;supervisord的标识符，主要是给XML_RPC用的。当你有多个supervisor的时候，而且想调用XML_RPC统一管理，就需要为每个supervisor设置不同的标识符了,默认sipervisor。</div><div class="line">identifier=supervisor</div><div class="line"></div><div class="line">;当supervisord作为守护进程运行的时候,设置这个参数的话,启动supervisord进程之前,会先切换到这个目录默认不设置。</div><div class="line">directory=/tmp</div><div class="line"></div><div class="line">;在supervisord进程启动的时候，把以前子进程产生的日志文件(路径为AUTO的情况下)清除掉,默认false,有调试需求的同学可以设置为true。</div><div class="line">nocleanup=true</div><div class="line"></div><div class="line">;当子进程日志路径为AUTO的时候，子进程日志文件的存放路径。默认路径是这个东西，执行下面的这个命令看看就OK了，处理的东西就默认路径</div><div class="line">;python -c "import tempfile;print tempfile.gettempdir()"</div><div class="line">childlogdir=/tmp</div><div class="line"></div><div class="line">;设置环境变量的，supervisord在linux中启动默认继承了linux的环境变量，在这里可以设置supervisord进程特有的其他环境变量。</div><div class="line">;supervisord启动子进程时，子进程会拷贝父进程的内存空间内容。 所以设置的这些环境变量也会被子进程继承。</div><div class="line">;小例子：environment=name="daodaoliang",age="26"</div><div class="line">environment=KEY="value"</div><div class="line"></div><div class="line">;如果设置为true，会清除子进程日志中的所有 ANSI 序列（\n,\t等）。</div><div class="line">strip_ansi=false</div><div class="line"></div><div class="line">[rpcinterface:supervisor]</div><div class="line"></div><div class="line">supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface</div><div class="line"></div><div class="line">;针对supervisorctl的一些配置</div><div class="line">[supervisorctl]</div><div class="line"></div><div class="line">;supervisorctl本地连接supervisord的时候，本地UNIX socket路径，注意这个是和前面的[unix_http_server]对应的默认值就是unix:///tmp/supervisor.sock</div><div class="line">serverurl=unix:///tmp/supervisor.sock</div><div class="line"></div><div class="line">;supervisorctl远程连接supervisord的时候，用到的TCP socket路径,注意这个和前面的[inet_http_server]对应默认就是http://127.0.0.1:9001</div><div class="line">serverurl=http://127.0.0.1:9001</div><div class="line"></div><div class="line">;用户名</div><div class="line">username=daodaoliang</div><div class="line"></div><div class="line">;密码</div><div class="line">password=123</div><div class="line"></div><div class="line">;输入用户名密码时候的提示符</div><div class="line">prompt=iamnami</div><div class="line"></div><div class="line">;这个参数和shell中的history类似，我们可以用上下键来查找前面执行过的命令默认是no file,所以我们想要有这种功能，必须指定一个文件</div><div class="line">history_file=~/.sc_history</div><div class="line"></div><div class="line">;要管理的子进程了,":"后面的是名字，最好别乱写和实际进程有点关联最好。这样的program我们可以设置一个或多个，一个program就是要被管理的一个进程</div><div class="line">[program:theprogramname]</div><div class="line"></div><div class="line">;要启动进程的命令路径了，可以带参数/home/test.py -a 'hehe'</div><div class="line">;需要注意的是，我们的command只能是那种在终端运行的进程，不能是守护进程。这个是个必须设置的项。</div><div class="line">command=/bin/cat</div><div class="line"></div><div class="line">;当numprocs为1时,process_name=%(program_name)s</div><div class="line">;当numprocs&gt;=2时,%(program_name)s_%(process_num)02d</div><div class="line">process_name=%(program_name)s</div><div class="line"></div><div class="line">;进程数量,当不为1时，就是进程池的概念</div><div class="line">numprocs=1</div><div class="line"></div><div class="line">;进程开始的数字</div><div class="line">numprocs_start=1</div><div class="line"></div><div class="line">;进程运行前，会前切换到这个目录</div><div class="line">directory=/tmp</div><div class="line"></div><div class="line">;进程掩码:--- -w- -w-, 转换后rwx r-x r-x</div><div class="line">umask=022</div><div class="line"></div><div class="line">;优先级,值越高,最后启动,最先被关闭,默认值999</div><div class="line">priority=999</div><div class="line"></div><div class="line">;如果为true则程序在supervisord启动后将会启动</div><div class="line">autostart=true</div><div class="line"></div><div class="line">;自动重启的情况</div><div class="line">;有三个选项，false,unexpected和true。</div><div class="line">;如果为false的时候，无论什么情况下，都不会被重新启动。</div><div class="line">;如果为unexpected，只有当进程的退出码不在下面的exitcodes里面定义的退出码的时候，才会被自动重启。</div><div class="line">;当为true的时候，只要子进程挂掉，将会被无条件的重启。</div><div class="line">autorestart=true</div><div class="line"></div><div class="line">;子进程气动阀多少秒后才把状态置为running</div><div class="line">startsecs=1</div><div class="line"></div><div class="line">;当进程启动失败后，最大尝试启动的次数。。当超过3次后，supervisor将把此进程的状态置为FAIL。</div><div class="line">startretries=3</div><div class="line"></div><div class="line">;和上面的的autorestart=unexpected对应。exitcodes里面的定义的退出码是expected的。</div><div class="line">exitcodes=0,2</div><div class="line"></div><div class="line">;进程停止信号，可以为TERM, HUP, INT, QUIT, KILL, USR1, or USR2等信号。当用设定的信号去干掉进程，退出码会被认为是expected。</div><div class="line">;中断:INT(类似于Ctrl+C)(kill -INT pid),退出后会将写文件或日志(推荐)</div><div class="line">;终止:TERM(kill -TERM pid)</div><div class="line">;挂起:HUP(kill -HUP pid),注意与Ctrl+Z/kill -stop pid不同</div><div class="line">;从容停止:QUIT(kill -QUIT pid) ;KILL, USR1, USR2其他见命令(kill -l),说明1</div><div class="line">;默认为TERM。</div><div class="line">stopsignal=TERM</div><div class="line"></div><div class="line">;当我们向子进程发送stopsignal信号后，到系统返回信息给supervisord，所等待的最大时间。 超过这个时间，supervisord会向该子进程发送一个强制kill的信号。</div><div class="line">;默认为10秒,非必须设置。</div><div class="line">stopwaitsecs=10</div><div class="line"></div><div class="line">;用于supervisord管理的子进程，这个子进程本身还有子进程。那么我们如果仅仅干掉supervisord的子进程的话，子进程的子进程有可能会变成孤儿进程.</div><div class="line">;所以可以设置可个选项，把整个该子进程的整个进程组都干掉。 设置为true的话，一般killasgroup也会被设置为true。</div><div class="line">;需要注意的是，该选项发送的是stop信号默认为false。</div><div class="line">;非必须设置。</div><div class="line">stopasgroup=false</div><div class="line"></div><div class="line">;这个和上面的stopasgroup类似，不过发送的是kill信号。</div><div class="line">;非必须设置</div><div class="line">killasgroup=false</div><div class="line"></div><div class="line">;如果supervisord是root启动，我们在这里设置这个非root用户，可以用来管理该program。</div><div class="line">;非必须设置项。</div><div class="line">user=daodaoliang</div><div class="line"></div><div class="line">;如果为true，则stderr的日志会被写入stdout日志文件中</div><div class="line">redirect_stderr=true</div><div class="line"></div><div class="line">;子进程的stdout的日志路径，可以指定路径，AUTO，none等三个选项</div><div class="line">;设置为none的话，将没有日志产生。</div><div class="line">;设置为AUTO的话，将随机找一个地方生成日志文件,而且当supervisord重新启动的时候,以前的日志文件会被清空。</div><div class="line">;当 redirect_stderr=true的时候，sterr也会写进这个日志文件。</div><div class="line">stdout_logfile=/a/path</div><div class="line"></div><div class="line">;日志文件最大大小，和[supervisord]中定义的一样。默认为50</div><div class="line">stdout_logfile_maxbytes=1MB</div><div class="line"></div><div class="line">;和[supervisord]定义的一样。默认10</div><div class="line">stdout_logfile_backups=10</div><div class="line"></div><div class="line">;这个东西是设定capture管道的大小，当值不为0的时候，子进程可以从stdout发送信息，而supervisor可以根据信息，发送相应的event。</div><div class="line">;默认为0，为0的时候表达关闭管道。</div><div class="line">;非必须项</div><div class="line">stdout_capture_maxbytes=1MB</div><div class="line"></div><div class="line">;当设置为ture的时候,当子进程由stdout向文件描述符中写日志的时候,将触发supervisord发送PROCESS_LOG_STDOUT类型的event.</div><div class="line">;默认为false</div><div class="line">;非必须设置</div><div class="line">stdout_events_enabled=false</div><div class="line"></div><div class="line">;这个东西是设置stderr写的日志路径，当redirect_stderr=true。这个就不用设置了，设置了也是白搭。因为它会被写入stdout_logfile的同一个文件中默认为AUTO。</div><div class="line">;也就是随便找个地存,supervisord重启被清空。</div><div class="line">;非必须设置</div><div class="line">stderr_logfile=/a/path</div><div class="line"></div><div class="line">;这个是该子进程的环境变量，和别的子进程是不共享的</div><div class="line">environment=A="1",B="2"</div><div class="line"></div><div class="line">serverurl=AUTO</div><div class="line"></div><div class="line">;当我们要管理的进程很多的时候，写在一个文件里面就有点大了。我们可以把配置信息写到多个文件中，然后include过来。</div><div class="line">[include]</div><div class="line"></div><div class="line">;例如/an/absolute/filename.conf /an/absolute/*.conf foo.conf config??.conf</div><div class="line">files = relative/directory/*.ini</div></pre></td></tr></table></figure>
<p><strong>3.例子</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="section">[program:usercenter]</span></div><div class="line"><span class="comment">; 程序的启动目录</span></div><div class="line"><span class="attr">directory</span> = /home/leon/projects/usercenter</div><div class="line"><span class="comment">; 启动命令，可以看出与手动在命令行启动的命令是一样的</span></div><div class="line"><span class="attr">command</span> = gunicorn -c gunicorn.py --port=%(process_num)s wsgi:app</div><div class="line"><span class="comment">; 程序名字</span></div><div class="line"><span class="attr">process_name</span>=%(program_name)s_%(process_num)<span class="number">02</span>d</div><div class="line"><span class="comment">; 开始数字</span></div><div class="line"><span class="attr">numprocs_start</span>=<span class="number">8110</span></div><div class="line"><span class="comment">; 数量</span></div><div class="line"><span class="attr">numprocs</span>=<span class="number">4</span></div><div class="line"><span class="comment">; 在 supervisord 启动的时候也自动启动</span></div><div class="line"><span class="attr">autostart</span> = <span class="literal">true</span></div><div class="line"><span class="comment">; 启动 5 秒后没有异常退出，就当作已经正常启动了</span></div><div class="line"><span class="attr">startsecs</span> = <span class="number">5</span></div><div class="line"><span class="comment">; 程序异常退出后自动重启</span></div><div class="line"><span class="attr">autorestart</span> = <span class="literal">true</span></div><div class="line"><span class="comment">; 启动失败自动重试次数，默认是 3</span></div><div class="line"><span class="attr">startretries</span> = <span class="number">3</span></div><div class="line"><span class="comment">; 用哪个用户启动</span></div><div class="line"><span class="attr">user</span> = leon</div><div class="line"><span class="comment">; 把 stderr 重定向到 stdout，默认 false</span></div><div class="line"><span class="attr">redirect_stderr</span> = <span class="literal">true</span></div><div class="line"><span class="comment">; stdout 日志文件大小，默认 50MB</span></div><div class="line"><span class="attr">stdout_logfile_maxbytes</span> = <span class="number">20</span>MB</div><div class="line"><span class="comment">; stdout 日志文件备份数</span></div><div class="line"><span class="attr">stdout_logfile_backups</span> = <span class="number">20</span></div><div class="line"><span class="comment">; stdout 日志文件，需要注意当指定目录不存在时无法正常启动，所以需要手动创建目录（supervisord 会自动创建日志文件）</span></div><div class="line"><span class="attr">stdout_logfile</span> = /data/logs/usercenter_stdout.log</div></pre></td></tr></table></figure>
<h2 id="0x03-supervisord-启动和维护"><a href="#0x03-supervisord-启动和维护" class="headerlink" title="0x03 supervisord 启动和维护"></a>0x03 supervisord 启动和维护</h2><p><strong>1.启动服务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/supervisord -c /etc/supervisor.conf</div></pre></td></tr></table></figure>
<p><strong>2.启动管理端</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">supervisorctl -c /etc/supervisor.conf</div></pre></td></tr></table></figure>
<p>若是连接远程的则:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">supervisorctl -c /etc/supervisor.conf -s &quot;http://114.114.114.114:9001&quot;</div></pre></td></tr></table></figure>
<p><strong>3.管理服务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"># 查看服务状态</div><div class="line">status</div><div class="line"></div><div class="line">   # 关闭 usercenter 程序</div><div class="line">   stop usercenter</div><div class="line"></div><div class="line">   # 停止所有程序</div><div class="line">   stop all</div><div class="line"></div><div class="line"># 启动 usercenter 程序</div><div class="line">start usercenter</div><div class="line"></div><div class="line"># 启动所有程序</div><div class="line">   start all</div><div class="line"></div><div class="line">   # 重启 usercenter 程序</div><div class="line">   restart usercenter</div><div class="line"></div><div class="line"># 重启所有程序</div><div class="line">   restart all</div><div class="line"></div><div class="line"># 读取有更新的的配置文件，不会启动新程序</div><div class="line">   reread</div><div class="line"></div><div class="line">   # 重启启动远程supervisord</div><div class="line">   reload</div><div class="line"></div><div class="line">   # 更新配置文件，若有新的则启动，若删除了则停止</div><div class="line">   update</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V1.0.1
邮箱： daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&quot;http://supervisord.org/installing.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里是官方链接&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>nginx 配置https并自签名证书</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2016/10/28/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2016-10-28-nginx%E9%85%8D%E7%BD%AEhttps%E5%B9%B6%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/"/>
    <id>http://daodaoliang.com/环境搭建/2016/10/28/环境搭建-2016-10-28-nginx配置https并自签名证书/</id>
    <published>2016-10-27T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V1.0.1
邮箱： daodaoliang@yeah.net
</code></pre><p>参考链接： <a href="http://blog.creke.net/762.html" target="_blank" rel="external">这里</a> 和 <a href="http://blog.csdn.net/eclothy/article/details/45932733" target="_blank" rel="external">这里</a> 和 <a href="http://nginx.org/en/docs/http/configuring_https_servers.html" target="_blank" rel="external">官方文档</a></p>
<a id="more"></a>
<h3 id="1-制作服务器证书"><a href="#1-制作服务器证书" class="headerlink" title="1. 制作服务器证书"></a>1. 制作服务器证书</h3><p>服务器CA私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl genrsa -des3 -out ca.key 2048</div></pre></td></tr></table></figure>
<p>制作解密后的CA私钥（一般无此必要）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl rsa -in ca.key -out ca_decrypted.key</div></pre></td></tr></table></figure>
<p>ca.crt CA根证书（公钥）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl req -new -x509 -days 7305 -key ca.key -out ca.crt</div></pre></td></tr></table></figure>
<h3 id="2-制作生成网站的证书并用CA签名认证"><a href="#2-制作生成网站的证书并用CA签名认证" class="headerlink" title="2. 制作生成网站的证书并用CA签名认证"></a>2. 制作生成网站的证书并用CA签名认证</h3><p>在这里，假设网站域名为 www.example.com</p>
<p>生成 www.example.com 证书私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl genrsa -des3 -out www.example.com.pem 1024</div></pre></td></tr></table></figure>
<p>制作解密后的 www.example.com 证书私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl rsa -in www.example.com.pem -out www.example.com.key</div></pre></td></tr></table></figure>
<p>生成签名请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl req -new -key www.example.com.pem -out www.example.com.csr</div></pre></td></tr></table></figure>
<p>在common name中填入网站域名，如 www.example.com 即可生成改站点的证书，同时也可以使用泛域名如 *.example.com 来生成所有二级域名可用的网站证书。</p>
<p>用CA进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl ca -policy policy_anything -days 1460 -cert ca.crt -keyfile ca.key -in www.example.com.csr -out www.example.com.crt</div></pre></td></tr></table></figure>
<p>其中，policy参数允许签名的CA和网站证书可以有不同的国家、地名等信息，days参数则是签名时限。</p>
<p>如果在执行签名命令时，出现“I am unable to access the ../../CA/newcerts directory”</p>
<p>修改/etc/pki/tls/openssl.cnf中“dir = ./CA”</p>
<p>然后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mkdir -p CA/newcerts</div><div class="line"></div><div class="line">touch CA/index.txt</div><div class="line"></div><div class="line">touch CA/serial</div><div class="line"></div><div class="line">echo &quot;01&quot; &gt; CA/serial</div></pre></td></tr></table></figure>
<p>再重新执行签名命令。</p>
<p>最后，把ca.crt的内容粘贴到 www.example.com.crt 后面。这个比较重要！因为不这样做，可能会有某些浏览器不支持。</p>
<p>好了，现在https需要到的网站私钥 www.example.com.key 和网站证书 www.example.com.crt 都准备完毕。接下来开始配置服务端。</p>
<h3 id="3-配置nginx"><a href="#3-配置nginx" class="headerlink" title="3. 配置nginx"></a>3. 配置nginx</h3><p>新开一个虚拟主机，并在server{}段中设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">listen 443;</div><div class="line"></div><div class="line">ssl on;</div><div class="line"></div><div class="line">ssl_certificate /path/to/www.example.com.crt;</div><div class="line"></div><div class="line">ssl_certificate_key /path/to/www.example.com.key;</div></pre></td></tr></table></figure>
<p>其中的路径是刚刚生成的网站证书的路径。</p>
<p>然后使用一下命令检测配置和重新加载nginx：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">检测配置：</div><div class="line">nginx -t</div><div class="line">重新加载：</div><div class="line">nginx -s reload</div></pre></td></tr></table></figure>
<h3 id="4-优化nginx配置"><a href="#4-优化nginx配置" class="headerlink" title="4. 优化nginx配置"></a>4. 优化nginx配置</h3><p><strong>https和http共存:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">        listen 80;</div><div class="line">        listen 443 ssl;</div><div class="line">        server_name zou.lu;</div><div class="line">        root /var/www/html;</div><div class="line"></div><div class="line">        #ssl on;   //这行必须要注释掉</div><div class="line">        ssl_certificate /usr/local/nginx/conf/zou_lu.crt;</div><div class="line">        ssl_certificate_key /usr/local/nginx/conf/zoulukey.pem;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>优化性能:</strong></p>
<p>在http{}中加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ssl_session_cache shared:SSL:10m;</div><div class="line"></div><div class="line">ssl_session_timeout 10m;</div></pre></td></tr></table></figure>
<p>据官方文档所述，cache中的1m可以存放4000个session。</p>
<p>在配置https的虚拟主机server{}中加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keepalive_timeout 70;</div></pre></td></tr></table></figure>
<p><strong>PS:常见错误:</strong></p>
<p>有时候，会发现，在phpMyAdmin等程序登入后会错误地跳转http的问题。解决方法是定位至“location ~ .*.(php|php5)?${}”在include fcgi.conf;或者在fastcgi_param配置后面加上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastcgi_param HTTPS on;</div><div class="line"></div><div class="line">fastcgi_param HTTP_SCHEME https;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V1.0.1
邮箱： daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;参考链接： &lt;a href=&quot;http://blog.creke.net/762.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt; 和 &lt;a href=&quot;http://blog.csdn.net/eclothy/article/details/45932733&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt; 和 &lt;a href=&quot;http://nginx.org/en/docs/http/configuring_https_servers.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文档&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>常用的正则表达式</title>
    <link href="http://daodaoliang.com/%E8%BD%AC%E8%BD%BD/2016/09/28/%E8%BD%AC%E8%BD%BD-2016-09-28-%E5%B8%B8%E7%94%A8%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <id>http://daodaoliang.com/转载/2016/09/28/转载-2016-09-28-常用的正则表达式/</id>
    <published>2016-09-27T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.962Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>原文出处: (http://www.jianshu.com/p/e7bb97218946)
日期: 2016年9月28日
版本: V1.0.1.0
</code></pre><a id="more"></a>
<p>正则表达式，一个十分古老而又强大的文本处理工具，仅仅用一段非常简短的表达式语句，便能够快速实现一个非常复杂的业务逻辑。熟练地掌握正则表达式的话，能够使你的开发效率得到极大的提升。</p>
<p>正则表达式经常被用于字段或任意字符串的校验，如下面这段校验基本日期格式的JavaScript代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^(\\d&#123;1,4&#125;)(-|\\/</span>)(\\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)\\<span class="number">2</span>(\\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)$/; </div><div class="line"><span class="keyword">var</span> r = fieldValue.match(reg); </div><div class="line"><span class="keyword">if</span>(r==<span class="literal">null</span>)alert(<span class="string">'Date format error!'</span>);</div></pre></td></tr></table></figure>
<h2 id="1-校验密码强度"><a href="#1-校验密码强度" class="headerlink" title="1.校验密码强度"></a>1.校验密码强度</h2><p>密码的强度必须是包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</div></pre></td></tr></table></figure>
<h2 id="2-校验中文"><a href="#2-校验中文" class="headerlink" title="2.校验中文"></a>2.校验中文</h2><p>字符串仅能是中文.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^[\\u4e00-\\u9fa5]&#123;0,&#125;$</div></pre></td></tr></table></figure>
<h2 id="3-由数字、26个英文字母或下划线组成的字符串"><a href="#3-由数字、26个英文字母或下划线组成的字符串" class="headerlink" title="3.由数字、26个英文字母或下划线组成的字符串"></a>3.由数字、26个英文字母或下划线组成的字符串</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^\\w+$</div></pre></td></tr></table></figure>
<h2 id="4-校验E-Mail-地址"><a href="#4-校验E-Mail-地址" class="headerlink" title="4.校验E-Mail 地址"></a>4.校验E-Mail 地址</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[\\w!#$%&amp;&apos;*+/=?^_`&#123;|&#125;~-]+(?:\\.[\\w!#$%&amp;&apos;*+/=?^_`&#123;|&#125;~-]+)*@(?:[\\w](?:[\\w-]*[\\w])?\\.)+[\\w](?:[\\w-]*[\\w])?</div></pre></td></tr></table></figure>
<h2 id="5-校验身份证号码"><a href="#5-校验身份证号码" class="headerlink" title="5.校验身份证号码"></a>5.校验身份证号码</h2><p>下面是身份证号码的正则校验。15 或 18位。</p>
<p><strong>15位</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^[1-9]\\d&#123;7&#125;((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d&#123;3&#125;$</div></pre></td></tr></table></figure>
<p><strong>18位</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^[1-9]\\d&#123;5&#125;[1-9]\\d&#123;3&#125;((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d&#123;3&#125;([0-9]|X)$</div></pre></td></tr></table></figure>
<h2 id="6-校验日期"><a href="#6-校验日期" class="headerlink" title="6.校验日期"></a>6.校验日期</h2><p>“yyyy-mm-dd“ 格式的日期校验，已考虑平闰年。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^(?:(?!0000)[0-9]&#123;4&#125;-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]&#123;2&#125;(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$</div></pre></td></tr></table></figure>
<h2 id="7-校验金额"><a href="#7-校验金额" class="headerlink" title="7.校验金额"></a>7.校验金额</h2><p>金额校验，精确到2位小数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^[0-9]+(.[0-9]&#123;2&#125;)?$</div></pre></td></tr></table></figure>
<h2 id="8-校验手机号"><a href="#8-校验手机号" class="headerlink" title="8.校验手机号"></a>8.校验手机号</h2><p>下面是国内 13、15、18开头的手机号正则表达式。（可根据目前国内收集号扩展前两位开头号码）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d&#123;8&#125;$</div></pre></td></tr></table></figure>
<h2 id="9-判断IE的版本"><a href="#9-判断IE的版本" class="headerlink" title="9.判断IE的版本"></a>9.判断IE的版本</h2><p>IE目前还没被完全取代，很多页面还是需要做版本兼容，下面是IE版本检查的表达式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^.*MSIE [5-8](?:\\.[0-9]+)?(?!.*Trident\\/[5-9]\\.0).*$</div></pre></td></tr></table></figure>
<h2 id="10-校验IP-v4地址"><a href="#10-校验IP-v4地址" class="headerlink" title="10.校验IP-v4地址"></a>10.校验IP-v4地址</h2><p>IP4 正则语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b</div></pre></td></tr></table></figure>
<h2 id="11-校验IP-v6地址"><a href="#11-校验IP-v6地址" class="headerlink" title="11.校验IP-v6地址"></a>11.校验IP-v6地址</h2><p>IP6 正则语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(([0-9a-fA-F]&#123;1,4&#125;:)&#123;7,7&#125;[0-9a-fA-F]&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,7&#125;:|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,6&#125;:[0-9a-fA-F]&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,5&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,4&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,3&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,2&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|[0-9a-fA-F]&#123;1,4&#125;:((:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,6&#125;)|:((:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,7&#125;|:)|fe80:(:[0-9a-fA-F]&#123;0,4&#125;)&#123;0,4&#125;%[0-9a-zA-Z]&#123;1,&#125;|::(ffff(:0&#123;1,4&#125;)&#123;0,1&#125;:)&#123;0,1&#125;((25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])\\.)&#123;3,3&#125;(25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,4&#125;:((25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])\\.)&#123;3,3&#125;(25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9]))</div></pre></td></tr></table></figure>
<h2 id="12-检查URL的前缀"><a href="#12-检查URL的前缀" class="headerlink" title="12.检查URL的前缀"></a>12.检查URL的前缀</h2><p>应用开发中很多时候需要区分请求是HTTPS还是HTTP，通过下面的表达式可以取出一个url的前缀然后再逻辑判断。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">if (!s.match(/^[a-zA-Z]+:\\/\\//)) &#123; s = &apos;http://&apos; + s; &#125;</div></pre></td></tr></table></figure>
<h2 id="13-提取URL链接"><a href="#13-提取URL链接" class="headerlink" title="13.提取URL链接"></a>13.提取URL链接</h2><p>下面的这个表达式可以筛选出一段文本中的URL.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^(f|ht)&#123;1&#125;(tp|tps):\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&amp;=]*)?</div></pre></td></tr></table></figure>
<h2 id="14-文件路径及扩展名校验"><a href="#14-文件路径及扩展名校验" class="headerlink" title="14.文件路径及扩展名校验"></a>14.文件路径及扩展名校验</h2><p>验证windows下文件路径和扩展名（下面的例子中为.txt文件）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^([a-zA-Z]\\:|\\\\)\\\\([^\\\\]+\\\\)*[^\\/:*?&quot;&lt;&gt;|]+\\.txt(l)?$</div></pre></td></tr></table></figure>
<h2 id="15-提取Color-Hex-Codes"><a href="#15-提取Color-Hex-Codes" class="headerlink" title="15.提取Color Hex Codes"></a>15.提取Color Hex Codes</h2><p>有时需要抽取网页中的颜色代码，可以使用下面的表达式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^#([A-Fa-f0-9]&#123;6&#125;|[A-Fa-f0-9]&#123;3&#125;)$</div></pre></td></tr></table></figure>
<h2 id="16-提取网页图片"><a href="#16-提取网页图片" class="headerlink" title="16.提取网页图片"></a>16.提取网页图片</h2><p>假若你想提取网页中所有图片信息，可以利用下面的表达式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\\&lt; *[img][^\\\\&gt;]*[src] *= *[\\&quot;\\&apos;]&#123;0,1&#125;([^\\&quot;\\&apos;\\ &gt;]*)</div></pre></td></tr></table></figure>
<h2 id="17-提取页面超链接"><a href="#17-提取页面超链接" class="headerlink" title="17.提取页面超链接"></a>17.提取页面超链接</h2><p>提取html中的超链接。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(&lt;a\\s*(?!.*\\brel=)[^&gt;]*)(href=&quot;https?:\\/\\/)((?!(?:(?:www\\.)?&apos;.implode(&apos;|(?:www\\.)?&apos;, $follow_list).&apos;))[^&quot;]+)&quot;((?!.*\\brel=)[^&gt;]*)(?:[^&gt;]*)&gt;</div></pre></td></tr></table></figure>
<h2 id="18-查找CSS属性"><a href="#18-查找CSS属性" class="headerlink" title="18.查找CSS属性"></a>18.查找CSS属性</h2><p>通过下面的表达式，可以搜索到相匹配的CSS属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^\\s*[a-zA-Z\\-]+\\s*[:]&#123;1&#125;\\s[a-zA-Z0-9\\s.#]+[;]&#123;1&#125;</div></pre></td></tr></table></figure>
<h2 id="19-抽取注释"><a href="#19-抽取注释" class="headerlink" title="19.抽取注释"></a>19.抽取注释</h2><p>如果你需要移除HMTL中的注释，可以使用如下的表达式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;!--(.*?)--&gt;</div></pre></td></tr></table></figure>
<h2 id="20-匹配HTML标签"><a href="#20-匹配HTML标签" class="headerlink" title="20.匹配HTML标签"></a>20.匹配HTML标签</h2><p>通过下面的表达式可以匹配出HTML中的标签属性.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;\\/?\\w+((\\s+\\w+(\\s*=\\s*(?:&quot;.*?&quot;|&apos;.*?&apos;|[\\^&apos;&quot;&gt;\\s]+))?)+\\s*|\\s*)\\/?&gt;</div></pre></td></tr></table></figure>
<h2 id="学习正则表达式"><a href="#学习正则表达式" class="headerlink" title="学习正则表达式"></a>学习正则表达式</h2><p><img src="/res/img/blog/转载/正则.jpg" alt="正则"></p>
<p><a href="https://msdn.microsoft.com/en-us/library/az24scfc(v=vs.110).aspx" target="_blank" rel="external">1.快速学习指南</a></p>
<p><a href="https://regex101.com/#javascript" target="_blank" rel="external">2.在线测试工具</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;原文出处: (http://www.jianshu.com/p/e7bb97218946)
日期: 2016年9月28日
版本: V1.0.1.0
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="转载" scheme="http://daodaoliang.com/categories/%E8%BD%AC%E8%BD%BD/"/>
    
    
  </entry>
  
  <entry>
    <title>nginx 常用的配置</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2016/09/20/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2016-03-14-nginx%E7%9A%84%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE/"/>
    <id>http://daodaoliang.com/环境搭建/2016/09/20/环境搭建-2016-03-14-nginx的常用配置/</id>
    <published>2016-09-19T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p>安装请移步这里<a href="http://daodaoliang.github.io/blog/2015/05/12/CentOS6.5%E9%80%9A%E8%BF%87%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85nginx.html" target="_blank" rel="external">点击我</a></p>
<a id="more"></a>
<h2 id="1-nginx目录嵌套"><a href="#1-nginx目录嵌套" class="headerlink" title="1. nginx目录嵌套"></a><strong>1. nginx目录嵌套</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line"></div><div class="line">    .......</div><div class="line">    include /etc/nginx/conf.d/*.conf;</div><div class="line">    include sites/*.conf;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-gzip-on"><a href="#2-gzip-on" class="headerlink" title="2. gzip on"></a><strong>2. gzip on</strong></h2><p>加到http模块中, 开启gzip, 注意gzip_types配置得是压缩的资源类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line"></div><div class="line"></div><div class="line">    .....</div><div class="line"></div><div class="line"></div><div class="line">    gzip on;</div><div class="line">    gzip_min_length 1k;</div><div class="line">    gzip_comp_level 5;</div><div class="line">    gzip_proxied expired no-cache no-store private auth;</div><div class="line">    gzip_types text/plain text/css application/javascript text/javascript application/x-javascript text/xml application/xml application/xml+rss application/json image/x-icon image/png image/jpg image/jpeg application/font-woff;</div><div class="line">    gzip_vary on;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-多处理器"><a href="#3-多处理器" class="headerlink" title="3. 多处理器"></a><strong>3. 多处理器</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">worker_processes  4;</div><div class="line">events &#123;</div><div class="line">    worker_connections  2048;</div><div class="line">    use epoll;</div><div class="line">    multi_accept on;</div><div class="line">&#125;</div><div class="line"></div><div class="line">worker_rlimit_nofile 100000;</div></pre></td></tr></table></figure>
<h2 id="4-静态文件缓存"><a href="#4-静态文件缓存" class="headerlink" title="4. 静态文件缓存"></a><strong>4. 静态文件缓存</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">location ~* \.(?:css|js)$ &#123;</div><div class="line">  expires 12h;</div><div class="line">  access_log off;</div><div class="line">  add_header Cache-Control &quot;public&quot;;</div><div class="line">  proxy_pass http://127.0.0.1:5000;</div><div class="line">  proxy_redirect off;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="5-代理"><a href="#5-代理" class="headerlink" title="5. 代理"></a><strong>5. 代理</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">location /</div><div class="line">&#123;</div><div class="line">    proxy_pass http://127.0.0.1:8000;</div><div class="line">    proxy_pass_header Server;</div><div class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class="line">    proxy_set_header X-Real-IP $remote_addr;</div><div class="line">    proxy_set_header X-Scheme $scheme;</div><div class="line">    proxy_set_header Host $http_host;</div><div class="line">    proxy_redirect off;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以设置超时时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">proxy_connect_timeout 500s;</div><div class="line">proxy_read_timeout 500s;</div><div class="line">proxy_send_timeout 500s;</div></pre></td></tr></table></figure>
<h2 id="6-静态目录-or-文件"><a href="#6-静态目录-or-文件" class="headerlink" title="6. 静态目录 or 文件"></a><strong>6. 静态目录 or 文件</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">location /movies/ &#123;</div><div class="line">    alias /Volumes/Media/Movies/;</div><div class="line">    allow all;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location = /abc.txt &#123;</div><div class="line">    alias /data/www/static/abc.txt;</div><div class="line">    expires  30d;</div><div class="line">    access_log off;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="7-静态站"><a href="#7-静态站" class="headerlink" title="7. 静态站"></a><strong>7. 静态站</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">server &#123;</div><div class="line">    listen       192.168.1.1:80;</div><div class="line">    server_name  www.abc.com;</div><div class="line"></div><div class="line">    client_max_body_size 1M;</div><div class="line">    access_log logs/blog_access.log;</div><div class="line">    error_log logs/blog_error.log;</div><div class="line"></div><div class="line">    root /data/static_site_dir;</div><div class="line">    index index.html;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="8-服务转发"><a href="#8-服务转发" class="headerlink" title="8. 服务转发"></a><strong>8. 服务转发</strong></h2><p>将收到的服务url/参数等, 原封不动转给另一个服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    server_name  www.xxxx.com;</div><div class="line">    location ~ ^/(.*)$ &#123;</div><div class="line">        proxy_pass http://192.168.1.1:80/another/service/$1$is_args$args;</div><div class="line">        proxy_read_timeout 90;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="9-return"><a href="#9-return" class="headerlink" title="9. return"></a><strong>9. return</strong></h2><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">return http_code;</div><div class="line">return http_code &quot;content&quot;;</div></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">location /api/test/ &#123;</div><div class="line">    return 403;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location /stat/ &#123;</div><div class="line">    return 204;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location /ping/ &#123;</div><div class="line">    return 200;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="10-重定向到-www"><a href="#10-重定向到-www" class="headerlink" title="10. 重定向到 www"></a><strong>10. 重定向到 www</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    server_name  abc.com;</div><div class="line">    rewrite ^(.*) http://www.abc.com$1 permanent;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="11-允许或者拒绝"><a href="#11-允许或者拒绝" class="headerlink" title="11. 允许或者拒绝"></a><strong>11. 允许或者拒绝</strong></h2><p>访问ip控制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location /test/ &#123;</div><div class="line">    allow 192.168.1.1;</div><div class="line">    deny all;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="12-负载均衡"><a href="#12-负载均衡" class="headerlink" title="12. 负载均衡"></a><strong>12. 负载均衡</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">http &#123;</div><div class="line"></div><div class="line">    upstream test &#123;</div><div class="line">        server 192.168.1.1:5000;</div><div class="line">        server 192.168.1.2:5000;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">server &#123;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        proxy_pass test;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="13-配置文件检查"><a href="#13-配置文件检查" class="headerlink" title="13. 配置文件检查"></a><strong>13. 配置文件检查</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">检查配置文件正确性</div><div class="line">service nginx configtest</div><div class="line"></div><div class="line"></div><div class="line">重新加载配置</div><div class="line">service nginx reload</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;安装请移步这里&lt;a href=&quot;http://daodaoliang.github.io/blog/2015/05/12/CentOS6.5%E9%80%9A%E8%BF%87%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85nginx.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击我&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>10个值得前端收藏的CSS3动效库</title>
    <link href="http://daodaoliang.com/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/2016/09/18/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0-2016-09-28-10%E4%B8%AA%E5%80%BC%E5%BE%97%E5%89%8D%E7%AB%AF%E6%94%B6%E8%97%8F%E7%9A%84CSS3%E5%8A%A8%E6%95%88%E5%BA%93/"/>
    <id>http://daodaoliang.com/前端学习/2016/09/18/前端学习-2016-09-28-10个值得前端收藏的CSS3动效库/</id>
    <published>2016-09-17T16:00:00.000Z</published>
    <updated>2017-05-03T16:07:44.961Z</updated>
    
    <content type="html"><![CDATA[<pre><code>原文: http://www.jianshu.com/p/31118d83cb5f#
版本: V1.0.1.0
日期: 2016年9月28日
</code></pre><a id="more"></a>
<p>现在的网站和App的设计中越来越重视用户体验，而优秀的动效则能使你的应用更具交互性，从而吸引更多用户的使用。如果你对CSS3中定义动效还不熟练，或希望采用更加简单直接的方式在你的应用中引入动效的话，你可以参考并使用下面的这10个优秀动效库（工具）。</p>
<h2 id="1-Animate-css"><a href="#1-Animate-css" class="headerlink" title="1.Animate.css"></a>1.<a href="https://daneden.github.io/animate.css/" target="_blank" rel="external">Animate.css</a></h2><p>Animate.css是我比较喜欢的一个CSS3动效库，非常适合那些对CSS3动画效果不熟悉，但又希望给自己所做的网站或基于H5的APP引入动效的朋友。因为，你只需要给需要实现动效的元素添加上Animate.css中预定义的那些动效名称就可以了。比如常见的：bounce，flash，fadeIn，fadeOut等等，加起来有75种不同的动效，完全能够满足你的基本需要了。</p>
<p><img src="/res/img/blog/前端学习/Animate.png" alt="Animate"></p>
<p>当然对于这个库也有一些使用注意事项，比如你最好在给元素添加动效样式完成动效后，马上将这个动效样式去掉。另外，对于动效的时长，振动幅度等，你也需要做一些调整。因为，我感觉它默认设置中的动效过于快速和强烈了。Animate.css已经提供了详细的文档告诉你应该如何做这些调整。</p>
<hr>


<h2 id="2-Bounce-js"><a href="#2-Bounce-js" class="headerlink" title="2.Bounce.js"></a>2.<a href="http://bouncejs.com/" target="_blank" rel="external">Bounce.js</a></h2><p>Bounce.js是一个能够生成CSS3动效的小工具，它是用JavaScript编写的，提供了一个Web界面，你可以添加一个组件然后就可以选择包括Scale，Translate，Rotate，Skew这些动效类型，然后分别设置它们的参数，当达到你想要的效果后，你可以将这个动效以CSS的方式导出，这样你就可以将它应用到你的应用中了。</p>
<p><img src="/res/img/blog/前端学习/Bounce.png" alt="Bounce"></p>
<hr>

<h2 id="3-CSS3-Animation"><a href="#3-CSS3-Animation" class="headerlink" title="3.CSS3 Animation"></a>3.<a href="http://css3gen.com/css3-animation/" target="_blank" rel="external">CSS3 Animation</a></h2><p>CSS3 Animation是一个非常简单易用的动效工具，你可以在它提供的简单图形界面里，通过拖拽一些进度条来控制你的动效，生成的CSS代码会自动显示在下面的一个文本框里，你可以拷贝粘贴到你的应用中直接使用。</p>
<p><img src="/res/img/blog/前端学习/Animation.png" alt="Animation"></p>
<hr>

<h2 id="4-CSS-Animate"><a href="#4-CSS-Animate" class="headerlink" title="4.CSS Animate"></a>4.<a href="http://cssanimate.com/" target="_blank" rel="external">CSS Animate</a></h2><p>如果你觉得上面的工具还无法做出你想要的动效，那么可以看看CSS Animate这个工具。它能让你设置更多的动效参数，比如你可以同时设置动效起始和终止状态的坐标，大小，以及透明度，这样你就能够做出更加复杂的动效来。</p>
<p><img src="/res/img/blog/前端学习/Animate1.png" alt="Animate1"></p>
<hr>

<h2 id="5-Magic-Animations"><a href="#5-Magic-Animations" class="headerlink" title="5.Magic Animations"></a>5.<a href="https://www.minimamente.com/example/magic_animations/" target="_blank" rel="external">Magic Animations</a></h2><p>Magic Animations与Animate.css十分类似，也是一个预定义了一系列动效的CSS库。但与Animate.css的最大区别可能是，它定义的那些动效更炫也更酷一些，如果你的网站也很新潮，那可以考虑使用这个CSS动效库。</p>
<p><img src="/res/img/blog/前端学习/Magic.png" alt="Magic"></p>
<hr>

<h2 id="6-AniJS"><a href="#6-AniJS" class="headerlink" title="6.AniJS"></a>6.<a href="http://anijs.github.io/" target="_blank" rel="external">AniJS</a></h2><p>AniJS是一个通过JavaScript控制的动效库。它允许你通过它的链式语法来定义动效。比如下面这个例子：当用户点击时这个元素会沿Y轴翻转。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div data-anijs=&quot;if: click, do: flipInY, to: .container-box&quot;&gt;&lt;/div&gt;</div></pre></td></tr></table></figure>
<p><img src="/res/img/blog/前端学习/AniJS.png" alt="AniJS"></p>
<h2 id="7-Single-Element-CSS-Spinners"><a href="#7-Single-Element-CSS-Spinners" class="headerlink" title="7.Single Element CSS Spinners"></a>7.<a href="http://projects.lukehaas.me/css-loaders/" target="_blank" rel="external">Single Element CSS Spinners</a></h2><p>我们经常会需要一些动效来表达系统处于加载或处理数据的过程中。Single Element CSS Spinners这个在GitHub上的项目，提供了一组非常漂亮的可用于加载的CSS3动效。</p>
<p><img src="/res/img/blog/前端学习/Spinners.png" alt="Spinners"></p>
<h2 id="8-Snabbt-js"><a href="#8-Snabbt-js" class="headerlink" title="8.Snabbt.js"></a>8.<a href="http://daniel-lundin.github.io/snabbt.js/" target="_blank" rel="external">Snabbt.js</a></h2><p>Sanbbt.js是我很喜欢的一个动效库，它非常小巧只有5K，所以可以被用在移动应用中。而且它也支持链式语法，你可以很方便地写出复杂的动效组合。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">snabbt(element, &#123;</div><div class="line">  position: [200, 0, 0],</div><div class="line">  easing: function(value) &#123;</div><div class="line">    return value + 0.3 * Math.sin(2*Math.PI * value);</div><div class="line">  &#125;</div><div class="line">&#125;).snabbt(&#123;</div><div class="line">  position: [0, 0, 0],</div><div class="line">  easing: &apos;easeOut&apos;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><img src="/res/img/blog/前端学习/Snabbt.png" alt="Snabbt"></p>
<h2 id="9-Odometer"><a href="#9-Odometer" class="headerlink" title="9.Odometer"></a>9.<a href="http://github.hubspot.com/odometer/docs/welcome/" target="_blank" rel="external">Odometer</a></h2><p>Odometer 是用来给数字作动效的，比如通过它你可以很好地呈现网站人数的增加，倒计时等与数字相关的动画效果。</p>
<p><img src="/res/img/blog/前端学习/Odometer.png" alt="Odometer"></p>
<h2 id="10-Hover-css"><a href="#10-Hover-css" class="headerlink" title="10.Hover.css"></a>10.<a href="http://ianlunn.github.io/Hover/" target="_blank" rel="external">Hover.css</a></h2><p>Hover.css提供了大量的Hover效果，包括2D变换，图标变换，背景变换等等。而且几乎可以应用于所有元素，包括链接，按钮，logo，SVG甚至图片等等。</p>
<p><img src="/res/img/blog/前端学习/Hover.png" alt="Hover"></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;原文: http://www.jianshu.com/p/31118d83cb5f#
版本: V1.0.1.0
日期: 2016年9月28日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="前端学习" scheme="http://daodaoliang.com/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
</feed>
