<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>刀刀亮的博客</title>
  <subtitle>一切源于内心</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://daodaoliang.com/"/>
  <updated>2017-08-23T08:55:10.378Z</updated>
  <id>http://daodaoliang.com/</id>
  
  <author>
    <name>daodaoliang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>梦想清单</title>
    <link href="http://daodaoliang.com/%E5%BF%83%E4%B8%96%E7%95%8C/2099/04/14/%E6%96%B0%E4%B8%96%E7%95%8C-2015-04-14-%E6%A2%A6%E6%83%B3%E6%B8%85%E5%8D%95/"/>
    <id>http://daodaoliang.com/心世界/2099/04/14/新世界-2015-04-14-梦想清单/</id>
    <published>2099-04-13T16:00:00.000Z</published>
    <updated>2017-08-23T08:55:10.378Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://source.unsplash.com/random/800x300"></p>
<blockquote class="blockquote-center"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=5267808&auto=1&height=32"></iframe>
</blockquote>
<a id="more"></a>
<div class="note info"><p>target = ‘日日当精进 但求无愧’<br>target = ‘just do it’</p></div>
<ul>
<li><p>完成自己制定的读书计划，按照书单列表进行阅读；</p>
</li>
<li><p>长途骑行一次；</p>
</li>
<li><p>拥有六块腹肌和匀称的身材；</p>
</li>
<li><p>参加一次马拉松比赛；</p>
</li>
<li><p>每天坚持锻炼(在生活轨迹里面打卡吧，这里就不占地方了)；</p>
</li>
<li><p>去心仪的大学读书深造；</p>
</li>
<li><p>拥有自己的工作室；</p>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://source.unsplash.com/random/800x300&quot;&gt;&lt;/p&gt;
&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;298&quot; height=&quot;52&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=5267808&amp;auto=1&amp;height=32&quot;&gt;&lt;/iframe&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="心世界" scheme="http://daodaoliang.com/categories/%E5%BF%83%E4%B8%96%E7%95%8C/"/>
    
    
  </entry>
  
  <entry>
    <title>linux驱动学习之HelloWorld</title>
    <link href="http://daodaoliang.com/linux%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0/2017/08/08/linux%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0-2017-08-08-linux%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0%E5%BC%80%E7%AF%87/"/>
    <id>http://daodaoliang.com/linux驱动学习/2017/08/08/linux驱动学习-2017-08-08-linux驱动学习开篇/</id>
    <published>2017-08-07T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p>作者: daodaoliang@yeah.net<br>   日期: 2017年8月8日10:46:59<br>   版本: V 0.0.1</p></div>
<a id="more"></a>
<hr>
<blockquote class="blockquote-center"><p>一切源于内心</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;作者: daodaoliang@yeah.net&lt;br&gt;   日期: 2017年8月8日10:46:59&lt;br&gt;   版本: V 0.0.1&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="linux驱动学习" scheme="http://daodaoliang.com/categories/linux%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS下面编译Qt4.8.6</title>
    <link href="http://daodaoliang.com/Qt%E5%AD%A6%E4%B9%A0/2017/08/02/Qt%E5%AD%A6%E4%B9%A0-2017-8-2-CentOS%E4%B8%8B%E9%9D%A2%E7%BC%96%E8%AF%91Qt4-8-6/"/>
    <id>http://daodaoliang.com/Qt学习/2017/08/02/Qt学习-2017-8-2-CentOS下面编译Qt4-8-6/</id>
    <published>2017-08-01T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.842Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">作者: daodaoliang</div><div class="line">日期: 2017-08-02</div><div class="line">版本: 0.0.1</div><div class="line">邮箱: daodaoliang@yeah.net</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="1-安装前准备"><a href="#1-安装前准备" class="headerlink" title="1. 安装前准备"></a>1. 安装前准备</h4><ul>
<li>系统环境说明</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">环境</th>
<th style="text-align:center">版本</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">CentOS</td>
<td style="text-align:center">7.2.1511</td>
</tr>
</tbody>
</table>
<ul>
<li>安装开发工具包</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum groupinstall <span class="string">"Development Tools"</span></div></pre></td></tr></table></figure>
<ul>
<li>安装 (libX11-devel、libXext-devel、libXtst-devel)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">yum install libX11-devel</div><div class="line">yum install libXext-devel</div><div class="line">yum install libXtst-devel</div></pre></td></tr></table></figure>
<p><strong>PS：</strong> 如果不安装以上的包在进行 <code>configure</code> 时会出现以下错误</p>
<blockquote>
<p>You might need to modify the include and library search paths by editing<br>QMAKE_INCDIR_X11 and QMAKE_LIBDIR_X11 in /home/zhu/Qt/qt-x11-opensource-src-4.8.6/mkspecs/Linux-g++</p>
</blockquote>
<h4 id="2-编译安装"><a href="#2-编译安装" class="headerlink" title="2. 编译安装"></a>2. 编译安装</h4><ul>
<li>下载源码包</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">下载名称</th>
<th style="text-align:center">下载链接</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">qt-4.8.6源码</td>
<td style="text-align:center"><a href="http://download.qt.io/archive/qt/4.8/4.8.6/" target="_blank" rel="external">点我下载</a></td>
</tr>
</tbody>
</table>
<ul>
<li>解压源码包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 解压的目的目录视情况而定, 随便就好</div><div class="line">cp qt-everywhere-opensource-src-4.8.6.tar.gz /usr/local/src</div><div class="line">tar zxvf ./qt-everywhere-opensource-src-4.8.6.tar.gz</div></pre></td></tr></table></figure>
<ul>
<li>配置生成 <code>Makefile</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd qt-everywhere-opensource-src-4.8.6</div><div class="line">./configure</div></pre></td></tr></table></figure>
<div class="note info"><p>这是需要用户输入协议版本之类的，按需输入即可</p></div>
<ul>
<li>编译 &amp;&amp; 安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmake &amp;&amp; gmake install</div></pre></td></tr></table></figure>
<div class="note info"><p>编译完成的系统会安装在 /usr/local/Trolltech/Qt-4.8.6 下面</p></div>
<h4 id="3-配置环境变量"><a href="#3-配置环境变量" class="headerlink" title="3. 配置环境变量"></a>3. 配置环境变量</h4><ul>
<li>配置环境变量(/etc/profile)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 在 /etc/profile 增加如下内容</div><div class="line">export QTDIR=/usr/local/Trolltech/Qt-4.8.6</div><div class="line">export PATH=$QTDIR/bin:$PATH</div><div class="line">export MANPATH=$QTDIR/man:$MANPATH</div><div class="line">export LD_LIBRARY_PATH=$QTDIR/lib:$LD_LIBRARY_PATH</div></pre></td></tr></table></figure>
<ul>
<li>测试</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qmake -v</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者: daodaoliang&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期: 2017-08-02&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本: 0.0.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;邮箱: daodaoliang@yeah.net&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Qt学习" scheme="http://daodaoliang.com/categories/Qt%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Qt" scheme="http://daodaoliang.com/tags/Qt/"/>
    
  </entry>
  
  <entry>
    <title>mysql用户账号操作</title>
    <link href="http://daodaoliang.com/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/2017/07/10/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0-mysql%E4%B8%93%E9%A2%98-2014-12-21-Mysql%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E6%93%8D%E4%BD%9C/"/>
    <id>http://daodaoliang.com/数据库学习/2017/07/10/数据库学习-mysql专题-2014-12-21-Mysql用户账号操作/</id>
    <published>2017-07-09T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">作者: daodaoliang</div><div class="line">日期: 2017-07-10</div><div class="line">版本: 0.0.3</div><div class="line">邮箱: daodaoliang@yeah.net</div></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="0x01-新建用户"><a href="#0x01-新建用户" class="headerlink" title="0x01 新建用户"></a>0x01 <strong>新建用户</strong></h3><ul>
<li>登陆mysql</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p</div></pre></td></tr></table></figure>
<ul>
<li>创建用户(5.7系列以前)</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">insert into mysql.user(Host,User,Password) values(<span class="string">"localhost"</span>,<span class="string">"用户名"</span>,password(<span class="string">"密码"</span>));</div><div class="line">mysql&gt;flush privileges;</div></pre></td></tr></table></figure>
<ul>
<li>创建用户(通用)</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CREATE USER <span class="string">'username'</span>@<span class="string">'host'</span> IDENTIFIED BY <span class="string">'password'</span>;</div><div class="line">flush privileges;</div></pre></td></tr></table></figure>
<p>这样就创建了用户,可以登陆试一下;</p>
<h3 id="0x02-为用户授权"><a href="#0x02-为用户授权" class="headerlink" title="0x02 为用户授权"></a>0x02 <strong>为用户授权</strong></h3><p>登陆mysql</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p</div></pre></td></tr></table></figure>
<p>授权用户拥有数据库的所有权限。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">grant all privileges on *.* to 用户名@<span class="string">'地址'</span> identified by <span class="string">'密码'</span>;</div><div class="line">flush privileges;</div></pre></td></tr></table></figure>
<p>指定部分权限的话,可以这样子写:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">grant select,update on *.* to 用户名@<span class="string">'地址'</span> identified by <span class="string">'密码'</span>;</div><div class="line">flush privileges;</div></pre></td></tr></table></figure>
<p><strong>特别注意:</strong></p>
<blockquote>
<p>格式：grant 权限 on 数据库名.表名 to 用户@登录主机 identified by “用户密码”;</p>
<p>@ 后面是访问mysql的客户端IP地址（或是 主机名） % 代表任意的客户端，如果填写 localhost 为本地访问（那此用户就不能远程访问该mysql数据库了）。</p>
</blockquote>
<h3 id="0x03-删除用户"><a href="#0x03-删除用户" class="headerlink" title="0x03 删除用户"></a>0x03 <strong>删除用户</strong></h3><p>登陆mysql后</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt;DELETE FROM user WHERE User=<span class="string">"phplamp"</span> and Host=<span class="string">"localhost"</span>;</div><div class="line">mysql&gt;flush privileges;</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">drop user daodaoliang@&apos;%&apos;</div></pre></td></tr></table></figure>
<h3 id="0x04-修改指定用户密码"><a href="#0x04-修改指定用户密码" class="headerlink" title="0x04 修改指定用户密码"></a>0x04 <strong>修改指定用户密码</strong></h3><ul>
<li><strong><em>用UPDATE直接编辑user表(5.7之前版本)</em></strong></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">update mysql.user <span class="built_in">set</span> password=password(<span class="string">'新密码'</span>) <span class="built_in">where</span> User=<span class="string">"phplamp"</span>;</div><div class="line">flush privileges;</div></pre></td></tr></table></figure>
<ul>
<li><strong><em>用UPDATE直接编辑user表(5.7之后版本)</em></strong></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">update user <span class="built_in">set</span> authentication_string=password(<span class="string">'新密码'</span>) <span class="built_in">where</span> user=<span class="string">'root'</span>;</div><div class="line">flush privileges;</div></pre></td></tr></table></figure>
<ul>
<li><strong><em>用mysqladmin</em></strong></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mysqladmin -u root password <span class="string">"newpass"</span></div><div class="line"><span class="comment"># 若设置过root密码,采用如下方法</span></div><div class="line">mysqladmin -u root password oldpass <span class="string">"newpass"</span></div></pre></td></tr></table></figure>
<ul>
<li><strong><em>用SET PASSWORD命令(通用)</em></strong></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SET PASSWORD FOR <span class="string">'root@localhost'</span> = PASSWORD(<span class="string">'newpass'</span>);</div></pre></td></tr></table></figure>
<h3 id="0x05-修改或者忘记ROOT密码"><a href="#0x05-修改或者忘记ROOT密码" class="headerlink" title="0x05 修改或者忘记ROOT密码"></a>0x05 修改或者忘记ROOT密码</h3><ul>
<li>停止数据库服务</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/mysql stop</div></pre></td></tr></table></figure>
<ul>
<li>跳过权限表安全启动</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqld_safe --user=mysql --skip-grant-tables --skip-networking &amp;</div></pre></td></tr></table></figure>
<ul>
<li>重新登录mysql</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root mysql</div></pre></td></tr></table></figure>
<ul>
<li>修改root密码</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SET PASSWORD FOR <span class="string">'root@%'</span> = PASSWORD(<span class="string">'newpass'</span>);</div><div class="line">   FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>
<ul>
<li>重新启动mysql服务</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/mysql restart</div></pre></td></tr></table></figure>
<h3 id="0x06-重命名用户账号"><a href="#0x06-重命名用户账号" class="headerlink" title="0x06 重命名用户账号"></a>0x06 重命名用户账号</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rename user daodaoliang@&apos;%&apos; to nami@&apos;%&apos;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者: daodaoliang&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期: 2017-07-10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本: 0.0.3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;邮箱: daodaoliang@yeah.net&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="数据库学习" scheme="http://daodaoliang.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="mysql" scheme="http://daodaoliang.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>CentOS下搭建IPv6环境</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/06/22/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-06-22-CentOS%E4%B8%8B%E6%90%AD%E5%BB%BAipv6%E7%8E%AF%E5%A2%83/"/>
    <id>http://daodaoliang.com/环境搭建/2017/06/22/环境搭建-2017-06-22-CentOS下搭建ipv6环境/</id>
    <published>2017-06-21T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-06-22</div><div class="line">版本 : 0.0.1</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="1-背景简介"><a href="#1-背景简介" class="headerlink" title="1. 背景简介"></a>1. 背景简介</h3><ol>
<li>阿里云的<code>centos</code>默认是没有开启<code>IPv6</code>的，可以通过 <code>lsmod | grep ipv6</code> 或者 <code>ifconfig -a | grep inet6</code> 进行对应的查看;</li>
<li>由于某些应用在上线某个平台时需要进行Ipv6的适配;</li>
<li><code>Ipv6</code> 确实在某些场景下时必须的;</li>
</ol>
<p>基于以上种种原因，因此才有此文章，此文章所有的部分内容为查阅的其他工程师的探究结果。</p>
<h3 id="2-开启系统的Ipv6"><a href="#2-开启系统的Ipv6" class="headerlink" title="2. 开启系统的Ipv6"></a>2. 开启系统的<code>Ipv6</code></h3><h4 id="2-1-检查系统是否已经开启Ipv6"><a href="#2-1-检查系统是否已经开启Ipv6" class="headerlink" title="2.1 检查系统是否已经开启Ipv6"></a>2.1 检查系统是否已经开启<code>Ipv6</code></h4><p>在终端执行进行查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ifconfig -a | inet6</div></pre></td></tr></table></figure>
<h4 id="2-2-配置开启Ipv6"><a href="#2-2-配置开启Ipv6" class="headerlink" title="2.2 配置开启Ipv6"></a>2.2 配置开启<code>Ipv6</code></h4><ul>
<li>修改<code>/etc/sysctl.conf</code>, 存在则修改，不存在则增加如下内容:</li>
</ul>
<p><img src="/res/img/blog/环境搭建/ipv6.png" alt="img"></p>
<ul>
<li>修改 <code>/etc/modprobe.d/disable_ipv6.conf</code>, 存在则修改，不存在则增加如下内容：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">修改前</div><div class="line">alias net-pf-10 off</div><div class="line">alias ipv6 off</div><div class="line">options ipv6 disable=1</div><div class="line"></div><div class="line">修改后</div><div class="line">alias net-pf-10 off</div><div class="line">#alias ipv6 off</div><div class="line">options ipv6 disable=0</div></pre></td></tr></table></figure>
<ul>
<li>修改<code>/etc/sysconfig/network</code>, 存在则修改，不存在则增加如下内容:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">修改前</div><div class="line">NETWORKING=yes</div><div class="line">HOSTNAME=coolnull</div><div class="line">NETWORKING_IPV6=no</div><div class="line">PEERNTP=no</div><div class="line">GATEWAY=*.*.*.*</div><div class="line"></div><div class="line">修改后</div><div class="line">NETWORKING=yes</div><div class="line">HOSTNAME=coolnull</div><div class="line">NETWORKING_IPV6=yes</div><div class="line">PEERNTP=no</div><div class="line">GATEWAY=*.*.*.*</div></pre></td></tr></table></figure>
<ul>
<li>至此ipv6的服务器端支持已经完成，重启服务器测试是否支持ipv6</li>
</ul>
<h3 id="3-注册免费的Ipv6隧道"><a href="#3-注册免费的Ipv6隧道" class="headerlink" title="3. 注册免费的Ipv6隧道"></a>3. 注册免费的<code>Ipv6</code>隧道</h3><h4 id="3-1-注册账号"><a href="#3-1-注册账号" class="headerlink" title="3.1 注册账号"></a>3.1 注册账号</h4><p><a href="https://www.tunnelbroker.net/" target="_blank" rel="external">https://www.tunnelbroker.net/</a>,不再赘述，注意邮箱不要使用腾讯家的就好，不然收不到激活邮件;</p>
<h4 id="3-2-创建通道"><a href="#3-2-创建通道" class="headerlink" title="3.2 创建通道"></a>3.2 创建通道</h4><ul>
<li>填写云服务器ip以及选择默认的隧道节点，点击Create Tunnel创建。填写ip都，如果出现“IP is a potential tunnel endpoint.”则证明可以添加ipv6隧道，一般隧道节点系统已经默认分配，可以手动选择，大家可以在自己的云服务器上分别ping一下这些ip，选时延低的。</li>
</ul>
<p><img src="/res/img/blog/环境搭建/ipv61.jpg" alt="ipv61"></p>
<ul>
<li>到下一页面切换到Example configurations选项卡，如果你的VPS是centOS/Debian这些常见Linux的话，下拉菜单选择Linux-route2，出现了设置的命令，复制到自己的云服务器上运行。</li>
</ul>
<p><img src="/res/img/blog/环境搭建/ipv62.jpg" alt="ipv62"></p>
<ul>
<li>如果执行失败请用下面的命令执行,替换掉里面对应的IP信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># modprobe ipv6</div><div class="line"># ip tunnel add he-ipv6 mode sit remote &lt;Server IPv4 Address&gt; local &lt;Client IPv4 Address&gt; ttl 255</div><div class="line"># ip link set he-ipv6 up</div><div class="line"># ip addr add &lt;Server IPv6 Address&gt; dev he-ipv6</div><div class="line"># ip -6 route add ::/0 dev he-ipv6</div><div class="line"># ip -f inet6 addr</div></pre></td></tr></table></figure>
<h4 id="3-3-测试Ipv6"><a href="#3-3-测试Ipv6" class="headerlink" title="3.3 测试Ipv6"></a>3.3 测试<code>Ipv6</code></h4><ul>
<li>终端执行如下指令查看对应结果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ifconfig he-ipv6</div></pre></td></tr></table></figure>
<ul>
<li><code>ping6 google</code>的<code>ipv6</code>的<code>DNS</code>服务器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ping6 -c 5 2001:4860:4860::8888</div></pre></td></tr></table></figure>
<p><strong><em>小技巧:</em></strong></p>
<ul>
<li>增加<code>Google</code>的<code>Ipv6</code>的<code>DNS</code>服务器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># vim /eyc/resolv.conf</div><div class="line">nameserver 2001:4860:4860::8888</div><div class="line">nameserver 2001:4860:4860::8844</div></pre></td></tr></table></figure>
<p>接下来就能直接 <code>ping6</code> 支持ipv6的地址了;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ping6 ipv6.google.com</div></pre></td></tr></table></figure>
<h3 id="4-配置阿里云域名"><a href="#4-配置阿里云域名" class="headerlink" title="4. 配置阿里云域名"></a>4. 配置阿里云域名</h3><p>在增加<code>A</code>记录的同时，增加<code>AAAA</code>记录即可，<code>AAAA</code>记录里面的值为<code>server</code>里面的值 注意不要带后面<code>/64</code></p>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-06-22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="centos" scheme="http://daodaoliang.com/tags/centos/"/>
    
      <category term="ipv6" scheme="http://daodaoliang.com/tags/ipv6/"/>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>CentOS下Nexus搭建Maven私库</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/20/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-04-20-CentOS%E4%B8%8BNexus%E6%90%AD%E5%BB%BAMaven%E7%A7%81%E5%BA%93/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/20/环境搭建-2017-04-20-CentOS下Nexus搭建Maven私库/</id>
    <published>2017-04-19T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-20</div><div class="line">版本 : 0.0.4</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="1-Maven私服简介"><a href="#1-Maven私服简介" class="headerlink" title="1. Maven私服简介"></a>1. <code>Maven</code>私服简介</h3><p>搭建私服可以做什么？<br>1、如果公司开发组的开发环境全部内网，这时如何连接到在互联网上的Maven中央仓库呢？<br>2、如果公司经常开发一些公共的组件，如何共享给各个开发组，使用拷贝方式吗？如果这样，公共库升级了怎么办？<br>当然可以解决的问题可能不止上面两点，下面来介绍在<code>CentOS</code>中搭建自己的<code>Maven</code>私服，使用<code>Nexus</code>。</p>
<h3 id="2-java-运行环境准备"><a href="#2-java-运行环境准备" class="headerlink" title="2. java 运行环境准备"></a>2. <code>java</code> 运行环境准备</h3><p>根据官网的介绍，运行环境最好是使用最新的8版本，官网文如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Nexus Repository Manager requires a Java 8 Runtime Environment (JRE) from Oracle. The distributions for OSX and Windows include suitable runtime environments for the specific operating system. The distributions for Unix do not include the runtime environment.</div><div class="line">If you prefer to use an external runtime or use a Unix operating system, it is recommended to use the latest version of Java 8 available from the Oracle website. You can choose to install the full JDK or the JRE only.</div></pre></td></tr></table></figure>
<h4 id="2-1-本地java版本确认"><a href="#2-1-本地java版本确认" class="headerlink" title="2.1 本地java版本确认"></a>2.1 本地<code>java</code>版本确认</h4><p>如果系统是新安装的并且没有进行相关配置的话，默认应该是<code>openJDK1.7版本</code>;</p>
<p><img src="/res/img/blog/环境搭建/java-version.png" alt="java版本查看"></p>
<h4 id="2-2-安装新的JDK"><a href="#2-2-安装新的JDK" class="headerlink" title="2.2 安装新的JDK"></a>2.2 安装新的<code>JDK</code></h4><ul>
<li>由于原有系统很多包都是依赖与JDK，以防万一，我就没有卸载原有的JDK而是在安装一个8版本的JDK;</li>
<li>在<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">JDK官网</a>找到对应的<code>rpm</code>包进行下载并安装,建议本机迅雷下载完成后再传到服务器,也可以找一些速度快的镜像站进行下载;</li>
<li>下载完后直接安装，然后查看对应的版本信息是否正确;</li>
</ul>
<p><img src="/res/img/blog/环境搭建/java-upgrade.png" alt=""></p>
<ul>
<li>顺手改一下<code>JAVA_HOME</code>的环境变量;</li>
</ul>
<p><img src="/res/img/blog/环境搭建/java-home.png" alt="java-home"></p>
<h3 id="3-安装-Nexus"><a href="#3-安装-Nexus" class="headerlink" title="3. 安装 Nexus"></a>3. 安装 <code>Nexus</code></h3><h4 id="3-1-下载Nexus"><a href="#3-1-下载Nexus" class="headerlink" title="3.1 下载Nexus"></a>3.1 下载<code>Nexus</code></h4><ul>
<li>从<a href="https://www.sonatype.com/download-oss-sonatype" target="_blank" rel="external">官网下载</a>对应的安装包到服务器</li>
</ul>
<p><strong>PS</strong>：建议在本机用迅雷下载完了在传上去，或者用一些快一点镜像站；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://www.sonatype.com/oss-thank-you-tar.gz</div></pre></td></tr></table></figure>
<h4 id="3-2-安装-Nexus"><a href="#3-2-安装-Nexus" class="headerlink" title="3.2 安装 Nexus"></a>3.2 安装 <code>Nexus</code></h4><ul>
<li>解压安装包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar zxvf oss-thank-you-tar.gz</div></pre></td></tr></table></figure>
<ul>
<li>安装成服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mv ./nexus-3.1.1-X86_64/  /usr/local/nexus3</div></pre></td></tr></table></figure>
<p>增加环境变量<code>NEXUS_HOME</code></p>
<p><img src="/res/img/blog/环境搭建/nexus.png" alt="nexus环境变量"></p>
<p>创建并开启服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sudo ln -s $NEXUS_HOME/bin/nexus /etc/init.d/nexus</div><div class="line">   cd /etc/init.d</div><div class="line">   sudo chkconfig --add nexus</div><div class="line">   sudo chkconfig --levels 345 nexus on</div><div class="line">   sudo service nexus start</div></pre></td></tr></table></figure>
<h3 id="4-配置-Nexus"><a href="#4-配置-Nexus" class="headerlink" title="4. 配置 Nexus"></a>4. 配置 <code>Nexus</code></h3><h4 id="4-1-配置WEB-访问"><a href="#4-1-配置WEB-访问" class="headerlink" title="4.1 配置WEB 访问"></a>4.1 配置<code>WEB</code> 访问</h4><ul>
<li>开启 <code>8081</code> 端口</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/sysconfig/iptables</div></pre></td></tr></table></figure>
<p>增加如下一条:</p>
<p><img src="/res/img/blog/环境搭建/iptables.png" alt="iptables"></p>
<ul>
<li>浏览器访问</li>
</ul>
<p>在浏览器中打开对应的URL 例如: <a href="http://10.140.22.205:8081" target="_blank" rel="external">http://10.140.22.205:8081</a>,默认管理员用户名和密码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">user: admin</div><div class="line">   pwd: admin123</div></pre></td></tr></table></figure>
<p><img src="/res/img/blog/环境搭建/maven.png" alt=""></p>
<p>默认<code>nexus</code>已经帮我们创建了五个库和两个组,我们可以直接使用,其中<code>Type</code>为<code>prosy</code>的为代理库,<code>Type</code>为<code>hosted</code>的为宿主库,<code>Type</code>为<code>group</code>的为组;</p>
<p>  一般用到的仓库种类是<code>hosted</code>、<code>proxy</code>。<code>Hosted</code>代表宿主仓库，用来发布一些第三方不允许的组件，比如<code>Oracle</code>驱动、比如商业软件<code>jar</code>包。<code>Proxy</code>代表代理远程的仓库，最典型的就是<code>Maven</code>官方中央仓库、<code>JBoss</code>仓库等等。如果构建的<code>Maven</code>项目本地仓库没有依赖包，那么就会去这个代理站点去下载，那么如果代理站点也没有此依赖包，就回去远程中央仓库下载依赖，这些中央仓库就是<code>proxy</code>。代理站点下载成功后再下载至本机。</p>
<h4 id="4-2-本地项目配置"><a href="#4-2-本地项目配置" class="headerlink" title="4.2 本地项目配置"></a>4.2 本地项目配置</h4><p>在项目的<code>pom.xml</code>或者<code>settings.xml</code>文件里加入一下配置信息（区别，<code>pom.xml</code>是针对当前项目，<code>settings.xml</code>是全局的针对所有项目）配置信息中的<code>id</code>,<code>name</code>和<code>url</code>跟上图中的仓库对应，<code>type</code>为<code>proxy</code>，说明它只是代理，只能用于下载<code>jar</code>包，不能用于发布项目。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>maven-central<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://10.140.22.205:8081/repository/maven-central/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">snapshotPolicy</span>&gt;</span>always<span class="tag">&lt;/<span class="name">snapshotPolicy</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></div></pre></td></tr></table></figure>
<p>其他使用可以<a href="https://segmentfault.com/a/1190000005966312" target="_blank" rel="external">参考这里</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS6升级GCC版本</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/20/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-04-20-CentOS6%E5%8D%87%E7%BA%A7GCC%E7%89%88%E6%9C%AC/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/20/环境搭建-2017-04-20-CentOS6升级GCC版本/</id>
    <published>2017-04-19T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-20</div><div class="line">版本 : 0.0.1</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="1-背景简述"><a href="#1-背景简述" class="headerlink" title="1. 背景简述"></a>1. 背景简述</h3><p><code>CentOS 6</code>系列的服务器,默认的gcc编译器都是 <code>4.4.7</code> 版本,有事后为了开发或者编译其他开源软件，则需要对gcc编译器进行升级;</p>
<h3 id="2-安装GCC前准备"><a href="#2-安装GCC前准备" class="headerlink" title="2. 安装GCC前准备"></a>2. 安装<code>GCC</code>前准备</h3><h4 id="2-1-下载指定版本"><a href="#2-1-下载指定版本" class="headerlink" title="2.1 下载指定版本"></a>2.1 下载指定版本</h4><p>首先在官网上面下载你需要的<code>GCC</code>版本,<a href="http://ftp.gnu.org/gnu/gcc" target="_blank" rel="external">官网在这里</a>,笔者选择的是<code>GCC 4.8.4</code>版本;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">   wget http://ftp.gnu.org/gnu/gcc/gcc-4.8.4/gcc-4.8.4.tar.gz</div></pre></td></tr></table></figure>
<h4 id="2-2-解压并进行准备工作"><a href="#2-2-解压并进行准备工作" class="headerlink" title="2.2 解压并进行准备工作"></a>2.2 解压并进行准备工作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar zxvf gcc-4.8.4.tar.gz</div></pre></td></tr></table></figure>
<h4 id="2-3-下载供编译需求的依赖项"><a href="#2-3-下载供编译需求的依赖项" class="headerlink" title="2.3 下载供编译需求的依赖项"></a>2.3 下载供编译需求的依赖项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/src/gcc-4.8.4/contrib/download_prerequisites</div></pre></td></tr></table></figure>
<h3 id="3-开始安装"><a href="#3-开始安装" class="headerlink" title="3. 开始安装"></a>3. 开始安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src/gcc-4.8.4</div><div class="line">   mkdir gcc-build</div><div class="line">   cd gcc-build</div><div class="line">   ../configure -enable-checking=release -enable-languages=c,c++ -disable-multilib</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make -j4</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo make install</div></pre></td></tr></table></figure>
<h3 id="4-配置环境"><a href="#4-配置环境" class="headerlink" title="4. 配置环境"></a>4. 配置环境</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cp /usr/local/lib64/libstdc++* /usr/lib64/</div><div class="line">   ln -s /usr/lib64/libstdc++.so /usr/lib64/libstdc++.so.6.0.19</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS6.8下安装Maven</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/14/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-04-14-CentOS6-8%E4%B8%8B%E5%AE%89%E8%A3%85Maven/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/14/环境搭建-2017-04-14-CentOS6-8下安装Maven/</id>
    <published>2017-04-13T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-13</div><div class="line">版本 : 0.0.4</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>[TOC]</p>
<h3 id="0-安装Maven前准备"><a href="#0-安装Maven前准备" class="headerlink" title="0. 安装Maven前准备"></a>0. 安装<code>Maven</code>前准备</h3><ul>
<li>确保系统已经安装了<code>Java</code>的运行环境;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 查看java版本，确保已经安装了java</div><div class="line">java -version</div></pre></td></tr></table></figure>
<p>终端输出如下内容说明已经安装了java，并且为 openJDK 系列的 <code>1.7.0_131</code> 版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@yafan2-xb src]# java -version</div><div class="line">java version &quot;1.7.0_131&quot;</div><div class="line">OpenJDK Runtime Environment (rhel-2.6.9.0.el6_8-x86_64 u131-b00)</div><div class="line">OpenJDK 64-Bit Server VM (build 24.131-b00, mixed mode)</div></pre></td></tr></table></figure>
<ul>
<li>确保系统已经配置了<code>JAVA_HOME</code>系统环境变量;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">env | grep JAVA_HOME</div><div class="line">   或者</div><div class="line">   echo $JAVA_HOME</div></pre></td></tr></table></figure>
<p>若是终端没有输出对应的值，则说明系统是没有配置<code>JAVA_HOME</code>环境变量的;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 查找 java 路径, 笔者电脑输出 /usr/bin/java</div><div class="line">which java</div><div class="line">   </div><div class="line">   # 查找 java 的真实路径 笔者电脑输出 /usr/bin/java -&gt; /etc/alternatives/java</div><div class="line">   ls -alh /usr/bin/java</div><div class="line">   </div><div class="line">   # 继续查找 java 的真实路径 笔者电脑输出 /etc/alternatives/java -&gt; /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java</div><div class="line">   ls -alh /etc/alternatives/java</div></pre></td></tr></table></figure>
<p>经过上一步找到了 <code>java</code> 的在当前系统中的真实可执行目录，按照如下方式配置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/profile</div></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">export JAVA_HOME=/usr/lib/jvm/jre-1.7.0-openjdk.x86_64</div><div class="line">export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div><div class="line">export PATH=$PATH:$JAVA_HOME/bin</div></pre></td></tr></table></figure>
<p>使新的环境变量生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /etc/profile</div></pre></td></tr></table></figure>
<h3 id="1-安装maven环境"><a href="#1-安装maven环境" class="headerlink" title="1.安装maven环境"></a>1.安装<code>maven</code>环境</h3><ul>
<li>下载<code>maven</code>二进制包</li>
</ul>
<p><code>maven</code>的官方下载地址<a href="Maven的下载地址是：http://maven.apache.org/download.cgi">在这里</a> 。 <strong>PS:</strong> 建议在下载时选择一个比较快的源,笔者选择的是清华大学的源,下载速度在 400K左右;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">   wget http://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.5.0/binaries/apache-maven-3.5.0-bin.tar.gz</div></pre></td></tr></table></figure>
<ul>
<li>解压并配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tar zxf apache-maven-3.5.0-bin.tar.gz</div><div class="line">mv apache-maven-3.5.0 /usr/local/maven3</div></pre></td></tr></table></figure>
<ul>
<li>配置环境变量(/etc/profile)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#在适当的位置添加</div><div class="line">export M2_HOME=/usr/local/maven3</div><div class="line">export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/bin</div></pre></td></tr></table></figure>
<p>使环境变量生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /etc/profile</div></pre></td></tr></table></figure>
<ul>
<li>验证版本</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn -v</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS下搭建GitLab服务器</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/04/13/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2014-10-17-Ubuntu14-04%E4%B8%8B%E9%85%8D%E7%BD%AEGitLab7/"/>
    <id>http://daodaoliang.com/环境搭建/2017/04/13/环境搭建-2014-10-17-Ubuntu14-04下配置GitLab7/</id>
    <published>2017-04-12T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">作者 : daodaoliang@yeah.net</div><div class="line">日期 : 2017-04-13</div><div class="line">版本 : 0.0.4</div></pre></td></tr></table></figure>
<a id="more"></a>
<hr>
<ul>
<li>TOC<br>{:toc}</li>
</ul>
<hr>
<h3 id="0-Gitlab-简介"><a href="#0-Gitlab-简介" class="headerlink" title="0 Gitlab 简介"></a>0 <code>Gitlab</code> 简介</h3><p>GitLab 是一个用于仓库管理系统的开源项目。使用Git作为代码管理工具，并在此基础上搭建起来的web服务。可通过Web界面进行访问公开的或者私人项目。它拥有与Github类似的功能，能够浏览源代码，管理缺陷和注释。可以管理团队对仓库的访问，它非常易于浏览提交过的版本并提供一个文件历史库。团队成员可以利用内置的简单聊天程序(Wall)进行交流。它还提供一个代码片段收集功能可以轻松实现代码复用。</p>
<hr>
<h3 id="1-Gitlab-的安装"><a href="#1-Gitlab-的安装" class="headerlink" title="1. Gitlab 的安装"></a>1. <code>Gitlab</code> 的安装</h3><p><code>Gitlab</code> 有两种安装方式:</p>
<table>
<thead>
<tr>
<th style="text-align:center">安装方式</th>
<th style="text-align:center">简介</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">源码方式安装</td>
<td style="text-align:center">这个有些费劲,时间充足喜欢折腾按照<a href="https://docs.gitlab.com.cn/ce/install/README.html" target="_blank" rel="external">链接文档</a>安装即可</td>
</tr>
<tr>
<td style="text-align:center"><code>Omnibus</code>方式安装</td>
<td style="text-align:center">这个简单,不出任何意外大约一个半小时左右安装完毕</td>
</tr>
</tbody>
</table>
<h3 id="1-1-采用-Omnibus-方式"><a href="#1-1-采用-Omnibus-方式" class="headerlink" title="1.1 采用 Omnibus 方式"></a>1.1 采用 <code>Omnibus</code> 方式</h3><p>根据<a href="https://www.gitlab.com.cn/downloads" target="_blank" rel="external">官网地址</a>，选择 <code>CentOS 6</code> 然后执行相应命令，即可完成安装操作，如果你用虚拟机，就直接用迅雷搞定，然后再拖进去吧，毕竟<code>200+M</code>,<a href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/" target="_blank" rel="external">下载连接在这里</a></p>
<p>如果你不想观看官网那么跟着下面步骤走：</p>
<h4 id="1-1-1-安装配置依赖项"><a href="#1-1-1-安装配置依赖项" class="headerlink" title="1.1.1 安装配置依赖项"></a>1.1.1 安装配置依赖项</h4><p>如想使用Postfix来发送邮件,在安装期间请选择’Internet Site’. 您也可以用sendmai或者 配置SMTP服务 并 使用SMTP发送邮件.在 Centos 6 和 7 系统上, 下面的命令将在系统防火墙里面开放HTTP和SSH端口.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo yum install curl openssh-server openssh-clients postfix cronie</div><div class="line">sudo service postfix start</div><div class="line">sudo chkconfig postfix on</div><div class="line">sudo lokkit -s http -s ssh</div></pre></td></tr></table></figure>
<h4 id="1-1-2-添加GitLab仓库-并安装到服务器上"><a href="#1-1-2-添加GitLab仓库-并安装到服务器上" class="headerlink" title="1.1.2 添加GitLab仓库,并安装到服务器上"></a>1.1.2 添加GitLab仓库,并安装到服务器上</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash</div><div class="line">sudo yum install gitlab-ce</div></pre></td></tr></table></figure>
<h4 id="1-1-3-启动-Gitlab"><a href="#1-1-3-启动-Gitlab" class="headerlink" title="1.1.3 启动 Gitlab"></a>1.1.3 启动 <code>Gitlab</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gitlab-ctl reconfigure</div></pre></td></tr></table></figure>
<hr>
<h3 id="2-邮箱配置"><a href="#2-邮箱配置" class="headerlink" title="2.邮箱配置"></a>2.邮箱配置</h3><p>当你按照提示安装好后，基本上就可以使用了，但是在使用的过程中，我们发现邮件通知功能不稳定，使用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /var/<span class="built_in">log</span>/mail.log</div></pre></td></tr></table></figure>
<p>查看后发现，邮件被当成了垃圾邮件，被退信了。<br>使用默认<code>Gitlab</code>的邮件服务的话，貌似被退信的几率比较高，因此我们需修改一下，毕竟邮件通知还是很重要的。我们注册一个邮箱账号，让<code>GitLab</code>通过该账号向我们发送邮件通知，这看起来就像两个人正常通信了，基本上就不会被退信了。</p>
<h4 id="2-1-注册邮箱"><a href="#2-1-注册邮箱" class="headerlink" title="2.1 注册邮箱"></a>2.1 注册邮箱</h4><p>注册QQ企业云邮箱不解释，记住用户名密码即可，你也可以随便使用其他邮箱服务器，不过不建议网易家的，他们会出现一些安全方面的拦截。</p>
<h4 id="2-2-配置邮箱"><a href="#2-2-配置邮箱" class="headerlink" title="2.2 配置邮箱"></a>2.2 配置邮箱</h4><p>修改发送邮件步骤如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/gitlab/gitlab.rb</div></pre></td></tr></table></figure>
<p>增加如下配置项，例:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">gitlab_rails['smtp_enable'] = true</div><div class="line">gitlab_rails['smtp_address'] = "smtp.exmail.qq.com"</div><div class="line">gitlab_rails['smtp_port'] = 465</div><div class="line">gitlab_rails['smtp_user_name'] = "youraccount"</div><div class="line">gitlab_rails['smtp_password'] = "yourPWD"</div><div class="line">gitlab_rails['smtp_authentication'] = "login"</div><div class="line">gitlab_rails['smtp_enable_starttls_auto'] = true</div><div class="line">gitlab_rails['smtp_tls'] = true</div><div class="line">gitlab_rails['gitlab_email_from'] = 'youraccount'</div></pre></td></tr></table></figure>
<p>修改完成后，需要执行以下命令使生效:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gitlab-ctl reconfigure.</div></pre></td></tr></table></figure>
<h4 id="2-3-测试邮箱"><a href="#2-3-测试邮箱" class="headerlink" title="2.3 测试邮箱"></a>2.3 测试邮箱</h4><ol>
<li>执行 gitlab-rails console</li>
<li>在上面步骤后执行：</li>
</ol>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Notify.test_email(<span class="string">'destination_email@address.com'</span>, <span class="string">'Message Subject'</span>, <span class="string">'Message Body'</span>).deliver_now</div></pre></td></tr></table></figure>
<p><strong>PS:</strong> 具体其他的请参考<a href="http://docs.gitlab.com/omnibus/settings/smtp.html" target="_blank" rel="external">这篇文档</a></p>
<h3 id="4-Gitlab-运维"><a href="#4-Gitlab-运维" class="headerlink" title="4. Gitlab 运维"></a>4. <code>Gitlab</code> 运维</h3><p>具体运维请参考<a href="https://docs.gitlab.com.cn/ce/README.html" target="_blank" rel="external">这篇文档</a></p>
<h4 id="4-1-管理"><a href="#4-1-管理" class="headerlink" title="4.1 管理"></a>4.1 管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 启动所有 gitlab 组件：</div><div class="line">sudo gitlab-ctl start</div><div class="line"></div><div class="line"># 停止所有 gitlab 组件：</div><div class="line">sudo gitlab-ctl stop</div><div class="line"></div><div class="line"># 重启所有 gitlab 组件：</div><div class="line">sudo gitlab-ctl restart</div></pre></td></tr></table></figure>
<h4 id="4-2-备份"><a href="#4-2-备份" class="headerlink" title="4.2 备份"></a>4.2 备份</h4><p>备份GitLab repositories and GitLab metadata</p>
<p>在 crontab 中加入如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 2 * * * /usr/bin/gitlab-rake gitlab:backup:create</div></pre></td></tr></table></figure>
<h4 id="4-3-恢复"><a href="#4-3-恢复" class="headerlink" title="4.3 恢复"></a>4.3 恢复</h4><p>首先进入备份 gitlab 的目录，这个目录是配置文件中的<code>gitlab_rails[&#39;backup_path&#39;]</code> ，默认为 <code>/var/opt/gitlab/backups</code> 。</p>
<p>然后停止 <code>unicorn 和 sidekiq</code> ，保证数据库没有新的连接，不会有写数据情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo gitlab-ctl stop unicorn</div><div class="line"># ok: down: unicorn: 0s, normally up</div><div class="line">sudo gitlab-ctl stop sidekiq</div><div class="line"># ok: down: sidekiq: 0s, normally up</div></pre></td></tr></table></figure>
<p>然后恢复数据，1406691018为备份文件的时间戳</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gitlab-rake gitlab:backup:restore BACKUP=1406691018</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;作者 : daodaoliang@yeah.net&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;日期 : 2017-04-13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;版本 : 0.0.4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>windows脚本UAC获取</title>
    <link href="http://daodaoliang.com/windows%E5%AD%A6%E4%B9%A0/2017/04/12/windows%E5%AD%A6%E4%B9%A0-2017-04-12-windowsUAC/"/>
    <id>http://daodaoliang.com/windows学习/2017/04/12/windows学习-2017-04-12-windowsUAC/</id>
    <published>2017-04-11T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">auther  =  <span class="string">'daodaoliang'</span></div><div class="line">version =  <span class="string">'V 0.0.1'</span></div><div class="line">date    =  <span class="string">'2017年04月12日'</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<hr>
<p>常用的windows下面的脚本，首先判断用户的管理员权限，而后进行<code>sc</code>的服务操作;</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">echo <span class="keyword">off</span></div><div class="line">cls</div><div class="line">:-------------------------------------</div><div class="line"><span class="keyword">REM</span>  --&gt; Check <span class="keyword">for</span> permissions</div><div class="line">&gt;nul <span class="number">2</span>&gt;&amp;<span class="number">1</span> <span class="string">"%SYSTEMROOT%\system32\cacls.exe"</span> <span class="string">"%SYSTEMROOT%\system32\config\system"</span></div><div class="line"><span class="keyword">REM</span> --&gt; <span class="keyword">If</span> <span class="keyword">error</span> flag <span class="keyword">set</span>, we <span class="keyword">do</span> <span class="keyword">not</span> have admin.</div><div class="line"><span class="keyword">if</span> <span class="comment">'%errorlevel%' NEQ '0' (</span></div><div class="line">    echo Requesting administrative privileges...</div><div class="line">    <span class="keyword">goto</span> UACPrompt</div><div class="line">) <span class="keyword">else</span> ( <span class="keyword">goto</span> gotAdmin )</div><div class="line"></div><div class="line">:UACPrompt</div><div class="line">    echo <span class="keyword">Set</span> UAC = CreateObject^(<span class="string">"Shell.Application"</span>^) &gt; <span class="string">"%temp%\getadmin.vbs"</span></div><div class="line">    <span class="keyword">set</span> params = %*:<span class="string">"="</span><span class="string">"</span></div><div class="line"><span class="string">    echo UAC.ShellExecute "</span>cmd.exe<span class="string">", "</span>/c %~s0 %params%<span class="string">", "</span><span class="string">", "</span>runas<span class="string">", 1 &gt;&gt; "</span>%temp%\getadmin.vbs<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">    "</span>%temp%\getadmin.vbs<span class="string">"</span></div><div class="line"><span class="string">    del "</span>%temp%\getadmin.vbs<span class="string">"</span></div><div class="line"><span class="string">    exit /B</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">:gotAdmin</span></div><div class="line"><span class="string">    pushd "</span>%CD%<span class="string">"</span></div><div class="line"><span class="string">    CD /D "</span>%~dp0<span class="string">"</span></div><div class="line"><span class="string">:--------------------------------------</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">echo --- Logger Service Installer ---</span></div><div class="line"><span class="string">set /p servicename=Service name :</span></div><div class="line"><span class="string">echo Options:</span></div><div class="line"><span class="string">echo 1. Install</span></div><div class="line"><span class="string">echo 2. Start</span></div><div class="line"><span class="string">echo 3. Stop </span></div><div class="line"><span class="string">echo 4. Remove</span></div><div class="line"><span class="string">echo 5. Exit</span></div><div class="line"><span class="string">:CASE_init</span></div><div class="line"><span class="string">SET /P option="</span><span class="keyword">Option</span>: <span class="string">"</span></div><div class="line"><span class="string">2&gt;NUL CALL :CASE_%option% # jump to :CASE_1, :CASE_2, CASE_3, CASE_4, CASE_5</span></div><div class="line"><span class="string">IF ERRORLEVEL 1 CALL :DEFAULT_CASE # if label doesn't exist</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">ECHO Done.</span></div><div class="line"><span class="string">EXIT /B</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">:CASE_1</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">sc create %servicename% binPath= "</span>yourpath/app.exe<span class="string">"</span></div><div class="line"><span class="string">GOTO CASE_init</span></div><div class="line"><span class="string">:CASE_2</span></div><div class="line"><span class="string">sc start %servicename%</span></div><div class="line"><span class="string">GOTO CASE_init</span></div><div class="line"><span class="string">:CASE_3</span></div><div class="line"><span class="string">sc stop %servicename%</span></div><div class="line"><span class="string">GOTO CASE_init</span></div><div class="line"><span class="string">:CASE_4</span></div><div class="line"><span class="string">sc delete %servicename%</span></div><div class="line"><span class="string">GOTO CASE_init</span></div><div class="line"><span class="string">:CASE_5</span></div><div class="line"><span class="string">GOTO END_CASE</span></div><div class="line"><span class="string">:DEFAULT_CASE</span></div><div class="line"><span class="string">ECHO Unknown option %option%</span></div><div class="line"><span class="string">GOTO CASE_init</span></div><div class="line"><span class="string">:END_CASE</span></div><div class="line"><span class="string">pause</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;auther  =  &lt;span class=&quot;string&quot;&gt;&#39;daodaoliang&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;version =  &lt;span class=&quot;string&quot;&gt;&#39;V 0.0.1&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;date    =  &lt;span class=&quot;string&quot;&gt;&#39;2017年04月12日&#39;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="windows学习" scheme="http://daodaoliang.com/categories/windows%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>windows下服务程序相关</title>
    <link href="http://daodaoliang.com/windows%E5%AD%A6%E4%B9%A0/2017/04/12/windows%E5%AD%A6%E4%B9%A0-2017-04-12-windows%E4%B8%8B%E9%9D%A2%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E7%9B%B8%E5%85%B3/"/>
    <id>http://daodaoliang.com/windows学习/2017/04/12/windows学习-2017-04-12-windows下面服务程序相关/</id>
    <published>2017-04-11T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年11月25日
</code></pre><a id="more"></a>
<hr>
<h3 id="1-Windows-Service-编程实现"><a href="#1-Windows-Service-编程实现" class="headerlink" title="1. Windows Service 编程实现"></a>1. <code>Windows Service</code> 编程实现</h3><p>在windows平台下面编写 服务程序 免不了要去查看微软的开发者文档，相关的介绍在<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686953(v=vs.85).aspx" target="_blank" rel="external">这里</a>, 多了也就不在罗嗦了,如果你嫌弃直接用他们的<code>API</code>的话,可以使用别人已经封装好的，比如:</p>
<table>
<thead>
<tr>
<th style="text-align:center">参考代码</th>
<th style="text-align:center">连接</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/magicsih/WindowsService" target="_blank" rel="external">参考代码001</a></td>
<td style="text-align:center"><a href="https://github.com/magicsih/WindowsService" target="_blank" rel="external">https://github.com/magicsih/WindowsService</a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/Olster/windows_service" target="_blank" rel="external">参考代码002</a></td>
<td style="text-align:center"><a href="https://github.com/Olster/windows_service" target="_blank" rel="external">https://github.com/Olster/windows_service</a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/Kingston1/windows-service" target="_blank" rel="external">参考代码003</a></td>
<td style="text-align:center"><a href="https://github.com/Kingston1/windows-service" target="_blank" rel="external">https://github.com/Kingston1/windows-service</a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/horigome/sylph" target="_blank" rel="external">参考代码004</a></td>
<td style="text-align:center"><a href="https://github.com/horigome/sylph" target="_blank" rel="external">https://github.com/horigome/sylph</a></td>
</tr>
</tbody>
</table>
<h3 id="2-采用第三方封装的SCP"><a href="#2-采用第三方封装的SCP" class="headerlink" title="2. 采用第三方封装的SCP"></a>2. 采用第三方封装的SCP</h3><h3 id="2-1-nssm-Non-Sucking-Service-Manager"><a href="#2-1-nssm-Non-Sucking-Service-Manager" class="headerlink" title="2.1 nssm (Non-Sucking Service Manager)"></a>2.1 <code>nssm</code> (Non-Sucking Service Manager)</h3><ul>
<li><p>编译或者下载<code>nssm</code></p>
<p>  <a href="http://nssm.cc/download" target="_blank" rel="external">下载连接在这里</a>,一定要注意系统位数的区别，32位和64位;</p>
</li>
<li><p>使用方式</p>
</li>
</ul>
<p><img src="/res/img/blog/windows/nssm.png" alt="methods"></p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年11月25日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="windows学习" scheme="http://daodaoliang.com/categories/windows%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>最为常用的HASH算法</title>
    <link href="http://daodaoliang.com/c-%E5%AD%A6%E4%B9%A0/2017/03/08/c-%E5%AD%A6%E4%B9%A0-2017-03-08-HashAlgorithm/"/>
    <id>http://daodaoliang.com/c-学习/2017/03/08/c-学习-2017-03-08-HashAlgorithm/</id>
    <published>2017-03-07T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.842Z</updated>
    
    <content type="html"><![CDATA[<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年03月08日
</code></pre><p> murmurhash2算法 和 DJB Hash算法是目前最流行的hash算法</p>
<a id="more"></a>
<h3 id="1-DJB-HASH算法"><a href="#1-DJB-HASH算法" class="headerlink" title="1.DJB HASH算法"></a>1.DJB HASH算法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* the famous DJB Hash Function for strings */</span></div><div class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">DJBHash</span><span class="params">(<span class="keyword">char</span> *str)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> hash = <span class="number">5381</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (*str)&#123;</div><div class="line">       hash = ((hash &lt;&lt; <span class="number">5</span>) + hash) + (*str++); <span class="comment">/* times 33 */</span></div><div class="line">    &#125;</div><div class="line">    hash &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">31</span>); <span class="comment">/* strip the highest bit */</span></div><div class="line">    <span class="keyword">return</span> hash;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="2-murmurhash2"><a href="#2-murmurhash2" class="headerlink" title="2.murmurhash2"></a>2.murmurhash2</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uint32_t</span></div><div class="line">murmur_hash2(<span class="keyword">char</span> *data, <span class="keyword">size_t</span> len)</div><div class="line">&#123;  </div><div class="line">    <span class="keyword">uint32_t</span>  h, k;</div><div class="line">  </div><div class="line">    h = <span class="number">0</span> ^ len;</div><div class="line">  </div><div class="line">    <span class="keyword">while</span> (len &gt;= <span class="number">4</span>) &#123;</div><div class="line">        k  = data[<span class="number">0</span>];</div><div class="line">        k |= data[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>;</div><div class="line">        k |= data[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>;</div><div class="line">        k |= data[<span class="number">3</span>] &lt;&lt; <span class="number">24</span>;</div><div class="line">  </div><div class="line">        k *= <span class="number">0x5bd1e995</span>;</div><div class="line">        k ^= k &gt;&gt; <span class="number">24</span>;</div><div class="line">        k *= <span class="number">0x5bd1e995</span>;</div><div class="line"></div><div class="line">        h *= <span class="number">0x5bd1e995</span>;</div><div class="line">        h ^= k;</div><div class="line"></div><div class="line">        data += <span class="number">4</span>;</div><div class="line">        len -= <span class="number">4</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">switch</span> (len) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">        h ^= data[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>;</div><div class="line">    <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">        h ^= data[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>;</div><div class="line">    <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">        h ^= data[<span class="number">0</span>];</div><div class="line">        h *= <span class="number">0x5bd1e995</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    h ^= h &gt;&gt; <span class="number">13</span>;</div><div class="line">    h *= <span class="number">0x5bd1e995</span>;</div><div class="line">    h ^= h &gt;&gt; <span class="number">15</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> h;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年03月08日
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; murmurhash2算法 和 DJB Hash算法是目前最流行的hash算法&lt;/p&gt;
    
    </summary>
    
      <category term="c++学习" scheme="http://daodaoliang.com/categories/c-%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS6.5下升级NodeJs</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2017/02/17/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2017-02-17-CentOS%E4%B8%8B%E5%8D%87%E7%BA%A7NodeJs/"/>
    <id>http://daodaoliang.com/环境搭建/2017/02/17/环境搭建-2017-02-17-CentOS下升级NodeJs/</id>
    <published>2017-02-16T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 1.0.1
邮箱：daodaoliang@yeah.net
</code></pre><a id="more"></a>
<p>  <code>NodeJs</code> 是什么就不在赘述，可一直接参考<a href="https://nodejs.org/en/" target="_blank" rel="external">英文官网</a>，或者<a href="http://nodejs.cn/" target="_blank" rel="external">中文官网</a>，在项目中进行应用时，有时候需要用到最新版本的特性，但是CentOS系统为了稳定性，默认的源都是在该版本的操作系统发布时或者更新时的最稳定版本，所以仅仅是采用<code>yum update</code> 的操作是不能进行对应升级的。<br>  所以下面采用两种方式来进行在线升级。</p>
<h3 id="0x01-用-n-模块来进行-nodejs-升级"><a href="#0x01-用-n-模块来进行-nodejs-升级" class="headerlink" title="0x01 用 n 模块来进行 nodejs 升级"></a>0x01 用 <code>n</code> 模块来进行 <code>nodejs</code> 升级</h3><p>  在 <code>NodeJs</code> 中有一个模块叫做 <code>n</code> 专门用来管理 <code>NodeJs</code> 的版本。</p>
<ul>
<li><p>首先下载安装模块 <code>n</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g n</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>升级<code>NodeJs</code>到最新版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n stable</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>升级<code>NodeJs</code>到指定版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n 0.10.23</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="0x04-用编译好的二进制文件进行安装更新"><a href="#0x04-用编译好的二进制文件进行安装更新" class="headerlink" title="0x04 用编译好的二进制文件进行安装更新"></a>0x04 用编译好的二进制文件进行安装更新</h3><p>  在官网下载相关系统平台下面编译好的二进制包。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd node-v0.10.28-linux-x64/bin</div><div class="line">ls</div><div class="line">./node -v</div></pre></td></tr></table></figure>
<p>  上面的二进制文件就是编译好的新版本的<code>node</code>文件，不过并没有添加到环境变量里面，所以可以通过下面这种方式进行设置为全局变量</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ln -s /home/kun/mysofltware/node-v0.10.28-linux-x64/bin/node /usr/local/bin/node</div><div class="line">ln -s /home/kun/mysofltware/node-v0.10.28-linux-x64/bin/npm /usr/local/bin/npm</div></pre></td></tr></table></figure>
<h3 id="0x03-用源码的方式进行编译安装"><a href="#0x03-用源码的方式进行编译安装" class="headerlink" title="0x03 用源码的方式进行编译安装"></a>0x03 用源码的方式进行编译安装</h3><p>一般用方式一就可以完成升级安装，但是有时候会出现一些莫名其妙的错误，比如说是<code>segment fault</code>之类的错误，这个时候我只能用源码的方式进行编译安装。</p>
<p>首先<code>NodeJs</code>使用<code>C++</code>语言编写的，所以在编译源码时需要用到gcc-g++编译器，目前最新的<code>NodeJs</code>代码用到了<code>c11</code>的一些特性，所以对编译器的版本要求在4.8+所以首先要对编译器进行安装和升级。</p>
<ul>
<li><p>安装并升级编译器到4.8+</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">yum install gcc-c++ openssl-devel</div><div class="line">wget http://people.centos.org/tru/devtools-2/devtools-2.repo</div><div class="line">mv devtools-2.repo /etc/yum.repos.d</div><div class="line">yum install devtoolset-2-gcc devtoolset-2-binutils devtoolset-2-gcc-c++</div></pre></td></tr></table></figure>
</li>
</ul>
<p> 三个安装包被安装在<code>/opt/rh/devtoolset-2/root/</code>中</p>
<p> 更新软连接:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mv /usr/bin/gcc /usr/bin/gcc-4.4.7 </div><div class="line">mv /usr/bin/g++ /usr/bin/g++-4.4.7 </div><div class="line">mv /usr/bin/c++ /usr/bin/c++-4.4.7 </div><div class="line">ln -s /opt/rh/devtoolset-2/root/usr/bin/gcc /usr/bin/gcc </div><div class="line">ln -s /opt/rh/devtoolset-2/root/usr/bin/c++ /usr/bin/c++ </div><div class="line">ln -s /opt/rh/devtoolset-2/root/usr/bin/g++ /usr/bin/g++ </div><div class="line">gcc --version</div></pre></td></tr></table></figure>
<ul>
<li><p>检查核对<code>python</code>版本</p>
<p><code>nodejs</code>需要python版本在2.6版本以上，我们需要检查版本是否对应符合，如果不符合那就进行一下升级；</p>
</li>
<li><p>编译安装最新版本的<code>nodejs</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">wget http://nodejs.org/dist/node-latest.tar.gz</div><div class="line">tar -zxvf node-latest.tar.gz</div><div class="line">cd node-v0.12.7</div><div class="line">./configure</div><div class="line">make &amp;&amp; make install</div></pre></td></tr></table></figure>
</li>
</ul>
<p> 不管是用哪种方式进行升级都需要很长的时间，休息一会等着就好了，升级完成后查看一下版本信息；</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node -v</div></pre></td></tr></table></figure>
<p> <strong>PS:</strong> 在升级的过程中把<code>node</code> 运行的相关程序要关闭，不然会在编译时由于文件占用的关系产生错误.</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 1.0.1
邮箱：daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>linux内核漫画(转载)</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2017/02/06/linux%E5%AD%A6%E4%B9%A0-2017-02-06-linux%E5%86%85%E6%A0%B8%E6%BC%AB%E7%94%BB/"/>
    <id>http://daodaoliang.com/linux学习/2017/02/06/linux学习-2017-02-06-linux内核漫画/</id>
    <published>2017-02-05T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月06日
</code></pre><p>网络上看到的觉得很形象就转载过来啦，伟大的Linux内核漫画化。</p>
<a id="more"></a>
<p><img src="/res/img/blog/linux学习/linux.jpeg" alt="linux 内核漫画"></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月06日
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;网络上看到的觉得很形象就转载过来啦，伟大的Linux内核漫画化。&lt;/p&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>linux下C++的编译过程</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2017/02/01/c-%E5%AD%A6%E4%B9%A0-2017-02-14-linux%E4%B8%8BC-%E7%9A%84%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B/"/>
    <id>http://daodaoliang.com/linux学习/2017/02/01/c-学习-2017-02-14-linux下C-的编译过程/</id>
    <published>2017-01-31T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.842Z</updated>
    
    <content type="html"><![CDATA[<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月01日
</code></pre><a id="more"></a>
<p>在linux下面c++程序从源码变成用户触手可用的可执行程序通常分为配置、编译和安装，具体的过程和描述如下.</p>
<h3 id="0x01-配置阶段-Configure"><a href="#0x01-配置阶段-Configure" class="headerlink" title="0x01 配置阶段(Configure)"></a>0x01 配置阶段(Configure)</h3><p>  一个生产环境的系统一般都是需要调用一些系统提供的功能库和一些其他功能库，由于系统环境的不同编译器需要知道系统库存在哪里，软件编译完成后安装在哪里，需要安装那些第三方组件等等，同时工程项目的文件也存在相互的引用和依赖关系，所有这些都需要在<code>configure</code>阶段解决。配置阶段完成以后会产生<code>makefile</code>文件。</p>
<h3 id="0x02-编译阶段-Make"><a href="#0x02-编译阶段-Make" class="headerlink" title="0x02 编译阶段(Make)"></a>0x02 编译阶段(Make)</h3><p>  编译阶段的就是把程序工程文件从人类可读经过处理后变成机器可执行的二进制指令码的过程，对于linux 下面 gcc 编译器来说一般是预处理、编译、汇编和链接。</p>
<h4 id="0x021-预处理-Preprocessing"><a href="#0x021-预处理-Preprocessing" class="headerlink" title="0x021 预处理(Preprocessing)"></a>0x021 预处理(Preprocessing)</h4><p>  预处理后的文件一般为<code>.i</code>结尾，这个过程一般包含以下几个子过程:</p>
<ul>
<li>展开宏定义，删除所有<code>#define</code>；</li>
<li>处理所有的条件预编译指令，<code>#if #ifdef #elif #else #endif</code> 等；</li>
<li>处理<code>#include</code>预编译指令，将被包含的文件插入到该预编译指令的位置；</li>
<li>删除所有的注释；</li>
<li>添加行号和文件标识，以便在编译时产生调试用的行号，以及编译错误的警告行号；</li>
<li><p>保留所有的<code>#pragma</code> 编译器指令，在编译阶段编译器需要使用；</p>
<p>通常如果只进行预处理的话一般用如下命令:</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -E hello.c -o hello.i</div></pre></td></tr></table></figure>
<h4 id="0x022-编译-Compilation"><a href="#0x022-编译-Compilation" class="headerlink" title="0x022 编译(Compilation)"></a>0x022 编译(Compilation)</h4><p>  编译的过程就是把工程文件进行一系列的词法分析、语法分析、语义分析、以及优化后生成相关的汇编代码；</p>
<p>  通常如果只进行编译处理的一般用如下命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -S hello.i -o hello.s</div></pre></td></tr></table></figure>
<h4 id="0x023-汇编-Assembly"><a href="#0x023-汇编-Assembly" class="headerlink" title="0x023 汇编(Assembly)"></a>0x023 汇编(Assembly)</h4><p>汇编器是将汇编代码转换成机器码</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -c hello.c -o hello.o</div></pre></td></tr></table></figure>
<p>  或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">as hello.s -o hello.o</div></pre></td></tr></table></figure>
<h4 id="0x024-连接-Linking"><a href="#0x024-连接-Linking" class="headerlink" title="0x024 连接(Linking)"></a>0x024 连接(Linking)</h4><p>链接的主要作用就是把各个二进制中间文件链接起来生成一个可执行的二进制文件，链接分为动态链接和静态连接:</p>
<ul>
<li>动态链接：链接阶段仅仅加入一些描述信息，而程序执行时再从系统中把相应的动态库加载到内存中。</li>
</ul>
<p><img src="/res/img/blog/c++/linking.jpg" alt="linux-C++编译过程"></p>
<h3 id="0x03-安装阶段-make-install"><a href="#0x03-安装阶段-make-install" class="headerlink" title="0x03 安装阶段(make install)"></a>0x03 安装阶段(make install)</h3><p>编译的整个过程都是在内存中进行，编译出来的二进制可执行文件也是存在编译时指定的位置，下一步就是将可执行文件安装到用户指定目录并做好善后工作，这其中包含，创建对应的目录，保存文件，设置权限等步骤；同时程序安装完成后也需要还需要进行操作系统的关联，创建快捷方式和做文件关联等等个性化需求。</p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2017年02月01日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="c++" scheme="http://daodaoliang.com/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>ssh超时时间设置</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2016/12/29/linux%E5%AD%A6%E4%B9%A0-2016-12-29-ssh%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4%E8%AE%BE%E7%BD%AE/"/>
    <id>http://daodaoliang.com/linux学习/2016/12/29/linux学习-2016-12-29-ssh超时时间设置/</id>
    <published>2016-12-28T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2016年12月29日
</code></pre><a id="more"></a>
<hr>
<h4 id="0x00-OpenSSH-简介"><a href="#0x00-OpenSSH-简介" class="headerlink" title="0x00 OpenSSH 简介"></a>0x00 OpenSSH 简介</h4><p><a href="http://www.openssh.com/" target="_blank" rel="external">OpenSSH</a>是采用SSH协议实现的重要的远程连接工具，它对所有的数据进行加密以防止被中途窃听，<a href="http://www.openssh.com/" target="_blank" rel="external">OpenSSH</a>提供了大量的安全通道的组件，比如：</p>
<ol>
<li>远程操作用<a href="http://man.openbsd.org/?query=ssh&amp;sektion=1" target="_blank" rel="external">ssh</a>、<a href="http://man.openbsd.org/?query=scp&amp;sektion=1" target="_blank" rel="external">scp</a>、<a href="http://man.openbsd.org/?query=sftp&amp;sektion=1" target="_blank" rel="external">sftp</a>;</li>
<li>秘钥管理用<a href="http://man.openbsd.org/?query=ssh-add&amp;sektion=1" target="_blank" rel="external">ssh-add</a>、<a href="http://man.openbsd.org/?query=ssh-keysign&amp;sektion=8" target="_blank" rel="external">ssh-keysign</a>、<a href="http://man.openbsd.org/?query=ssh-keyscan&amp;sektion=1" target="_blank" rel="external">ssh-keyscan</a>、<a href="http://man.openbsd.org/?query=ssh-keygen&amp;sektion=1" target="_blank" rel="external">ssh-keygen</a>;</li>
<li>服务端包含<a href="http://man.openbsd.org/?query=sshd&amp;sektion=8" target="_blank" rel="external">sshd</a>、<a href="http://man.openbsd.org/?query=sftp-server&amp;sektion=8" target="_blank" rel="external">sftp-server</a>、<a href="http://man.openbsd.org/?query=ssh-agent&amp;sektion=1" target="_blank" rel="external">ssh-agent</a>;</li>
</ol>
<h4 id="0x01-方案一"><a href="#0x01-方案一" class="headerlink" title="0x01 方案一"></a>0x01 方案一</h4><p>上面的所有信息可以自行去对应官网链接进行进一步的学习，在下面只讨论对于sshd的超时连接的问题。</p>
<ol>
<li>修改server端的配置文件<code>/etc/ssh/sshd_config</code></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># server每隔60秒给客户端发送一次保活信息包给客户端</span></div><div class="line">ClientAliveInterval 60</div><div class="line"></div><div class="line"><span class="comment"># server端发出的请求客户端没有回应的次数达到86400次的时候就断开连接，正常情况下客户端都会相应</span></div><div class="line">ClientAliveCountMax 86400</div></pre></td></tr></table></figure>
<ol>
<li>修改client端的配置文件<code>/etc/ssh/ssh_config</code></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># client 每隔60秒给客户端发送一次保活信息包给客户端</span></div><div class="line">ServerAliveInterval 60</div><div class="line"></div><div class="line"><span class="comment"># client 端发出的请求服务端没有回应的次数达到86400次的时候就断开连接，正常情况下服务端都会相应</span></div><div class="line">ServerAliveCountMax 86400</div></pre></td></tr></table></figure>
<h4 id="0x02-方案二"><a href="#0x02-方案二" class="headerlink" title="0x02 方案二"></a>0x02 方案二</h4><p>在命令参数里</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">ssh -o ServerAliveInterval=60</div></pre></td></tr></table></figure>
<p>这样子只会在需要的连接中保持持久连接，具体的参数请<a href="http://man.openbsd.org/sshd_config.5" target="_blank" rel="external">参考这里</a>。</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2016年12月29日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>windows下获取系统信息VBS脚本</title>
    <link href="http://daodaoliang.com/windows%E5%AD%A6%E4%B9%A0/2016/11/25/windows%E5%AD%A6%E4%B9%A0-2016-11-25-windows%E4%B8%8B%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AFVBS%E8%84%9A%E6%9C%AC/"/>
    <id>http://daodaoliang.com/windows学习/2016/11/25/windows学习-2016-11-25-windows下获取系统信息VBS脚本/</id>
    <published>2016-11-24T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月25日
</code></pre><a id="more"></a>
<hr>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div><div class="line">917</div><div class="line">918</div><div class="line">919</div><div class="line">920</div><div class="line">921</div><div class="line">922</div><div class="line">923</div><div class="line">924</div><div class="line">925</div><div class="line">926</div><div class="line">927</div><div class="line">928</div><div class="line">929</div><div class="line">930</div><div class="line">931</div><div class="line">932</div><div class="line">933</div><div class="line">934</div><div class="line">935</div><div class="line">936</div><div class="line">937</div><div class="line">938</div><div class="line">939</div><div class="line">940</div><div class="line">941</div><div class="line">942</div><div class="line">943</div><div class="line">944</div><div class="line">945</div><div class="line">946</div><div class="line">947</div><div class="line">948</div><div class="line">949</div><div class="line">950</div><div class="line">951</div><div class="line">952</div><div class="line">953</div><div class="line">954</div><div class="line">955</div><div class="line">956</div><div class="line">957</div><div class="line">958</div><div class="line">959</div><div class="line">960</div><div class="line">961</div><div class="line">962</div><div class="line">963</div><div class="line">964</div><div class="line">965</div><div class="line">966</div><div class="line">967</div><div class="line">968</div><div class="line">969</div><div class="line">970</div><div class="line">971</div><div class="line">972</div><div class="line">973</div><div class="line">974</div><div class="line">975</div><div class="line">976</div><div class="line">977</div><div class="line">978</div><div class="line">979</div><div class="line">980</div><div class="line">981</div><div class="line">982</div><div class="line">983</div><div class="line">984</div><div class="line">985</div><div class="line">986</div><div class="line">987</div><div class="line">988</div><div class="line">989</div><div class="line">990</div><div class="line">991</div><div class="line">992</div><div class="line">993</div><div class="line">994</div><div class="line">995</div><div class="line">996</div><div class="line">997</div><div class="line">998</div><div class="line">999</div></pre></td><td class="code"><pre><div class="line"><span class="comment">'********************************************************************</span></div><div class="line"><span class="comment">'*                                                                  *</span></div><div class="line"><span class="comment">'*                           Begin of File                          *</span></div><div class="line"><span class="comment">'*                                                                  *</span></div><div class="line"><span class="comment">'*******************************************************************</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">Const</span> forwriting=<span class="number">2</span></div><div class="line"><span class="keyword">Const</span> forreading=<span class="number">1</span></div><div class="line"><span class="keyword">Dim</span> oFSO,<span class="keyword">oF</span>,eventlog</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">Text</span> = <span class="string">"此脚本运行不会对您的系统造成任何损害或恶意行为"</span> &amp;VbCrLf&amp;vbCrlf&amp; <span class="string">"通过连接WMI提供的公共接口枚举系统相关信息"</span>&amp;VbCrLf&amp;VbCrLf&amp; <span class="string">"按确定键运行30秒左右会生成html格式报告"</span></div><div class="line">Title_Text = <span class="string">"bkReport  Version 2.2"</span></div><div class="line">MsgBox <span class="keyword">Text</span>,vbExclamation+vbSystemModal,Title_Text</div><div class="line"></div><div class="line">dtmStart = Now()</div><div class="line"></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> oShell = WScript.CreateObject(<span class="string">"WScript.Shell"</span>)</div><div class="line">hostname=oShell.ExpandEnvironmentStrings(<span class="string">"%computername%"</span>)</div><div class="line">MainReport=hostname&amp;<span class="string">"_Report.html"</span></div><div class="line">EventReport=hostname&amp;<span class="string">"_EventLog.html"</span></div><div class="line">datec=Now()</div><div class="line"><span class="keyword">Set</span> oFSO = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</div><div class="line"><span class="keyword">Set</span> <span class="keyword">oF</span> = oFSO.CreateTextFile(MainReport)</div><div class="line"><span class="keyword">Set</span> eventlog=oFSO.CreateTextFile(EventReport)</div><div class="line"></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"></div><div class="line"><span class="keyword">Set</span> colComputers = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_ComputerSystem"</span>)</div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objComputer <span class="keyword">in</span> colComputers</div><div class="line">   <span class="keyword">Select</span>  <span class="keyword">Case</span> objComputer.DomainRole</div><div class="line">    <span class="keyword">Case</span> <span class="string">"0"</span> machine= <span class="string">"独立工作站"</span></div><div class="line">    <span class="keyword">Case</span> <span class="string">"1"</span> machine= <span class="string">"成员工作站"</span></div><div class="line">    <span class="keyword">Case</span> <span class="string">"2"</span> machine= <span class="string">"独立服务器"</span></div><div class="line">    <span class="keyword">Case</span> <span class="string">"3"</span> machine= <span class="string">"成员服务器"</span></div><div class="line">    <span class="keyword">Case</span> <span class="string">"4"</span> machine= <span class="string">"备份服务器"</span></div><div class="line">    <span class="keyword">Case</span> <span class="string">"5"</span> machine= <span class="string">"主域控制器"</span></div><div class="line">   <span class="keyword">End</span> <span class="keyword">Select</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;html&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;head&gt;&lt;title&gt;MainReport Build by bkReport.vbs&lt;/title&gt;&lt;/head&gt;"</span></div><div class="line"><span class="keyword">oF</span>.Writeline <span class="string">"&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h2&gt;&lt;font color=MidnightBlue&gt;&lt;center&gt;"</span>&amp;hostname&amp;<span class="string">"@"</span>&amp;machine&amp;<span class="string">"   快照信息 &lt;/center&gt;&lt;/font&gt;&lt;/h2&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;p align=right&gt;&lt;font size=2&gt;date: "</span> &amp; Now()&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">oF</span>.Writeline <span class="string">"&lt;hr width=80% color=#ff8000&gt;"</span></div><div class="line"><span class="keyword">oF</span>.Writeline <span class="string">"&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;OL&gt;&lt;LI&gt;&lt;a href=#here1&gt;系统摘要&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here2&gt;BIOS信息&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here3&gt;环境变量&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here4&gt;系统文件内容&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here5&gt;网络状态&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here6&gt;磁盘和共享&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here7&gt;进程&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here8&gt;进程ID对应的启动服务&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here9&gt;服务&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here10&gt;补丁&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here11&gt;软件&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here12&gt;帐号&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here13&gt;AT创建的计划任务&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here14&gt;重要文件属性&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here15&gt;自启动项&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here16&gt;注册表&lt;/a&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;LI&gt;&lt;a href=#here17&gt;系统日志&lt;/a&gt;&lt;/LI&gt;&lt;/OL&gt;"</span></div><div class="line"><span class="keyword">oF</span>.Writeline <span class="string">"&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</span></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'系统摘要</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer)</div><div class="line"><span class="keyword">Set</span> colOperatingSystems = objWMIService.InstancesOf(<span class="string">"Win32_OperatingSystem"</span>)</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here1&gt;"</span>&amp;<span class="string">"[  1. 系统摘要  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1 style=font-size:9pt cellspacing=1 align=CENTER&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objOperatingSystem <span class="keyword">In</span> colOperatingSystems</div><div class="line">ostype=objOperatingSystem.Name</div><div class="line">LastbootUpTime=objOperatingSystem.LastBootUpTime</div><div class="line"><span class="comment">'     oF.WriteLine "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span><span class="doctag">&lt;b&gt;</span>" &amp;"Name:            "&amp;"<span class="doctag">&lt;/b&gt;</span><span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>"&amp; objOperatingSystem.Name &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line"> <span class="comment">'    oF.WriteLine  "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span><span class="doctag">&lt;b&gt;</span>" &amp; "Caption:         " &amp;"<span class="doctag">&lt;/b&gt;</span><span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>" &amp;objOperatingSystem.Caption &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"    </span></div><div class="line">  <span class="comment">'   oF.WriteLine  "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span><span class="doctag">&lt;b&gt;</span>" &amp; "LastBootUpTime:  "&amp;"<span class="doctag">&lt;/b&gt;</span><span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>"&amp;objOperatingSystem.LastBootUpTime &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line">   <span class="comment">'  oF.WriteLine  "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span><span class="doctag">&lt;b&gt;</span>" &amp; "LocalDateTime:   " &amp;"<span class="doctag">&lt;/b&gt;</span><span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>"&amp;objOperatingSystem.LocalDateTime &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line">    <span class="comment">' oF.WriteLine  "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span><span class="doctag">&lt;b&gt;</span>"&amp; "Version:         " &amp;"<span class="doctag">&lt;/b&gt;</span><span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>"&amp;objOperatingSystem.Version    &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line">     <span class="comment">'oF.WriteLine  "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span><span class="doctag">&lt;b&gt;</span>"&amp; "Windows Directory: "&amp;"<span class="doctag">&lt;/b&gt;</span><span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>"&amp;objOperatingSystem.WindowsDirectory&amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">"Select * from Win32_MemoryArray"</span>)</div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">in</span> colItems</div><div class="line">memsize =<span class="built_in">CLng</span>(objItem.EndingAddress /<span class="number">1024</span>)</div><div class="line"><span class="comment">'    oF.WriteLine "memory size: " &amp; objItem.EndingAddress  /1024 &amp;" MB"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMI = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> col = objWMI.ExecQuery(<span class="string">"Select * from Win32_Processor"</span>)</div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> obj <span class="keyword">in</span> col</div><div class="line"></div><div class="line"></div><div class="line">    cpuinfo=obj.Name</div><div class="line">     <span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1 style=font-size:9pt&gt; &lt;tr&gt;&lt;th CLASS=pt bgColor=#808080&gt;OS&lt;/th&gt;&lt;th bgColor=#808080&gt;HostName&lt;/th&gt;&lt;th bgColor=#808080&gt;Memory&lt;/th&gt;&lt;th bgColor=#808080&gt;CPU&lt;/th&gt;&lt;th bgColor=#808080&gt;LastBootUpTime&lt;/th&gt;&lt;/tr&gt; "</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;ostype&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;hostname&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;memsize&amp;<span class="string">"MB&lt;/td&gt;&lt;td&gt;"</span>&amp;cpuinfo&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp; LastBootUpTime &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"></div><div class="line"> strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span>&amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colAdapters = objWMIService.ExecQuery _</div><div class="line">  (<span class="string">"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = True"</span>)</div><div class="line"></div><div class="line"> <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Adapter&lt;/th&gt;&lt;th bgColor=#808080&gt;MACaddr&lt;/th&gt;&lt;th bgColor=#808080&gt;IPaddr&lt;/th&gt;&lt;th bgColor=#808080&gt;Subnet&lt;/th&gt;&lt;th bgColor=#808080&gt;gateway&lt;/th&gt;&lt;/tr&gt; "</span></div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objAdapter <span class="keyword">in</span> colAdapters</div><div class="line">  Adapter= objAdapter.Description</div><div class="line">  MACaddr= objAdapter.MACAddress</div><div class="line"></div><div class="line">   <span class="keyword">If</span> <span class="keyword">Not</span> IsNull(objAdapter.IPAddress) <span class="keyword">Then</span></div><div class="line">      <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(objAdapter.IPAddress)</div><div class="line">        IPaddr=objAdapter.IPAddress(i)</div><div class="line"></div><div class="line">      <span class="keyword">Next</span></div><div class="line">   <span class="keyword">End</span> <span class="keyword">If</span></div><div class="line">   <span class="keyword">If</span> <span class="keyword">Not</span> IsNull(objAdapter.IPSubnet) <span class="keyword">Then</span></div><div class="line">      <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(objAdapter.IPSubnet)</div><div class="line">        Subnet=objAdapter.IPSubnet(i)</div><div class="line">      <span class="keyword">Next</span></div><div class="line">   <span class="keyword">End</span> <span class="keyword">If</span></div><div class="line">   <span class="keyword">If</span> <span class="keyword">Not</span> IsNull(objAdapter.DefaultIPGateway) <span class="keyword">Then</span></div><div class="line">      <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(objAdapter.DefaultIPGateway)</div><div class="line">         gateway = objAdapter.DefaultIPGateway(i)</div><div class="line">      <span class="keyword">Next</span></div><div class="line">   <span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;Adapter&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;MACaddr&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;IPaddr&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;Subnet&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;gateway&amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"> <span class="keyword">Next</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span>  </div><div class="line"></div><div class="line"></div><div class="line"> <span class="comment">'--------------------------------------------------------------------</span></div><div class="line"> <span class="comment">'BIOS信息</span></div><div class="line"> <span class="comment">'--------------------------------------------------------------------</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here2&gt;"</span>&amp;<span class="string">"[  2. BIOS信息  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line"> <span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> _</div><div class="line">    &amp; <span class="string">"&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colBIOS = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_BIOS"</span>)</div><div class="line">     <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;TABLE BORDER=1 WIDTH=800 style=font-size:9pt cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objBIOS <span class="keyword">in</span> colBIOS</div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;<span class="string">"Build Number: "</span> &amp;objBIOS.BuildNumber&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;<span class="string">"Current Language: "</span> &amp;objBIOS.CurrentLanguage&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;<span class="string">"Installable Languages: "</span> &amp;objBIOS.InstallableLanguages&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Manufacturer: "</span> &amp;objBIOS.Manufacturer&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Name: "</span>&amp;objBIOS.Name&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Primary BIOS: "</span>&amp; objBIOS.PrimaryBIOS&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Release Date: "</span> &amp;objBIOS.ReleaseDate&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Serial Number: "</span> &amp; objBIOS.SerialNumber&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"SMBIOS Version: "</span> &amp;objBIOS.SMBIOSBIOSVersion&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"></div><div class="line">   <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;<span class="string">"SMBIOS Minor Version: "</span> &amp;objBIOS.SMBIOSMinorVersion&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"SMBIOS Present: "</span> &amp;objBIOS.SMBIOSPresent&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Status: "</span> &amp;objBIOS.Status&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"Version: "</span> &amp;objBIOS.Version&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp; <span class="string">"BIOS Characteristics: "</span>&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Next</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> <span class="comment">'-----------------------------------------------------------------</span></div><div class="line"> <span class="comment">'环境变量</span></div><div class="line"> <span class="comment">'-----------------------------------------------------------------</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here3&gt;"</span>&amp;<span class="string">"[  3. 环境变量  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &lt;/h3&gt;"</span></div><div class="line"> <span class="keyword">Set</span> wshshell = CreateObject(<span class="string">"WScript.Shell"</span>)</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;TABLE BORDER=1 WIDTH=800 style=font-size:9pt cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;"</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;b&gt;&lt;font size=3&gt;SYSTEM variables&lt;/font&gt;&lt;/b&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> EnvirSYSTEM <span class="keyword">In</span> wshshell.Environment(<span class="string">"SYSTEM"</span>)</div><div class="line"> <span class="keyword">oF</span>.writeline <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span> &amp;EnvirSYSTEM &amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Next</span></div><div class="line">  <span class="keyword">oF</span>.writeline <span class="string">"&lt;b&gt;&lt;font size=3&gt;PROCESS variables&lt;/font&gt;&lt;/b&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> EnvirPROCESS <span class="keyword">In</span> wshshell.Environment(<span class="string">"PROCESS"</span>)</div><div class="line"> <span class="keyword">oF</span>.writeline <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;EnvirPROCESS &amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line">  <span class="keyword">oF</span>.writeline <span class="string">"&lt;b&gt;&lt;font size=3&gt;USER variables&lt;/font&gt;&lt;/b&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> EnvirUSER <span class="keyword">In</span> wshshell.Environment(<span class="string">"USER"</span>)</div><div class="line"> <span class="keyword">oF</span>.writeline <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;EnvirUSER &amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"> <span class="keyword">oF</span>.writeline <span class="string">"&lt;b&gt;&lt;font size=3&gt;VOLATILE variables&lt;/font&gt;&lt;/b&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> EnvirVOLATILE <span class="keyword">In</span> wshshell.Environment(<span class="string">"VOLATILE"</span>)</div><div class="line"> <span class="keyword">oF</span>.writeline <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span>&amp;EnvirVOLATILE &amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">set</span> wshshell=<span class="literal">Nothing</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</span></div><div class="line"> <span class="comment">'----------------------------------</span></div><div class="line"> <span class="comment">'系统文件</span></div><div class="line"> <span class="comment">'----------------------------------</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here4&gt;"</span>&amp;<span class="string">"[  4. 系统文件内容  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</span></div><div class="line"></div><div class="line"> <span class="keyword">Set</span> wshshell=wscript.CreateObject(<span class="string">"WScript.shell"</span>)</div><div class="line">autoexecBAT=wshshell.expandEnvironmentStrings(<span class="string">"%systemdrive%"</span>)&amp;<span class="string">"\autoexec.bat"</span></div><div class="line">configSYS=wshshell.expandEnvironmentStrings(<span class="string">"%systemdrive%"</span>)&amp;<span class="string">"\config.sys"</span></div><div class="line">bootINI=wshshell.expandEnvironmentStrings(<span class="string">"%systemdrive%"</span>)&amp;<span class="string">"\boot.ini"</span></div><div class="line">winINI=wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\win.ini"</span></div><div class="line">systemINI=wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system.ini"</span></div><div class="line">autoexecNT=wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\autoexec.nt"</span></div><div class="line">configNT=wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\config.nt"</span></div><div class="line">HOSTS=wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\drivers\etc\hosts"</span></div><div class="line"><span class="keyword">Function</span> readtxt (txtfile)</div><div class="line"><span class="keyword">Set</span> objFSO = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</div><div class="line"><span class="keyword">Set</span> objFile = objFSO.OpenTextFile(txtfile, <span class="number">1</span>)</div><div class="line"> <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;TABLE BORDER=1 WIDTH=800 cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;&lt;b&gt;&lt;font size=3&gt;"</span> &amp;txtfile &amp;<span class="string">"&lt;/font&gt;&lt;/b&gt;"</span></div><div class="line"><span class="keyword">Do</span> <span class="keyword">Until</span> objFile.AtEndOfStream</div><div class="line">    strCharacters = objFile.Readline</div><div class="line">     <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span> &amp;strCharacters &amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">Loop</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">Function</span></div><div class="line">readtxt (autoexecBAT)</div><div class="line">readtxt (configSYS)</div><div class="line">readtxt (bootINI)</div><div class="line">readtxt (winINI)</div><div class="line">readtxt (systemINI)</div><div class="line">readtxt (autoexecNT)</div><div class="line">readtxt (configNT)</div><div class="line">readtxt (HOSTS)</div><div class="line"></div><div class="line"></div><div class="line"> <span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'网络状态</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;"</span>&amp;<span class="string">"&lt;font color=MidnightBlue&gt;&lt;a name=here5&gt;"</span>&amp;<span class="string">"[  5. 网络状态  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;"</span>&amp;<span class="string">"&lt;/h3&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Dim</span> f1</div><div class="line"><span class="keyword">Set</span> ws=WScript.CreateObject (<span class="string">"wscript.shell"</span>)</div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### ipconfig /all #########################  &gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c ipconfig /all  &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### netstat -r ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c netstat -r &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### arp -a ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c arp -a &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### netstat -an ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c netstat -an &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### nbtstat -r ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c nbtstat -r &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### nbtstat -n  ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c nbtstat -n &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### nbtstat -S ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c nbtstat -S &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c echo ######################### netstat -es ######################### &gt;&gt; ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line">ws.run <span class="string">"%comspec% /c netstat -es &gt;&gt;ttmp"</span>,<span class="number">0</span>,<span class="literal">True</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> f1=oFSO.OpenTextFile (<span class="string">"ttmp"</span>,forreading,<span class="literal">True</span>)</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;TABLE BORDER=1 WIDTH=800 cellspacing=1&gt;&lt;TR&gt;&lt;TD&gt;"</span></div><div class="line"><span class="keyword">Do</span> <span class="keyword">Until</span>  f1.AtEndOfStream</div><div class="line">a=f1.ReadLine</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span> &amp;a&amp;<span class="string">"&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">Loop</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;"</span></div><div class="line">f1.Close</div><div class="line">ofso.DeleteFile <span class="string">"ttmp"</span>,<span class="literal">True</span></div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检查磁盘和共享</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here6&gt;"</span>&amp;<span class="string">"[ 6. 磁盘和共享  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">Sub</span> Enudisk</div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;table BORDER=1 style=font-size:9pt cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></div><div class="line"><span class="comment">'Enumerate Disk Drive Properties 用了除法转成MB单位，并用clng函数取整</span></div><div class="line"><span class="keyword">Set</span> objFSO = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</div><div class="line"><span class="keyword">Set</span> colDrives = objFSO.Drives</div><div class="line"><span class="keyword">of</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Drive letter: &lt;/th&gt;&lt;th bgColor=#808080&gt;Volume name: &lt;/th&gt;&lt;th bgColor=#808080&gt;File system: &lt;/th&gt;&lt;th bgColor=#808080&gt;Total size: &lt;/th&gt;&lt;th bgColor=#808080&gt;Free space: &lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objDrive <span class="keyword">in</span> colDrives</div><div class="line">    <span class="keyword">of</span>.writeline <span class="string">"&lt;tr&gt;&lt;td&gt;"</span> &amp; objDrive.DriveLetter &amp;<span class="string">"&lt;/td&gt;"</span>&amp;_</div><div class="line">    <span class="string">"&lt;td&gt;"</span> &amp; objDrive.VolumeName&amp;<span class="string">"&lt;/td&gt;"</span>&amp;_</div><div class="line">   <span class="string">"&lt;td&gt;"</span> &amp; objDrive.FileSystem&amp;<span class="string">"&lt;/td&gt;"</span>&amp;_</div><div class="line">    <span class="string">"&lt;td&gt;"</span> &amp;  <span class="built_in">clng</span>(objDrive.TotalSize /<span class="number">1024</span> /<span class="number">1024</span> ) &amp;<span class="string">"MB"</span>&amp;<span class="string">"&lt;/td&gt;"</span>&amp;_</div><div class="line">   <span class="string">"&lt;td&gt;"</span> &amp;  <span class="built_in">CLng</span>(objDrive.FreeSpace /<span class="number">1024</span> /<span class="number">1024</span> ) &amp;<span class="string">"MB"</span>&amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">If</span> Err &lt;&gt;<span class="number">0</span> <span class="keyword">Then</span></div><div class="line"></div><div class="line">Err.Clear</div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></div><div class="line"></div><div class="line">Enudisk</div><div class="line"></div><div class="line"></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">"Select * from Win32_Share"</span>,,<span class="number">48</span>)</div><div class="line"></div><div class="line">    <span class="keyword">of</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Path: &lt;/th&gt;&lt;th bgColor=#808080&gt;Name: &lt;/th&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;th bgColor=#808080&gt;Status:&lt;/th&gt;&lt;th bgColor=#808080&gt;MaximumAllowed:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">in</span> colItems</div><div class="line">    <span class="keyword">of</span>.writeline <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp; objItem.Path&amp;<span class="string">"&lt;/td&gt;"</span>&amp;  _</div><div class="line">     <span class="string">"&lt;td&gt;"</span> &amp; objItem.Name&amp;<span class="string">"&lt;/td&gt;"</span>&amp; _</div><div class="line">    <span class="string">"&lt;td&gt;"</span>  &amp; objItem.Caption&amp;<span class="string">"&lt;/td&gt;"</span>&amp; _</div><div class="line">    <span class="string">"&lt;td&gt;"</span> &amp; objItem.Status&amp;<span class="string">"&lt;/td&gt;"</span>&amp;_</div><div class="line">     <span class="string">"&lt;td&gt;"</span> &amp;objItem.MaximumAllowed &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span>     </div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检测进程  </span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here7&gt;"</span>&amp;<span class="string">"[  7. 进程  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">Set</span> objWMI = _</div><div class="line">   GetObject(<span class="string">"winmgmts:&#123;impersonationLevel=impersonate&#125;//./root/cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colProcessList = objWMI.ExecQuery(<span class="string">"SELECT * FROM Win32_Process"</span>)</div><div class="line"><span class="keyword">Set</span> objFSO = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1  WIDTH=%100 style=font-size:9pt cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;UserDomain&lt;/th&gt;&lt;th bgColor=#808080&gt;Ownership&lt;/th&gt;&lt;th bgColor=#808080&gt;CreationDate&lt;/th&gt;&lt;th bgColor=#808080&gt;Process ID:&lt;/th&gt;&lt;th bgColor=#808080&gt;Process Name:&lt;/th&gt;"</span>&amp;<span class="string">"&lt;th bgColor=#808080&gt;Executable Path:&lt;/th&gt;&lt;th bgColor=#808080&gt;Size:&lt;/th&gt;&lt;th bgColor=#808080&gt;File created:&lt;/th&gt;&lt;th bgColor=#808080&gt;File last modified:&lt;/th&gt;&lt;th bgColor=#808080&gt;File last accessed:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> colprocess <span class="keyword">In</span> colProcessList</div><div class="line"></div><div class="line">colProperties=colProcess.GetOwner(strNameOfUser,strUserDomain)</div><div class="line"><span class="keyword">Set</span> objFile = objFSO.GetFile (colProcess.ExecutablePath)</div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span> &amp; strUserDomain  &amp; <span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;strNameOfUser&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp; colProcess.CreationDate&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;colProcess.Processid &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp;colprocess.name&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;colProcess.ExecutablePath &amp; <span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.Size &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span> &amp;  objFile.DateCreated &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.DateLastModified &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.DateLastAccessed &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检测进程id对应的服务  </span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here8&gt;"</span>&amp;<span class="string">"[  8. 进程ID对应的启动服务  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line">  <span class="keyword">set</span> objIdDictionary = CreateObject(<span class="string">"Scripting.Dictionary"</span>)</div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> _</div><div class="line">    &amp; <span class="string">"&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colServices = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_Service Where State &lt;&gt; 'Stopped'"</span>)</div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objService <span class="keyword">in</span> colServices</div><div class="line">    <span class="keyword">If</span> objIdDictionary.Exists(objService.ProcessID) <span class="keyword">Then</span></div><div class="line">    <span class="keyword">Else</span></div><div class="line">        objIdDictionary.Add objService.ProcessID, objService.ProcessID</div><div class="line">    <span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"><span class="keyword">Next</span></div><div class="line">colProcessIDs = objIdDictionary.Items</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;TABLE BORDER=1 style=font-size:9pt cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">to</span> objIdDictionary.Count - <span class="number">1</span></div><div class="line">    <span class="keyword">Set</span> colServices = objWMIService.ExecQuery _</div><div class="line">        (<span class="string">"Select * from Win32_Service Where ProcessID = '"</span> &amp; _</div><div class="line">            colProcessIDs(i) &amp; <span class="string">"'"</span>)</div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;TR&gt;&lt;TH bgColor=#808080&gt;Process ID: &lt;/TH&gt;&lt;td&gt;"</span> &amp;colProcessIDs(i)&amp;<span class="string">"&lt;td/&gt;"</span></div><div class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> objService <span class="keyword">in</span> colServices</div><div class="line">          <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td COLSPAN=2&gt;"</span> &amp; objService.DisplayName &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">Next</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"> <span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;/TABLE&gt;"</span></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检测服务  </span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;"</span>&amp;<span class="string">"&lt;font color=MidnightBlue&gt;&lt;a name=here9&gt;"</span>&amp;<span class="string">"[   9. 服务  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;"</span>&amp;<span class="string">"&lt;/h3&gt;"</span></div><div class="line">strComputer = <span class="string">"."</span>  </div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> &amp; _</div><div class="line">    <span class="string">"&#123;impersonationLevel=Impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colStartServices = objWMIService.ExecQuery _</div><div class="line">  (<span class="string">"SELECT DisplayName,State FROM Win32_Service WHERE State = 'Running'"</span>)</div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Running server list:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">of</span>.writeline <span class="string">"&lt;tr&gt;&lt;td&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objService <span class="keyword">in</span> colStartServices</div><div class="line">    <span class="keyword">of</span>.writeline  <span class="string">"&lt;p&gt;"</span> &amp; objService.DisplayName &amp; <span class="string">"&lt;/p&gt;"</span>  </div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span>                  </div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer)</div><div class="line"><span class="keyword">Set</span> colServices = objWMIService.InstancesOf(<span class="string">"Win32_Service"</span>)</div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Display Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Path Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Start Mode:&lt;/th&gt;&lt;th bgColor=#808080&gt;State:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objService <span class="keyword">In</span> colServices</div><div class="line">    <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;"</span>&amp;<span class="string">"&lt;td&gt;"</span> &amp;objService.Name    &amp;<span class="string">"&lt;/td&gt;"</span>&amp;_    </div><div class="line">                <span class="string">"&lt;td&gt;"</span> &amp; objService.DisplayName&amp;<span class="string">"&lt;/td&gt;"</span>&amp; _</div><div class="line">                <span class="string">"&lt;td&gt;"</span> &amp; objService.PathName     &amp;<span class="string">"&lt;/td&gt;"</span>&amp; _</div><div class="line">                <span class="string">"&lt;td&gt;"</span> &amp; objService.StartMode    &amp;<span class="string">"&lt;/td&gt;"</span>&amp; _</div><div class="line">                 <span class="string">"&lt;td&gt;"</span> &amp;objService.State        &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Next</span>                                           </div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/tr&gt;&lt;/table&gt;"</span>                                </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检测补丁</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;"</span>&amp;<span class="string">"&lt;font color=MidnightBlue&gt;&lt;a name=here10&gt;"</span>&amp;<span class="string">"[  10. 补丁  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;"</span>&amp;<span class="string">"&lt;/h3&gt;"</span></div><div class="line"></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> _</div><div class="line">    &amp; <span class="string">"&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colOperatingSystems = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_OperatingSystem"</span>)</div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objOperatingSystem <span class="keyword">in</span> colOperatingSystems</div><div class="line">    PACKVER = objOperatingSystem.ServicePackMajorVersion  _</div><div class="line">        &amp; <span class="string">"."</span> &amp; objOperatingSystem.ServicePackMinorVersion</div><div class="line">        <span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> _</div><div class="line">&amp; <span class="string">"&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colQuickFixes = objWMIService.ExecQuery _</div><div class="line">(<span class="string">"Select * from Win32_QuickFixEngineering"</span>)</div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1 style=font-size:9pt cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;PackVersion: &lt;/th&gt;&lt;td&gt;"</span>&amp;PACKVER&amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="comment">'   oF.WriteLine "<span class="doctag">&lt;td&gt;</span>Computer: <span class="doctag">&lt;/td&gt;</span>"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Description:&lt;/th&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;th bgColor=#808080&gt;Hotfix ID:&lt;/th&gt;"</span></div><div class="line"> <span class="comment">'   oF.WriteLine "<span class="doctag">&lt;td&gt;</span>Installation Date:<span class="doctag">&lt;/td&gt;</span>"</span></div><div class="line"> <span class="comment">'  oF.WriteLine "<span class="doctag">&lt;td&gt;</span>Installed By:<span class="doctag">&lt;/td&gt;</span>"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objQuickFix <span class="keyword">in</span> colQuickFixes</div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;"</span></div><div class="line"><span class="comment">'    oF.WriteLine "<span class="doctag">&lt;td&gt;</span>" &amp; objQuickFix.CSName &amp; "<span class="doctag">&lt;/td&gt;</span>"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span> &amp; objQuickFix.Description &amp; <span class="string">"&lt;/td&gt;"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span> &amp; objQuickFix.HotFixID &amp; <span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="comment">'   oF.WriteLine "<span class="doctag">&lt;td&gt;</span>" &amp; objQuickFix.InstallDate &amp; "<span class="doctag">&lt;/td&gt;</span>"</span></div><div class="line"><span class="comment">'    oF.WriteLine "<span class="doctag">&lt;td&gt;</span>" &amp; objQuickFix.InstalledBy &amp; "<span class="doctag">&lt;/td&gt;</span>"</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span></div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检测软件</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="comment">'get installed software</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;"</span>&amp;<span class="string">"&lt;font color=MidnightBlue&gt;&lt;a name=here11&gt;"</span>&amp;<span class="string">"[  11. 软件  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;"</span>&amp;<span class="string">"&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table BORDER=1 style=font-size:9pt cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;th bgColor=#808080&gt;version:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Set</span> colApps = objWMIService.ExecQuery(<span class="string">"Select * from Win32_Product"</span>)</div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objApp <span class="keyword">in</span> colApps</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;objApp.Caption &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp; objApp.Version &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">Dim</span> oRegistry, sBaseKey, iRC, sKey, arSubKeys, sValue</div><div class="line"><span class="keyword">Const</span> HKLM = &amp;H80000002 <span class="comment">'HKEY_LOCAL_MACHINE</span></div><div class="line"><span class="keyword">Set</span> oRegistry = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer  &amp; _</div><div class="line"><span class="string">"/root/default:StdRegProv"</span>)</div><div class="line"></div><div class="line">sBaseKey = <span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">iRC = oRegistry.EnumKey(HKLM, sBaseKey, arSubKeys)</span></div><div class="line"><span class="string">For Each sKey In arSubKeys</span></div><div class="line"><span class="string">  iRC = oRegistry.GetStringValue(HKLM, sBaseKey &amp; sKey, _</span></div><div class="line"><span class="string">  "</span>DisplayName<span class="string">", sValue)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">  version= oRegistry.GetStringValue(HKLM, sBaseKey &amp; sKey, _</span></div><div class="line"><span class="string">  "</span>DisplayVersion<span class="string">", sVer)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">  If iRC &lt;&gt; 0 Then</span></div><div class="line"><span class="string">    oRegistry.GetStringValue HKLM, sBaseKey &amp; sKey, _</span></div><div class="line"><span class="string">    "</span>QuietDisplayName<span class="string">", sValue</span></div><div class="line"><span class="string">  End If</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">  If sValue &lt;&gt; "</span><span class="string">" Then</span></div><div class="line"><span class="string">    	of.writeline"</span>&lt;tr&gt;&lt;td&gt;<span class="string">" &amp; sValue &amp; "</span>&lt;/td&gt;&lt;td&gt;<span class="string">" &amp; sver &amp; "</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">  ElseIf Err &lt;&gt; 0 Then</span></div><div class="line"><span class="string">	of.writeline"</span>&lt;tr&gt;&lt;td&gt;<span class="string">"&amp; "</span>Installed App Name <span class="keyword">Not</span> Available<span class="string">" &amp; "</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string">  	err.clear</span></div><div class="line"><span class="string">	err.Number=0</span></div><div class="line"><span class="string">  End If</span></div><div class="line"><span class="string">Next</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">Const ADMINISTRATIVE_TOOLS = &amp;H2f&amp;</span></div><div class="line"><span class="string">Set objShell = CreateObject("</span>Shell.Application<span class="string">")</span></div><div class="line"><span class="string">Set objFolder = objShell.Namespace(ADMINISTRATIVE_TOOLS)</span></div><div class="line"><span class="string">Set objTools = objFolder.Items</span></div><div class="line"><span class="string">oF.WriteLine "</span>&lt;tr&gt;&lt;th bgColor=<span class="meta">#808080&gt;Admin tools:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">to</span> objTools.Count - <span class="number">1</span></div><div class="line">   <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp; objTools.Item(i)&amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检测帐号</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here12&gt;"</span>&amp;<span class="string">"[  12. 帐号  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line"></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">"Select * from Win32_UserAccount"</span>,,<span class="number">48</span>)</div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;table width=100% BORDER=1 style=font-size:9pt  cellspacing=1&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;"</span> &amp;<span class="string">"Name: "</span>&amp; <span class="string">"&lt;/th&gt;"</span>_</div><div class="line">    &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp;<span class="string">"Description: "</span>&amp; <span class="string">"&lt;/th&gt;"</span>_</div><div class="line">    &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp;<span class="string">"Lockout: "</span>&amp; <span class="string">"&lt;/th&gt;"</span>_</div><div class="line">     &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp;<span class="string">"PasswordChangeable: "</span>&amp; <span class="string">"&lt;/th&gt;"</span>_</div><div class="line">     &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp;<span class="string">"PasswordExpires: "</span>&amp; <span class="string">"&lt;/t&gt;"</span>_</div><div class="line">     &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp;<span class="string">"SID: "</span> &amp; <span class="string">"&lt;/th&gt;"</span>_</div><div class="line">     &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp; <span class="string">"Status: "</span>&amp; <span class="string">"&lt;/th&gt;"</span>_</div><div class="line">     &amp;<span class="string">"&lt;th bgColor=#808080&gt;"</span>&amp; <span class="string">"administrators: "</span>&amp; <span class="string">"&lt;/th&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">in</span> colItems</div><div class="line"> strUser = objItem.Name</div><div class="line"></div><div class="line"><span class="keyword">Set</span> objGroup = GetObject(<span class="string">"WinNT://"</span> &amp; strComputer &amp; <span class="string">"/Administrators"</span>)</div><div class="line"></div><div class="line">   <span class="keyword">oF</span>.writeline  <span class="string">"&lt;tr&gt;&lt;td&gt;"</span> &amp; objItem.Name &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp; _</div><div class="line">    objItem.Description &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp; _</div><div class="line">    objItem.Lockout &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp; _</div><div class="line">    objItem.PasswordChangeable &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp; _</div><div class="line">    objItem.PasswordExpires &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp; _</div><div class="line">    objItem.SID &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span> &amp; _</div><div class="line">    objItem.Status&amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"></div><div class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> objUser <span class="keyword">in</span> objGroup.Members</div><div class="line">    <span class="keyword">If</span> objUser.Name = strUser <span class="keyword">Then</span></div><div class="line">        <span class="keyword">oF</span>.writeline <span class="string">"&lt;td&gt;True&lt;/td&gt;"</span></div><div class="line"></div><div class="line">    <span class="keyword">End</span> <span class="keyword">If</span></div><div class="line">   <span class="keyword">Next</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></div><div class="line"><span class="keyword">Set</span> objNetwork = CreateObject(<span class="string">"Wscript.Network"</span>)</div><div class="line">strComputer = objNetwork.ComputerName</div><div class="line"></div><div class="line">strPassword = <span class="string">""</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> colAccounts = GetObject(<span class="string">"WinNT://"</span> &amp; strComputer)</div><div class="line">colAccounts.Filter = Array(<span class="string">"user"</span>)</div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objUser <span class="keyword">In</span> colAccounts</div><div class="line">    objUser.ChangePassword strPassword, strPassword</div><div class="line">    <span class="keyword">If</span> Err = <span class="number">0</span> <span class="keyword">or</span> Err = <span class="number">-2147023569</span> <span class="keyword">Then</span></div><div class="line">        <span class="keyword">oF</span>.writeline  <span class="string">"&lt;p&gt;&lt;font size=2&gt;"</span> &amp;objUser.Name &amp;  <span class="string">" password is null !.&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">    <span class="keyword">End</span> <span class="keyword">If</span></div><div class="line">    Err.Clear</div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span></div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检查计划任务</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here13&gt;"</span>&amp;<span class="string">"[  13. AT创建的计划任务  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;table width=100% BORDER=1 style=font-size:9pt cellspacing=1&gt;"</span></div><div class="line"><span class="comment">'oF.writeline "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;th bgColor=#808080&gt;</span>Caption:<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th bgColor=#808080&gt;</span>Command:<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th bgColor=#808080&gt;</span>Days Of Month:<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th bgColor=#808080&gt;</span>Days Of Week:<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th bgColor=#808080&gt;</span>Description: <span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th bgColor=#808080&gt;</span>Elapsed Time:<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;&gt;</span><span class="doctag">&lt;&gt;</span><span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;&gt;</span><span class="doctag">&lt;&gt;</span><span class="doctag">&lt;&gt;</span></span></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> _</div><div class="line">    &amp; <span class="string">"&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colScheduledJobs = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_ScheduledJob"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objJob <span class="keyword">In</span> colScheduledJobs</div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Caption:&lt;/th&gt;&lt;td&gt; "</span> &amp; objJob.Caption &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Command:&lt;/th&gt;&lt;td&gt; "</span> &amp; objJob.Command &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Days Of Month: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.DaysOfMonth &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Days Of Week: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.DaysOfWeek &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Description: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.Description &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Elapsed Time: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.ElapsedTime &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Install Date: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.InstallDate &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Interact with Desktop: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.InteractWithDesktop &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Job ID: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.JobID &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Job Status: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.JobStatus &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Name: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.Name &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Notify: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.Notify &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Owner: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.Owner &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Priority: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.Priority &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Run Repeatedly: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.RunRepeatedly &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Start Time: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.StartTime &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Status: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.Status &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Time Submitted: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.TimeSubmitted &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Until Time: &lt;/th&gt;&lt;td&gt;"</span> &amp; objJob.UntilTime &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;/table&gt;"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">'----------------------------------</span></div><div class="line"><span class="comment">'获取文件信息函数</span></div><div class="line"><span class="comment">'----------------------------------</span></div><div class="line"></div><div class="line"><span class="keyword">Function</span> getfileinfo (targetfiles)</div><div class="line"><span class="keyword">Set</span> objFSO = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</div><div class="line"><span class="keyword">Set</span> objFile = objFSO.GetFile (targetfiles)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;tr&gt;&lt;td&gt;"</span> &amp; objFile.Path &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.Size &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.Type &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span> &amp; objFile.DateCreated &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.DateLastModified &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine  <span class="string">"&lt;td&gt;"</span> &amp; objFile.DateLastAccessed &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">End</span> <span class="keyword">Function</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here14&gt;"</span>&amp;<span class="string">"[  14. 重要文件属性  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font &gt;&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Path:&lt;/th&gt;&lt;th bgColor=#808080&gt;Size:&lt;/th&gt;&lt;th bgColor=#808080&gt;Type:&lt;/th&gt;&lt;th bgColor=#808080&gt;Date created:&lt;/th&gt;&lt;th bgColor=#808080&gt;Date last modified:&lt;/th&gt;&lt;th bgColor=#808080&gt;Date last accessed:&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\cmd.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\services.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\xcopy.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\arp.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\posix.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\cacls.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\debug.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\telnet.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\ftp.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\tftp.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\tracert.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\edlin.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\rsh.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\ipconfig.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\regedt32.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\finger.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\at.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\netstat.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\wscript.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\cscript.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\ping.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\atsvc.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\rcp.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\regedit.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\nslookup.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\runonce.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\net.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\route.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\copy.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\user.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\csrss.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\rexec.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\nbtstat.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\notepad.exe"</span></div><div class="line">getfileinfo wshshell.expandEnvironmentStrings(<span class="string">"%systemroot%"</span>)&amp;<span class="string">"\system32\edit.com"</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;/table&gt;"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">'get autorun</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here15&gt;"</span>&amp;<span class="string">"[  15. 自启动项  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:"</span> _</div><div class="line">    &amp; <span class="string">"&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"><span class="keyword">Set</span> colStartupCommands = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_StartupCommand"</span>)</div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;User:&lt;/th&gt;&lt;th bgColor=#808080&gt;Location:&lt;/th&gt;&lt;th bgColor=#808080&gt;Name:&lt;/th&gt;&lt;th bgColor=#808080&gt;Command:&lt;/th&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objStartupCommand <span class="keyword">in</span> colStartupCommands</div><div class="line">    <span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;objStartupCommand.User&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;objStartupCommand.location&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;objStartupCommand.name &amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp; objStartupCommand.command&amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/table&gt;"</span></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'检查注册表自启动项目</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here16&gt;"</span>&amp;<span class="string">"[  16. 注册表  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Const</span> HKEY_CLASSES_ROOT = &amp;H80000000</div><div class="line"><span class="keyword">Const</span> HKEY_CURRENT_USER = &amp;H80000001</div><div class="line"><span class="keyword">Const</span> HKEY_LOCAL_MACHINE = &amp;H80000002</div><div class="line"><span class="keyword">Const</span> HKEY_USERS=&amp;H80000003</div><div class="line"><span class="keyword">Const</span> HKEY_CURRENT_CONFIG=&amp;H80000005</div><div class="line"><span class="keyword">Const</span> REG_SZ = <span class="number">1</span></div><div class="line"><span class="keyword">Const</span> REG_EXPAND_SZ = <span class="number">2</span></div><div class="line"><span class="keyword">Const</span> REG_BINARY = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> REG_DWORD = <span class="number">4</span></div><div class="line"><span class="keyword">Const</span> REG_MULTI_SZ = <span class="number">7</span></div><div class="line"></div><div class="line">strComputer = <span class="string">"."</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> oReg=GetObject(<span class="string">"winmgmts:&#123;impersonationLevel=impersonate&#125;!\\"</span> &amp;_</div><div class="line">strComputer &amp; <span class="string">"\root\default:StdRegProv"</span>)</div><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;读取此项内容&lt;/th&gt;&lt;th bgColor=#808080&gt;内容&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="comment">'enum subkeys\all entryNames</span></div><div class="line">oReg.GetdwordValue HKEY_LOCAL_MACHINE,<span class="string">"SYSTEM\CurrentControlSet\Services\lanmanserver\parameters"</span>,<span class="string">"Autoshareserver"</span>,strValue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters\Autoshareserver"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;strValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span>  </div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_LOCAL_MACHINE,<span class="string">"Software\Microsoft\Windows NT\CurrentVersion\Winlogon"</span>,<span class="string">"Shell"</span>,strValue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\shell"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;strValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oreg.GetstringValue HKEY_LOCAL_MACHINE,<span class="string">"Software\Microsoft\Windows NT\CurrentVersion\Winlogon"</span>,<span class="string">"Userinit"</span>,strValue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\Userinit"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;strValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_LOCAL_MACHINE,<span class="string">"Software\Microsoft\Windows NT\CurrentVersion\Windows"</span>,<span class="string">"run"</span>,strValue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\run"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;strValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_CURRENT_USER,<span class="string">"Software\Microsoft\Windows NT\CurrentVersion\Windows"</span>,<span class="string">"run"</span>,strValue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\run"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;strValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oReg.GetstringValue HKEY_CURRENT_USER,<span class="string">"Software\Microsoft\Windows NT\CurrentVersion\Windows"</span>,<span class="string">"load"</span>,strValue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\load"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;strValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,<span class="string">"SYSTEM\CurrentControlSet\Services\EventLog\Application"</span>,<span class="string">"Maxsize"</span>,dwordvalue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Application\Maxsize"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;dwordValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,<span class="string">"SYSTEM\CurrentControlSet\Services\EventLog\security"</span>,<span class="string">"Maxsize"</span>,dwordvalue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\security\Maxsize"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;dwordValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,<span class="string">"SYSTEM\CurrentControlSet\Services\EventLog\system"</span>,<span class="string">"Maxsize"</span>,dwordvalue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\system\Maxsize"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;dwordValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,<span class="string">"SYSTEM\CurrentControlSet\Control\Lsa"</span>,<span class="string">"restrictanonymous"</span>,dwordvalue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\RestrictAnonymous"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;dwordValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oreg.getdwordvalue HKEY_LOCAL_MACHINE,<span class="string">"System\CurrentControlSet\Services\NetBT\Parameters"</span>,<span class="string">"SMBDeviceEnabled"</span>,dwordvalue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters\SMBDeviceEnabled"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;dwordValue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line">oReg.GetStringValue HKEY_LOCAL_MACHINE,<span class="string">"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows"</span>,<span class="string">"Appinit_Dlls"</span>,stringvalue</div><div class="line"><span class="keyword">If</span> IsNull(strValue) <span class="keyword">Then</span></div><div class="line"><span class="keyword">Else</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls"</span> &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;td&gt;"</span>&amp;stringvalue &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;枚举此键内容&lt;/th&gt;&lt;th bgColor=#808080&gt;项目名&lt;/th&gt;&lt;th bgColor=#808080&gt;数据类型&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="comment">'get entryNames values</span></div><div class="line">RegEnum HKEY_LOCAL_MACHINE,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span></div><div class="line">RegEnum HKEY_LOCAL_MACHINE,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx"</span></div><div class="line">RegEnum HKEY_LOCAL_MACHINE,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"</span></div><div class="line">RegEnum HKEY_LOCAL_MACHINE,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\RunServices"</span></div><div class="line">RegEnum HKEY_LOCAL_MACHINE,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad"</span></div><div class="line">RegEnum HKEY_CURRENT_USER,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span></div><div class="line">RegEnum HKEY_CURRENT_USER,<span class="string">"SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"</span></div><div class="line">RegEnum HKEY_CURRENT_USER,<span class="string">"SOFTWARE\Micrsoft\Windows\CurrentVersion\RunOnceEx"</span></div><div class="line">RegEnum HKEY_CURRENT_USER,<span class="string">"SOFTWARE\Micrsoft\Windows\CurrentVersion\RunServices"</span></div><div class="line"></div><div class="line"><span class="comment">'the dll files Location: C:\WINDOWS\system32</span></div><div class="line">RegEnum HKEY_LOCAL_MACHINE,<span class="string">"System\CurrentControlSet\Control\Session Manager\KnownDLLs"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">Function</span> RegEnum (Subtrees,strKeyPath)</div><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></div><div class="line">oReg.EnumValues Subtrees, strKeyPath,_</div><div class="line"> arrValueNames, arrValueTypes</div><div class="line"> <span class="keyword">If</span> <span class="keyword">Not</span> IsNull(arrvaluenames) <span class="keyword">Then</span></div><div class="line"></div><div class="line">    <span class="keyword">If</span> Subtrees= &amp;H80000002 <span class="keyword">Then</span></div><div class="line">       <span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\"&amp;strKeyPath &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string">	Elseif Subtrees=&amp;H80000001 Then</span></div><div class="line"><span class="string">       oF.WriteLine "</span>&lt;tr&gt;&lt;td&gt;<span class="string">"&amp; "</span>HKEY_CURRENT_USER\<span class="string">"&amp;strKeyPath &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string">    End If</span></div><div class="line"><span class="string">End If</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">For i=0 To UBound(arrValueNames)</span></div><div class="line"><span class="string">   oF.WriteLine "</span>&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;<span class="string">"&amp; arrValueNames(i) &amp;"</span>&lt;/td&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">       Select Case arrValueTypes(i)</span></div><div class="line"><span class="string">        Case REG_SZ</span></div><div class="line"><span class="string">            oF.WriteLine "</span>&lt;td&gt;<span class="string">"&amp; "</span><span class="built_in">String</span><span class="string">" &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">        Case REG_EXPAND_SZ</span></div><div class="line"><span class="string">            oF.WriteLine "</span>&lt;td&gt;<span class="string">"&amp; "</span>Expanded <span class="built_in">String</span><span class="string">"  &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">        Case REG_BINARY</span></div><div class="line"><span class="string">            oF.WriteLine "</span>&lt;td&gt;<span class="string">"&amp; "</span><span class="keyword">Binary</span><span class="string">" &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">        Case REG_DWORD</span></div><div class="line"><span class="string">            oF.WriteLine "</span>&lt;td&gt;<span class="string">"&amp; "</span>DWORD<span class="string">"  &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">        Case REG_MULTI_SZ</span></div><div class="line"><span class="string">            oF.WriteLine "</span>&lt;td&gt;<span class="string">"&amp; "</span>Multi <span class="built_in">String</span><span class="string">"  &amp;"</span>&lt;/td&gt;&lt;/tr&gt;<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">    End Select      </span></div><div class="line"><span class="string">Next</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">End Function</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">strKeyPath = "</span>SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, KEY_QUERY_VALUE, bHasAccessRight</span></div><div class="line"><span class="string">If bHasAccessRight = True Then</span></div><div class="line"><span class="string">    a="</span> Query<span class="string">"</span></div><div class="line"><span class="string">Else</span></div><div class="line"><span class="string">    a= "</span> <span class="keyword">Not</span> Query<span class="string">"</span></div><div class="line"><span class="string">End If</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, KEY_SET_VALUE, bHasAccessRight</span></div><div class="line"><span class="string">If bHasAccessRight = True Then</span></div><div class="line"><span class="string">    b= "</span> <span class="keyword">Set</span><span class="string">"</span></div><div class="line"><span class="string">Else</span></div><div class="line"><span class="string">    b="</span> <span class="keyword">Not</span> <span class="keyword">Set</span> <span class="string">"</span></div><div class="line"><span class="string">End If</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, KEY_CREATE_SUB_KEY, bHasAccessRight</span></div><div class="line"><span class="string">If bHasAccessRight = True Then</span></div><div class="line"><span class="string">    c= "</span> Create<span class="string">"</span></div><div class="line"><span class="string">Else</span></div><div class="line"><span class="string">    c="</span> <span class="keyword">Not</span> Create<span class="string">"</span></div><div class="line"><span class="string">End If</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">oReg.CheckAccess HKEY_LOCAL_MACHINE, strKeyPath, DELETE, bHasAccessRight</span></div><div class="line"><span class="string">If bHasAccessRight = True Then</span></div><div class="line"><span class="string">   d="</span> DELETE<span class="string">"</span></div><div class="line"><span class="string">Else</span></div><div class="line"><span class="string">    d="</span> NotDelete<span class="string">"</span></div><div class="line"><span class="string">End If</span></div><div class="line"><span class="string">oF.writeline "</span>&lt;tr&gt;&lt;th bgColor=<span class="meta">#808080&gt;检查项目&lt;/th&gt;&lt;th bgColor=#808080&gt;支持的权限"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>&amp;<span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg"</span>&amp;<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>&amp;a&amp;b&amp;c&amp;d&amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;/table&gt;"</span></div><div class="line"><span class="comment">'------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="comment">'Set fs=CreateObject("scripting.filesystemobject")</span></div><div class="line"><span class="comment">'Set f0=fs.getspecialfolder(0)</span></div><div class="line"><span class="comment">'Set f1=fs.getspecialfolder(1)</span></div><div class="line"><span class="comment">'Set f2=fs.getspecialfolder(2)</span></div><div class="line"></div><div class="line"><span class="comment">'system32=f1</span></div><div class="line"><span class="comment">'oF.writeline "<span class="doctag">&lt;table BORDER=1 style=font-size:9pt&gt;</span>"</span></div><div class="line"><span class="comment">'oF.WriteLine "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;th&gt;</span>"</span></div><div class="line"><span class="comment">'WScript.Echo f0&amp;f1&amp;f2</span></div><div class="line"><span class="comment">'Set objShell = CreateObject ("Shell.Application")</span></div><div class="line"><span class="comment">'Set objFolder = objShell.Namespace (system32)</span></div><div class="line"><span class="comment">'Set objFSO = CreateObject("Scripting.FileSystemObject")</span></div><div class="line"><span class="comment">'Dim arrHeaders(13)</span></div><div class="line"><span class="comment">'For i = 0 to 13</span></div><div class="line"> <span class="comment">'   arrHeaders(i) = objFolder.GetDetailsOf (objFolder.Items, i)</span></div><div class="line"><span class="comment">'Next</span></div><div class="line"><span class="comment">'For Each strFileName in objFolder.Items</span></div><div class="line"></div><div class="line"> <span class="comment">'   For i = 0 to 13</span></div><div class="line">  <span class="comment">'      If i <span class="doctag">&lt;&gt;</span> 9 Then</span></div><div class="line">   <span class="comment">'     oF.writeline "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(0)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(1)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(2)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(3)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(4)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(5)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(6)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(7)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(8)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(9)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(10)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(11)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(12)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;th&gt;</span>"&amp; arrHeaders(13)&amp;"<span class="doctag">&lt;/th&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line">    <span class="comment">' oF.writeline "<span class="doctag">&lt;tr&gt;</span><span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 0) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 1) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 2) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 3) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 4) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 5) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 6) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 7) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName,8) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 9) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 10) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 11) &amp;"<span class="doctag">&lt;/td&gt;</span>"&amp;"<span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 12) &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;td&gt;</span>" &amp;objFolder.GetDetailsOf (strFileName, 13) &amp;"<span class="doctag">&lt;/td&gt;</span><span class="doctag">&lt;/tr&gt;</span>"</span></div><div class="line">     <span class="comment">'   End If</span></div><div class="line">    <span class="comment">'Next</span></div><div class="line">    <span class="comment">'WScript.Echo</span></div><div class="line"><span class="comment">'Next</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">'sys file read</span></div><div class="line"></div><div class="line"><span class="comment">'Set fs=CreateObject("scripting.filesystemobject")</span></div><div class="line"><span class="comment">'Set f0=fs.getspecialfolder(0)</span></div><div class="line"><span class="comment">'Set f1=fs.getspecialfolder(1)</span></div><div class="line"><span class="comment">'Set f2=fs.getspecialfolder(2)</span></div><div class="line"></div><div class="line"><span class="comment">'winfile=f0&amp;"\"&amp;"win.ini"</span></div><div class="line"><span class="comment">'sysfile="C:\WINDOWS\SYSTEM.INI"</span></div><div class="line"><span class="comment">'set file2=oFSO.OpenTextFile (sysfile,forreading,True)</span></div><div class="line"></div><div class="line"><span class="comment">'While file2.AtEndOfStream<span class="doctag">&lt;&gt;</span>True</span></div><div class="line"><span class="comment">'ccc=ReadLine</span></div><div class="line"><span class="comment">'oF.WriteLine "<span class="doctag">&lt;p&gt;</span><span class="doctag">&lt;font size=2&gt;</span>" &amp;ccc&amp;"<span class="doctag">&lt;/font&gt;</span><span class="doctag">&lt;/p&gt;</span>"</span></div><div class="line"><span class="comment">'Wend</span></div><div class="line"></div><div class="line"><span class="comment">'---------------------------------</span></div><div class="line"><span class="comment">'导出系统日志为html</span></div><div class="line"><span class="comment">' --------------------------------</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;h3&gt;&lt;font color=MidnightBlue&gt;&lt;a name=here17&gt;"</span>&amp;<span class="string">"[  17. 系统日志  ]"</span>&amp;<span class="string">"&lt;/a&gt;&lt;/font&gt;&lt;/h3&gt;"</span></div><div class="line">msg=<span class="string">"是否导出系统日志为单独的html报告？"</span>&amp; VbCrLf</div><div class="line">msg=msg&amp;<span class="string">"日志筛选内容包括："</span>&amp; VbCrLf</div><div class="line">msg=msg&amp;<span class="string">"  1.登录失败"</span>&amp; VbCrLf</div><div class="line">msg=msg&amp;<span class="string">"  2.错误、警告、安全审核失败 "</span>&amp; VbCrLf</div><div class="line"><span class="keyword">Set</span> objShell = WScript.CreateObject(<span class="string">"Wscript.Shell"</span>)</div><div class="line"></div><div class="line">EventDoIt = MsgBox(msg,vbQuestion+vbYesNo+vbSystemModal,<span class="string">"运行提示"</span>)</div><div class="line"><span class="keyword">If</span> EventDoIt = vbNo <span class="keyword">Then</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;p&gt;&lt;font size=2&gt;程序运行没有选择导出日志&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">Run_complete</div><div class="line">WScript.Quit</div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;p&gt;&lt;font size=2&gt;&lt;a href="</span>&amp;EventReport&amp;<span class="string">"&gt;点击打开 "</span>&amp;EventReport&amp;<span class="string">" 查看日志&lt;/a&gt;&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> objWMIService = GetObject(<span class="string">"winmgmts:&#123;(Security)&#125;\\"</span> &amp; strComputer &amp; <span class="string">"\root\cimv2"</span>)</div><div class="line"></div><div class="line"><span class="keyword">Set</span> colEvents = objWMIService.ExecQuery(<span class="string">"Select * from Win32_NTLogEvent Where Logfile = 'Security' and EventCode = '529'"</span>)</div><div class="line">eventlog.WriteLine <span class="string">"&lt;head&gt;&lt;title&gt;eventLog build by bkReport.vbs&lt;/title&gt;&lt;/head&gt;"</span></div><div class="line">eventlog.writeline <span class="string">"&lt;table BORDER=1 style=font-size:9pt width=100% cellspacing=1&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080 COLSPAN=6&gt;登录失败日志信息&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Category: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Event Code: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Record Number: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Event Type: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Time Written: &lt;/th&gt;"</span>  </div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Message: &lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objEvent <span class="keyword">in</span> colEvents</div><div class="line">eventlog.Writeline <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>  &amp; objEvent.Category &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.EventCode &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.RecordNumber &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.Type &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.TimeWritten &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.Message &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"></div><div class="line"><span class="keyword">Set</span> colLoggedEvents = objWMIService.ExecQuery _</div><div class="line">    (<span class="string">"Select * from Win32_NTLogEvent Where Type &lt;&gt; 'information' AND Type &lt;&gt; 'audit success'"</span>)</div><div class="line">eventlog.Writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080 COLSPAN=6&gt;错误、警告、安全审核失败日志信息&lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;tr&gt;&lt;th bgColor=#808080&gt;Category: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Event Code: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Record Number: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Event Type: &lt;/th&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Time Written: &lt;/th&gt;"</span>  </div><div class="line">eventlog.Writeline <span class="string">"&lt;th bgColor=#808080&gt;Message: &lt;/th&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objEvent <span class="keyword">in</span> colLoggedEvents</div><div class="line">eventlog.Writeline <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>  &amp; objEvent.Category &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.EventCode &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.RecordNumber &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.Type &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.TimeWritten &amp;<span class="string">"&lt;/td&gt;"</span></div><div class="line">eventlog.Writeline <span class="string">"&lt;td&gt;"</span> &amp; objEvent.Message &amp;<span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></div><div class="line"><span class="keyword">Next</span></div><div class="line"><span class="keyword">oF</span>.writeline <span class="string">"&lt;/table&gt;"</span></div><div class="line"><span class="keyword">oF</span>.WriteLine <span class="string">"&lt;/html&gt;"</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Run_complete</div><div class="line"></div><div class="line"><span class="keyword">oF</span>.closee</div><div class="line"></div><div class="line"><span class="keyword">Sub</span> Run_complete</div><div class="line">dtmEnd = Now()</div><div class="line"><span class="keyword">oF</span>.Writeline <span class="string">"&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;"</span></div><div class="line"><span class="keyword">oF</span>.Writeline <span class="string">"&lt;hr width=90% color=#ff8000&gt;"</span></div><div class="line"><span class="keyword">oF</span>.Writeline  <span class="string">"&lt;p align=center&gt;&lt;font size=2&gt;脚本运行时间 "</span>&amp; DateDiff(<span class="string">"s"</span>, dtmStart, dtmEnd)&amp;<span class="string">" 秒  问题反馈eMail: qinbo@nsfocus.com&lt;/font&gt;&lt;/p&gt;"</span></div><div class="line">objShell.run  MainReport</div><div class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></div><div class="line"><span class="comment">'********************************************************************</span></div><div class="line"><span class="comment">'*                                                                  *</span></div><div class="line"><span class="comment">'*                           End of File                            *</span></div><div class="line"><span class="comment">'*                                                                  *</span></div><div class="line"><span class="comment">'********************************************************************</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月25日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="windows学习" scheme="http://daodaoliang.com/categories/windows%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>清理linux登录和操作记录</title>
    <link href="http://daodaoliang.com/linux%E5%AD%A6%E4%B9%A0/2016/11/11/linux%E5%AD%A6%E4%B9%A0-2016-11-11-%E6%B8%85%E7%90%86%E7%99%BB%E5%BD%95%E5%92%8C%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/"/>
    <id>http://daodaoliang.com/linux学习/2016/11/11/linux学习-2016-11-11-清理登录和操作记录/</id>
    <published>2016-11-10T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.846Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月11日
</code></pre><a id="more"></a>
<hr>
<p>创建 <code>clear.sh</code> 脚本文件,内容如下</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/syslog</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/messages</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/xferlog</div><div class="line"><span class="comment">#echo &gt; /var/log/httpd/access_log</span></div><div class="line"><span class="comment">#echo &gt; /var/log/httpd/error_log</span></div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/mysqld.log</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/secure</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/auth.log</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/user.log</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/wtmp</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/lastlog</div><div class="line"><span class="built_in">echo</span> &gt; /var/<span class="built_in">log</span>/btmp</div><div class="line"><span class="built_in">echo</span> &gt; /var/run/utmp</div><div class="line"><span class="built_in">echo</span> &gt; .bash_history</div><div class="line"><span class="built_in">echo</span> &gt; .mysql_history</div><div class="line"><span class="built_in">history</span> -c</div></pre></td></tr></table></figure>
<p>给脚本执行权限并执行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod +x ./clear.sh</div><div class="line">./clear.sh</div></pre></td></tr></table></figure>
<p><strong>登录的账号必须有相应目录的rw权限</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.1
日期: 2016年11月11日
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux学习" scheme="http://daodaoliang.com/categories/linux%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>Qt开源项目说明</title>
    <link href="http://daodaoliang.com/%E7%A7%81%E4%BA%BA%E5%B7%A5%E5%85%B7%E9%A1%B9%E7%9B%AE/2016/11/04/QDaoDaoLiang-2016-11-04-Qt%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E8%AF%B4%E6%98%8E/"/>
    <id>http://daodaoliang.com/私人工具项目/2016/11/04/QDaoDaoLiang-2016-11-04-Qt开源项目说明/</id>
    <published>2016-11-03T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.842Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V 0.0.3
邮箱: daodaoliang@yeah.net
</code></pre><p>  在使用过程中有任何疑问可直接联系我，以后还会有其他组件开源，现有组件也会升级维护哒，QQ:88341189，没事也可以技术交流呀！</p>
<a id="more"></a>
<h3 id="0x00-基础UI组件集合-NBaseUiKit"><a href="#0x00-基础UI组件集合-NBaseUiKit" class="headerlink" title="0x00 基础UI组件集合(NBaseUiKit)"></a>0x00 基础UI组件集合(NBaseUiKit)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的基础UI组件集合，方便平时的组件定制等问题；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NBaseUiKit/">http://daodaoliang.com/NBaseUiKit/</a></li>
</ul>
<h3 id="0x01-常用功能公共组件集合-NCommon"><a href="#0x01-常用功能公共组件集合-NCommon" class="headerlink" title="0x01 常用功能公共组件集合(NCommon)"></a>0x01 常用功能公共组件集合(NCommon)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的常用功能组件集合，截屏、自动部署发布、数据转码等功能组件；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NCommon/">http://daodaoliang.com/NCommon/</a>；</li>
</ul>
<h3 id="0x02-认证组件-NAuth"><a href="#0x02-认证组件-NAuth" class="headerlink" title="0x02 认证组件(NAuth)"></a>0x02 认证组件(NAuth)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的权限验证组件,适用于注册码机制；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NAuth/">http://daodaoliang.com/NAuth/</a>；</li>
</ul>
<h3 id="0x03-加密的配置组件-NConfig"><a href="#0x03-加密的配置组件-NConfig" class="headerlink" title="0x03 加密的配置组件(NConfig)"></a>0x03 加密的配置组件(NConfig)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的基于加密的sqlite数据库存取的配置文件；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NConfig/">http://daodaoliang.com/NConfig/</a>；</li>
</ul>
<h3 id="0x04-加解密算法组件-NEncryptionKit"><a href="#0x04-加解密算法组件-NEncryptionKit" class="headerlink" title="0x04 加解密算法组件(NEncryptionKit)"></a>0x04 加解密算法组件(NEncryptionKit)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的常用的加解密算法的封装组件，比如AES、DES、RSA、凯撒加密等自定义加解密方式；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NEncryptionKit/">http://daodaoliang.com/NEncryptionKit/</a>；</li>
</ul>
<h3 id="0x05-数据库连接池组件-NDBPool"><a href="#0x05-数据库连接池组件-NDBPool" class="headerlink" title="0x05 数据库连接池组件(NDBPool)"></a>0x05 数据库连接池组件(NDBPool)</h3><ul>
<li><strong>项目说明:</strong> Qt编写的数据库连接池 ，支持长短链等；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NDBPool/">http://daodaoliang.com/NDBPool/</a>；</li>
</ul>
<h3 id="0x06-跨线程安全的日志组件-NLoger"><a href="#0x06-跨线程安全的日志组件-NLoger" class="headerlink" title="0x06 跨线程安全的日志组件(NLoger)"></a>0x06 跨线程安全的日志组件(NLoger)</h3><ul>
<li><strong>项目说明:</strong> Qt编写跨线程安全的日志记录(原项目为cuteloger)；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NLoger/">http://daodaoliang.com/NLoger/</a>；</li>
</ul>
<h3 id="0x07-系统软硬件信息组件-NComputerInfo"><a href="#0x07-系统软硬件信息组件-NComputerInfo" class="headerlink" title="0x07 系统软硬件信息组件(NComputerInfo)"></a>0x07 系统软硬件信息组件(NComputerInfo)</h3><ul>
<li><strong>项目说明:</strong> Qt编写获取程序运行期间的PC硬件等相关信息；</li>
<li><strong>开源状态:</strong> 完全开源；</li>
<li><strong>开源主页:</strong> <a href="http://daodaoliang.com/NComputerInfo/">http://daodaoliang.com/NComputerInfo/</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V 0.0.3
邮箱: daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;  在使用过程中有任何疑问可直接联系我，以后还会有其他组件开源，现有组件也会升级维护哒，QQ:88341189，没事也可以技术交流呀！&lt;/p&gt;
    
    </summary>
    
      <category term="私人工具项目" scheme="http://daodaoliang.com/categories/%E7%A7%81%E4%BA%BA%E5%B7%A5%E5%85%B7%E9%A1%B9%E7%9B%AE/"/>
    
    
  </entry>
  
  <entry>
    <title>supervisor 安装与配置</title>
    <link href="http://daodaoliang.com/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/2016/11/02/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2016-11-02-Supervisor%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
    <id>http://daodaoliang.com/环境搭建/2016/11/02/环境搭建-2016-11-02-Supervisor安装与配置/</id>
    <published>2016-11-01T16:00:00.000Z</published>
    <updated>2017-08-23T07:06:24.850Z</updated>
    
    <content type="html"><![CDATA[<hr>
<pre><code>作者: daodaoliang
版本: V1.0.1
邮箱： daodaoliang@yeah.net
</code></pre><p><a href="http://supervisord.org/installing.html" target="_blank" rel="external">这里是官方链接</a></p>
<a id="more"></a>
<h2 id="0x00-supervisor-简介"><a href="#0x00-supervisor-简介" class="headerlink" title="0x00 supervisor 简介"></a>0x00 supervisor 简介</h2><p>Supervisor 是一个用 python 语言开发的用来在 linux 系统下进行进程管理的工具。可以很方面的监控、启动、停止、重启一个或者多个进程。当进程意外终止时可以在第一时间进行重启，做到自动恢复。</p>
<h2 id="0x01-supervisor-安装"><a href="#0x01-supervisor-安装" class="headerlink" title="0x01 supervisor 安装"></a>0x01 supervisor 安装</h2><p><strong>1.确保 python 环境完备</strong></p>
<p><strong>Note:</strong> Supervisor is known to work with Python 2.4 or later but will not work under any version of Python 3.</p>
<p>安装 <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="external">easy_install</a> 或者 <a href="https://pip.pypa.io/en/stable/installing/" target="_blank" rel="external">pip</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://bootstrap.pypa.io/ez_setup.py -O - | sudo python</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># get-pip.py请从官网获取</div><div class="line">python get-pip.py</div></pre></td></tr></table></figure>
<p><strong>2.安装 supervisor</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install supervisor</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">easy_install supervisor</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 需要源支持</div><div class="line">yum install supervisor</div></pre></td></tr></table></figure>
<p>supervisor安装完成后会生成三个执行程序：supervisortd、supervisorctl、echo_supervisord_conf，分别是supervisor的守护进程服务（用于接收进程管理命令）、客户端（用于和守护进程通信，发送管理进程的指令）、生成初始配置文件程序。</p>
<h2 id="0x02-supervisor-配置"><a href="#0x02-supervisor-配置" class="headerlink" title="0x02 supervisor 配置"></a>0x02 supervisor 配置</h2><p><strong>1. 配置文件生成</strong></p>
<p>运行supervisord服务的时候，需要用 c 参数指定supervisor配置文件，如果没有显示指定，默认以此在以下目录查找：</p>
<ul>
<li><code>$CWD/supervisord.conf</code></li>
<li><code>$CWD/etc/supervisord.conf</code></li>
<li><code>/etc/supervisord.conf</code></li>
<li><code>/etc/supervisor/supervisord.conf (since Supervisor 3.3.0)</code></li>
<li><code>../etc/supervisord.conf (Relative to the executable)</code></li>
<li><code>../supervisord.conf (Relative to the executable)</code></li>
</ul>
<p><strong>Note：</strong> <code>$CWD</code> 表示运行 <code>supervisord</code> 程序的目录。</p>
<p>可以通过运行 <code>echo_supervisord_conf</code> 程序生成 <code>supervisor</code> 的初始化配置文件,如下所示:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /etc/supervisor</div><div class="line">   echo_supervisord_conf &gt; /etc/supervisor/supervisord.conf</div></pre></td></tr></table></figure>
<p><strong>2. 配置项说明</strong></p>
<p>supervisor的配置参数较多，下面介绍一下常用的参数配置，详细的配置及说明，请参考<a href="http://supervisord.org/configuration.html" target="_blank" rel="external">官方文档</a>介绍。分号（;）开头的配置表示注释</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="section">[unix_http_server]</span></div><div class="line"></div><div class="line"><span class="comment">;socket文件的路径，supervisorctl用XML_RPC和supervisord通信就是通过它进行的,不设置的话，默认为none。非必须设置。</span></div><div class="line"><span class="attr">file</span>=/tmp/supervisor.sock</div><div class="line"></div><div class="line"><span class="comment">;修改file的权限必须为0700,非必须设置。</span></div><div class="line"><span class="attr">chmod</span>=<span class="number">0700</span></div><div class="line"></div><div class="line"><span class="comment">;修改file的权限的所属组为nobody:nogroup,非必需设置。</span></div><div class="line"><span class="attr">chown</span>=nobody:nogroup</div><div class="line"></div><div class="line"><span class="comment">;使用supervisorctl链接的时候,认证的用户,不设置的话默认不需要用户,非必需设置。</span></div><div class="line"><span class="attr">username</span>=user</div><div class="line"></div><div class="line"><span class="comment">;和上面的用户名对应的密码，可以直接使用明码，也可以使用SHA加密如&#123;SHA&#125;82ab876d1387bfafe46cc1c8a2ef074eae50cb1d。</span></div><div class="line"><span class="attr">password</span>=<span class="number">123</span></div><div class="line"></div><div class="line"><span class="comment">;侦听在TCP上的socket,Web Server和远程的supervisorctl都要用到他不设置的话，默认为不开启。非必须设置。</span></div><div class="line"><span class="section">[inet_http_server]</span></div><div class="line"></div><div class="line"><span class="comment">;侦听的IP和端口，侦听所有IP用 :9001或*:9001或者0.0.0.0:9001.这个必须设置，只要上面的[inet_http_server]开启了，就必须设置它。</span></div><div class="line"><span class="attr">port</span>=<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">9001</span></div><div class="line"></div><div class="line"><span class="comment">;登录时的用户名。</span></div><div class="line"><span class="attr">username</span>=user</div><div class="line"></div><div class="line"><span class="comment">;登录时的密码。</span></div><div class="line"><span class="attr">password</span>=<span class="number">123</span></div><div class="line"></div><div class="line"><span class="comment">;定义supervisord这个服务端进程的一些参数的。</span></div><div class="line"><span class="section">[supervisord]</span></div><div class="line"></div><div class="line"><span class="comment">;supervisord这个主进程的日志路径,默认路径$CWD/supervisord.log,$CWD是当前目录,非必需设置。</span></div><div class="line"><span class="attr">logfile</span>=/tmp/supervisord.log</div><div class="line"></div><div class="line"><span class="comment">;这个是上面那个日志文件的最大的大小,当超过50M(默认值是50M)的时候,会生成一个新的日志文件。当设置为0时,表示不限制文件大小,非必须设置。</span></div><div class="line"><span class="attr">logfile_maxbytes</span>=<span class="number">50</span>MB</div><div class="line"></div><div class="line"><span class="comment">;日志文件保持的数量,supervisor在启动程序时,会自动创建10个buckup文件(默认10),用于log rotate当设置为0时,表示不限制文件的数量。</span></div><div class="line"><span class="attr">logfile_backups</span>=<span class="number">10</span></div><div class="line"></div><div class="line"><span class="comment">;日志级别，有critical, error, warn, info, debug, trace, or blather等默认为info,非必须设置项。</span></div><div class="line"><span class="attr">loglevel</span>=info</div><div class="line"></div><div class="line"><span class="comment">;supervisord的pid文件路径,默认为$CWD/supervisord.pid。</span></div><div class="line"><span class="attr">pidfile</span>=/tmp/supervisord.pid</div><div class="line"></div><div class="line"><span class="comment">;如果是true,supervisord进程将在前台运行默认为false,也就是后台以守护进程运行。</span></div><div class="line"><span class="attr">nodaemon</span>=<span class="literal">false</span></div><div class="line"></div><div class="line"><span class="comment">;这个是最少系统空闲的文件描述符，低于这个值(默认值1024)supervisor将不会启动。系统的文件描述符在这里设置cat /proc/sys/fs/file-max。</span></div><div class="line"><span class="attr">minfds</span>=<span class="number">1024</span></div><div class="line"></div><div class="line"><span class="comment">;最小可用的进程描述符,低于这个值(默认200)supervisor也将不会正常启动。ulimit  -u这个命令，可以查看linux下面用户的最大进程数。</span></div><div class="line"><span class="attr">minprocs</span>=<span class="number">200</span></div><div class="line"></div><div class="line"><span class="comment">;进程创建文件的掩码,默认为022</span></div><div class="line"><span class="attr">umask</span>=<span class="number">022</span></div><div class="line"></div><div class="line"><span class="comment">;这个参数可以设置一个非root用户，当我们以root用户启动supervisord之后。我这里面设置的这个用户，也可以对supervisord进行管理,默认不设置。</span></div><div class="line"><span class="attr">user</span>=daodaoliang</div><div class="line"></div><div class="line"><span class="comment">;supervisord的标识符，主要是给XML_RPC用的。当你有多个supervisor的时候，而且想调用XML_RPC统一管理，就需要为每个supervisor设置不同的标识符了,默认sipervisor。</span></div><div class="line"><span class="attr">identifier</span>=supervisor</div><div class="line"></div><div class="line"><span class="comment">;当supervisord作为守护进程运行的时候,设置这个参数的话,启动supervisord进程之前,会先切换到这个目录默认不设置。</span></div><div class="line"><span class="attr">directory</span>=/tmp</div><div class="line"></div><div class="line"><span class="comment">;在supervisord进程启动的时候，把以前子进程产生的日志文件(路径为AUTO的情况下)清除掉,默认false,有调试需求的同学可以设置为true。</span></div><div class="line"><span class="attr">nocleanup</span>=<span class="literal">true</span></div><div class="line"></div><div class="line"><span class="comment">;当子进程日志路径为AUTO的时候，子进程日志文件的存放路径。默认路径是这个东西，执行下面的这个命令看看就OK了，处理的东西就默认路径</span></div><div class="line"><span class="comment">;python -c "import tempfile;print tempfile.gettempdir()"</span></div><div class="line"><span class="attr">childlogdir</span>=/tmp</div><div class="line"></div><div class="line"><span class="comment">;设置环境变量的，supervisord在linux中启动默认继承了linux的环境变量，在这里可以设置supervisord进程特有的其他环境变量。</span></div><div class="line"><span class="comment">;supervisord启动子进程时，子进程会拷贝父进程的内存空间内容。 所以设置的这些环境变量也会被子进程继承。</span></div><div class="line"><span class="comment">;小例子：environment=name="daodaoliang",age="26"</span></div><div class="line"><span class="attr">environment</span>=KEY=<span class="string">"value"</span></div><div class="line"></div><div class="line"><span class="comment">;如果设置为true，会清除子进程日志中的所有 ANSI 序列（\n,\t等）。</span></div><div class="line"><span class="attr">strip_ansi</span>=<span class="literal">false</span></div><div class="line"></div><div class="line"><span class="section">[rpcinterface:supervisor]</span></div><div class="line"></div><div class="line">supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface</div><div class="line"></div><div class="line"><span class="comment">;针对supervisorctl的一些配置</span></div><div class="line"><span class="section">[supervisorctl]</span></div><div class="line"></div><div class="line"><span class="comment">;supervisorctl本地连接supervisord的时候，本地UNIX socket路径，注意这个是和前面的[unix_http_server]对应的默认值就是unix:///tmp/supervisor.sock</span></div><div class="line"><span class="attr">serverurl</span>=unix:///tmp/supervisor.sock</div><div class="line"></div><div class="line"><span class="comment">;supervisorctl远程连接supervisord的时候，用到的TCP socket路径,注意这个和前面的[inet_http_server]对应默认就是http://127.0.0.1:9001</span></div><div class="line"><span class="attr">serverurl</span>=http://<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">9001</span></div><div class="line"></div><div class="line"><span class="comment">;用户名</span></div><div class="line"><span class="attr">username</span>=daodaoliang</div><div class="line"></div><div class="line"><span class="comment">;密码</span></div><div class="line"><span class="attr">password</span>=<span class="number">123</span></div><div class="line"></div><div class="line"><span class="comment">;输入用户名密码时候的提示符</span></div><div class="line"><span class="attr">prompt</span>=iamnami</div><div class="line"></div><div class="line"><span class="comment">;这个参数和shell中的history类似，我们可以用上下键来查找前面执行过的命令默认是no file,所以我们想要有这种功能，必须指定一个文件</span></div><div class="line"><span class="attr">history_file</span>=~/.sc_history</div><div class="line"></div><div class="line"><span class="comment">;要管理的子进程了,":"后面的是名字，最好别乱写和实际进程有点关联最好。这样的program我们可以设置一个或多个，一个program就是要被管理的一个进程</span></div><div class="line"><span class="section">[program:theprogramname]</span></div><div class="line"></div><div class="line"><span class="comment">;要启动进程的命令路径了，可以带参数/home/test.py -a 'hehe'</span></div><div class="line"><span class="comment">;需要注意的是，我们的command只能是那种在终端运行的进程，不能是守护进程。这个是个必须设置的项。</span></div><div class="line"><span class="attr">command</span>=/bin/cat</div><div class="line"></div><div class="line"><span class="comment">;当numprocs为1时,process_name=%(program_name)s</span></div><div class="line"><span class="comment">;当numprocs&gt;=2时,%(program_name)s_%(process_num)02d</span></div><div class="line"><span class="attr">process_name</span>=%(program_name)s</div><div class="line"></div><div class="line"><span class="comment">;进程数量,当不为1时，就是进程池的概念</span></div><div class="line"><span class="attr">numprocs</span>=<span class="number">1</span></div><div class="line"></div><div class="line"><span class="comment">;进程开始的数字</span></div><div class="line"><span class="attr">numprocs_start</span>=<span class="number">1</span></div><div class="line"></div><div class="line"><span class="comment">;进程运行前，会前切换到这个目录</span></div><div class="line"><span class="attr">directory</span>=/tmp</div><div class="line"></div><div class="line"><span class="comment">;进程掩码:--- -w- -w-, 转换后rwx r-x r-x</span></div><div class="line"><span class="attr">umask</span>=<span class="number">022</span></div><div class="line"></div><div class="line"><span class="comment">;优先级,值越高,最后启动,最先被关闭,默认值999</span></div><div class="line"><span class="attr">priority</span>=<span class="number">999</span></div><div class="line"></div><div class="line"><span class="comment">;如果为true则程序在supervisord启动后将会启动</span></div><div class="line"><span class="attr">autostart</span>=<span class="literal">true</span></div><div class="line"></div><div class="line"><span class="comment">;自动重启的情况</span></div><div class="line"><span class="comment">;有三个选项，false,unexpected和true。</span></div><div class="line"><span class="comment">;如果为false的时候，无论什么情况下，都不会被重新启动。</span></div><div class="line"><span class="comment">;如果为unexpected，只有当进程的退出码不在下面的exitcodes里面定义的退出码的时候，才会被自动重启。</span></div><div class="line"><span class="comment">;当为true的时候，只要子进程挂掉，将会被无条件的重启。</span></div><div class="line"><span class="attr">autorestart</span>=<span class="literal">true</span></div><div class="line"></div><div class="line"><span class="comment">;子进程气动阀多少秒后才把状态置为running</span></div><div class="line"><span class="attr">startsecs</span>=<span class="number">1</span></div><div class="line"></div><div class="line"><span class="comment">;当进程启动失败后，最大尝试启动的次数。。当超过3次后，supervisor将把此进程的状态置为FAIL。</span></div><div class="line"><span class="attr">startretries</span>=<span class="number">3</span></div><div class="line"></div><div class="line"><span class="comment">;和上面的的autorestart=unexpected对应。exitcodes里面的定义的退出码是expected的。</span></div><div class="line"><span class="attr">exitcodes</span>=<span class="number">0</span>,<span class="number">2</span></div><div class="line"></div><div class="line"><span class="comment">;进程停止信号，可以为TERM, HUP, INT, QUIT, KILL, USR1, or USR2等信号。当用设定的信号去干掉进程，退出码会被认为是expected。</span></div><div class="line"><span class="comment">;中断:INT(类似于Ctrl+C)(kill -INT pid),退出后会将写文件或日志(推荐)</span></div><div class="line"><span class="comment">;终止:TERM(kill -TERM pid)</span></div><div class="line"><span class="comment">;挂起:HUP(kill -HUP pid),注意与Ctrl+Z/kill -stop pid不同</span></div><div class="line"><span class="comment">;从容停止:QUIT(kill -QUIT pid) ;KILL, USR1, USR2其他见命令(kill -l),说明1</span></div><div class="line"><span class="comment">;默认为TERM。</span></div><div class="line"><span class="attr">stopsignal</span>=TERM</div><div class="line"></div><div class="line"><span class="comment">;当我们向子进程发送stopsignal信号后，到系统返回信息给supervisord，所等待的最大时间。 超过这个时间，supervisord会向该子进程发送一个强制kill的信号。</span></div><div class="line"><span class="comment">;默认为10秒,非必须设置。</span></div><div class="line"><span class="attr">stopwaitsecs</span>=<span class="number">10</span></div><div class="line"></div><div class="line"><span class="comment">;用于supervisord管理的子进程，这个子进程本身还有子进程。那么我们如果仅仅干掉supervisord的子进程的话，子进程的子进程有可能会变成孤儿进程.</span></div><div class="line"><span class="comment">;所以可以设置可个选项，把整个该子进程的整个进程组都干掉。 设置为true的话，一般killasgroup也会被设置为true。</span></div><div class="line"><span class="comment">;需要注意的是，该选项发送的是stop信号默认为false。</span></div><div class="line"><span class="comment">;非必须设置。</span></div><div class="line"><span class="attr">stopasgroup</span>=<span class="literal">false</span></div><div class="line"></div><div class="line"><span class="comment">;这个和上面的stopasgroup类似，不过发送的是kill信号。</span></div><div class="line"><span class="comment">;非必须设置</span></div><div class="line"><span class="attr">killasgroup</span>=<span class="literal">false</span></div><div class="line"></div><div class="line"><span class="comment">;如果supervisord是root启动，我们在这里设置这个非root用户，可以用来管理该program。</span></div><div class="line"><span class="comment">;非必须设置项。</span></div><div class="line"><span class="attr">user</span>=daodaoliang</div><div class="line"></div><div class="line"><span class="comment">;如果为true，则stderr的日志会被写入stdout日志文件中</span></div><div class="line"><span class="attr">redirect_stderr</span>=<span class="literal">true</span></div><div class="line"></div><div class="line"><span class="comment">;子进程的stdout的日志路径，可以指定路径，AUTO，none等三个选项</span></div><div class="line"><span class="comment">;设置为none的话，将没有日志产生。</span></div><div class="line"><span class="comment">;设置为AUTO的话，将随机找一个地方生成日志文件,而且当supervisord重新启动的时候,以前的日志文件会被清空。</span></div><div class="line"><span class="comment">;当 redirect_stderr=true的时候，sterr也会写进这个日志文件。</span></div><div class="line"><span class="attr">stdout_logfile</span>=/a/path</div><div class="line"></div><div class="line"><span class="comment">;日志文件最大大小，和[supervisord]中定义的一样。默认为50</span></div><div class="line"><span class="attr">stdout_logfile_maxbytes</span>=<span class="number">1</span>MB</div><div class="line"></div><div class="line"><span class="comment">;和[supervisord]定义的一样。默认10</span></div><div class="line"><span class="attr">stdout_logfile_backups</span>=<span class="number">10</span></div><div class="line"></div><div class="line"><span class="comment">;这个东西是设定capture管道的大小，当值不为0的时候，子进程可以从stdout发送信息，而supervisor可以根据信息，发送相应的event。</span></div><div class="line"><span class="comment">;默认为0，为0的时候表达关闭管道。</span></div><div class="line"><span class="comment">;非必须项</span></div><div class="line"><span class="attr">stdout_capture_maxbytes</span>=<span class="number">1</span>MB</div><div class="line"></div><div class="line"><span class="comment">;当设置为ture的时候,当子进程由stdout向文件描述符中写日志的时候,将触发supervisord发送PROCESS_LOG_STDOUT类型的event.</span></div><div class="line"><span class="comment">;默认为false</span></div><div class="line"><span class="comment">;非必须设置</span></div><div class="line"><span class="attr">stdout_events_enabled</span>=<span class="literal">false</span></div><div class="line"></div><div class="line"><span class="comment">;这个东西是设置stderr写的日志路径，当redirect_stderr=true。这个就不用设置了，设置了也是白搭。因为它会被写入stdout_logfile的同一个文件中默认为AUTO。</span></div><div class="line"><span class="comment">;也就是随便找个地存,supervisord重启被清空。</span></div><div class="line"><span class="comment">;非必须设置</span></div><div class="line"><span class="attr">stderr_logfile</span>=/a/path</div><div class="line"></div><div class="line"><span class="comment">;这个是该子进程的环境变量，和别的子进程是不共享的</span></div><div class="line"><span class="attr">environment</span>=A=<span class="string">"1"</span>,B=<span class="string">"2"</span></div><div class="line"></div><div class="line"><span class="attr">serverurl</span>=AUTO</div><div class="line"></div><div class="line"><span class="comment">;当我们要管理的进程很多的时候，写在一个文件里面就有点大了。我们可以把配置信息写到多个文件中，然后include过来。</span></div><div class="line"><span class="section">[include]</span></div><div class="line"></div><div class="line"><span class="comment">;例如/an/absolute/filename.conf /an/absolute/*.conf foo.conf config??.conf</span></div><div class="line"><span class="attr">files</span> = relative/directory/*.ini</div></pre></td></tr></table></figure>
<p><strong>3.例子</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="section">[program:usercenter]</span></div><div class="line"><span class="comment">; 程序的启动目录</span></div><div class="line"><span class="attr">directory</span> = /home/leon/projects/usercenter</div><div class="line"><span class="comment">; 启动命令，可以看出与手动在命令行启动的命令是一样的</span></div><div class="line"><span class="attr">command</span> = gunicorn -c gunicorn.py --port=%(process_num)s wsgi:app</div><div class="line"><span class="comment">; 程序名字</span></div><div class="line"><span class="attr">process_name</span>=%(program_name)s_%(process_num)<span class="number">02</span>d</div><div class="line"><span class="comment">; 开始数字</span></div><div class="line"><span class="attr">numprocs_start</span>=<span class="number">8110</span></div><div class="line"><span class="comment">; 数量</span></div><div class="line"><span class="attr">numprocs</span>=<span class="number">4</span></div><div class="line"><span class="comment">; 在 supervisord 启动的时候也自动启动</span></div><div class="line"><span class="attr">autostart</span> = <span class="literal">true</span></div><div class="line"><span class="comment">; 启动 5 秒后没有异常退出，就当作已经正常启动了</span></div><div class="line"><span class="attr">startsecs</span> = <span class="number">5</span></div><div class="line"><span class="comment">; 程序异常退出后自动重启</span></div><div class="line"><span class="attr">autorestart</span> = <span class="literal">true</span></div><div class="line"><span class="comment">; 启动失败自动重试次数，默认是 3</span></div><div class="line"><span class="attr">startretries</span> = <span class="number">3</span></div><div class="line"><span class="comment">; 用哪个用户启动</span></div><div class="line"><span class="attr">user</span> = leon</div><div class="line"><span class="comment">; 把 stderr 重定向到 stdout，默认 false</span></div><div class="line"><span class="attr">redirect_stderr</span> = <span class="literal">true</span></div><div class="line"><span class="comment">; stdout 日志文件大小，默认 50MB</span></div><div class="line"><span class="attr">stdout_logfile_maxbytes</span> = <span class="number">20</span>MB</div><div class="line"><span class="comment">; stdout 日志文件备份数</span></div><div class="line"><span class="attr">stdout_logfile_backups</span> = <span class="number">20</span></div><div class="line"><span class="comment">; stdout 日志文件，需要注意当指定目录不存在时无法正常启动，所以需要手动创建目录（supervisord 会自动创建日志文件）</span></div><div class="line"><span class="attr">stdout_logfile</span> = /data/logs/usercenter_stdout.log</div></pre></td></tr></table></figure>
<h2 id="0x03-supervisord-启动和维护"><a href="#0x03-supervisord-启动和维护" class="headerlink" title="0x03 supervisord 启动和维护"></a>0x03 supervisord 启动和维护</h2><p><strong>1.启动服务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/supervisord -c /etc/supervisor.conf</div></pre></td></tr></table></figure>
<p><strong>2.启动管理端</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">supervisorctl -c /etc/supervisor.conf</div></pre></td></tr></table></figure>
<p>若是连接远程的则:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">supervisorctl -c /etc/supervisor.conf -s &quot;http://114.114.114.114:9001&quot;</div></pre></td></tr></table></figure>
<p><strong>3.管理服务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"># 查看服务状态</div><div class="line">status</div><div class="line"></div><div class="line">   # 关闭 usercenter 程序</div><div class="line">   stop usercenter</div><div class="line"></div><div class="line">   # 停止所有程序</div><div class="line">   stop all</div><div class="line"></div><div class="line"># 启动 usercenter 程序</div><div class="line">start usercenter</div><div class="line"></div><div class="line"># 启动所有程序</div><div class="line">   start all</div><div class="line"></div><div class="line">   # 重启 usercenter 程序</div><div class="line">   restart usercenter</div><div class="line"></div><div class="line"># 重启所有程序</div><div class="line">   restart all</div><div class="line"></div><div class="line"># 读取有更新的的配置文件，不会启动新程序</div><div class="line">   reread</div><div class="line"></div><div class="line">   # 重启启动远程supervisord</div><div class="line">   reload</div><div class="line"></div><div class="line">   # 更新配置文件，若有新的则启动，若删除了则停止</div><div class="line">   update</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;pre&gt;&lt;code&gt;作者: daodaoliang
版本: V1.0.1
邮箱： daodaoliang@yeah.net
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&quot;http://supervisord.org/installing.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里是官方链接&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="环境搭建" scheme="http://daodaoliang.com/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
</feed>
